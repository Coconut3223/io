<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Elegant Python &#8212; HomePage</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=83e35b93" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/katex-math.css?v=91adb8b6" />
    <link rel="stylesheet" type="text/css" href="../_static/css/rtd_sphinx_search.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/def.css?v=5a9d86bd" />
    <script src="../_static/documentation_options.js?v=7d86a446"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=6dbb43f8"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/rtd_search_config.js"></script>
    <script src="../_static/js/rtd_sphinx_search.min.js"></script>
    <script src="https://unpkg.com/mermaid@10.2.0/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="Enhanced Python" href="enhanced.html" />
    <link rel="prev" title="Python" href="index.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#python/elegant" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="HomePage"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">&#xe869</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Cocobook</span>
          <span class="md-header-nav__topic"> Elegant Python </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/Coconut3223/io/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    io
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../_static/versions.json",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">HomePage</a></li>
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Homepage</a></li>
            
            <li class="md-tabs__item"><a href="../AI/index.html" class="md-tabs__link">AI</a></li>
            
            <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Python</a></li>
            
            <li class="md-tabs__item"><a href="../NLP/index.html" class="md-tabs__link">NLP</a></li>
            
            <li class="md-tabs__item"><a href="../SQL/index.html" class="md-tabs__link">SQL</a></li>
            
            <li class="md-tabs__item"><a href="../utils/index.html" class="md-tabs__link">Utils</a></li>
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Python</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="HomePage" class="md-nav__button md-logo">
      
        <i class="md-icon">&#xe869</i>
      
    </a>
    <a href="../index.html"
       title="HomePage">Cocobook</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/Coconut3223/io/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    io
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Content</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../AI/index.html" class="md-nav__link">AI</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../AI/ML/index.html" class="md-nav__link">ML</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../AI/DL/index.html" class="md-nav__link">DL</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../CV/index.html" class="md-nav__link">CV</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../NLP/index.html" class="md-nav__link">NLP</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="index.html" class="md-nav__link">python</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../SQL/index.html" class="md-nav__link">SQL</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../utils/index.html" class="md-nav__link">utils</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#python-elegant--page-root" class="md-nav__link">Elegant Python</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id1" class="md-nav__link">对象</a>
        </li>
        <li class="md-nav__item"><a href="#some" class="md-nav__link">Some</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#path" class="md-nav__link">环境变量 系统路径 PATH</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id2" class="md-nav__link">对象引用机制</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#is" class="md-nav__link">is & == 标识 & 相等性</a>
        </li>
        <li class="md-nav__item"><a href="#id3" class="md-nav__link">内存管理</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id4" class="md-nav__link">栈区和堆区</a>
        </li>
        <li class="md-nav__item"><a href="#id5" class="md-nav__link">垃圾回收机制</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id6" class="md-nav__link">不变 & 可变</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id7" class="md-nav__link">深浅拷贝</a>
        </li>
        <li class="md-nav__item"><a href="#id8" class="md-nav__link">整数池</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#general" class="md-nav__link">General</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#convention" class="md-nav__link">convention</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#naming-conventions" class="md-nav__link">naming conventions</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id9" class="md-nav__link">函数</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id10" class="md-nav__link">参数传递</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id11" class="md-nav__link">共享传参</a>
        </li>
        <li class="md-nav__item"><a href="#args-kwargs" class="md-nav__link">args & kwargs</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id16" class="md-nav__link">变量作用域</a>
        </li>
        <li class="md-nav__item"><a href="#id17" class="md-nav__link">函数分类</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id18" class="md-nav__link">用户定义的函数</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#lambda" class="md-nav__link">lambda 匿名函数</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id19" class="md-nav__link">内置函数</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#map" class="md-nav__link">map</a>
        </li>
        <li class="md-nav__item"><a href="#id20" class="md-nav__link">规约函数</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id21" class="md-nav__link">装饰器</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id22" class="md-nav__link">参数化装饰器</a>
        </li>
        <li class="md-nav__item"><a href="#id23" class="md-nav__link">现有的有用的装饰器</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id24" class="md-nav__link">函数式编程</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#class" class="md-nav__link">Class</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#none" class="md-nav__link">空  <code class="docutils literal notranslate"><span class="pre">None</span></code></a>
        </li>
        <li class="md-nav__item"><a href="#id25" class="md-nav__link">原子不可变对象</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#int-float" class="md-nav__link">数值  <code class="docutils literal notranslate"><span class="pre">int</span></code>  &  <code class="docutils literal notranslate"><span class="pre">float</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id26" class="md-nav__link">序列</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id27" class="md-nav__link">序列操作</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#listcomps-genexps" class="md-nav__link">listcomps & genexps</a>
        </li>
        <li class="md-nav__item"><a href="#id28" class="md-nav__link">拆包</a>
        </li>
        <li class="md-nav__item"><a href="#id29" class="md-nav__link">切片</a>
        </li>
        <li class="md-nav__item"><a href="#id30" class="md-nav__link">拼接</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id31" class="md-nav__link">复制后拼接</a>
        </li>
        <li class="md-nav__item"><a href="#id32" class="md-nav__link">就地加乘</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id33" class="md-nav__link">排序</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#list" class="md-nav__link">list</a>
        </li>
        <li class="md-nav__item"><a href="#tuple" class="md-nav__link">tuple</a>
        </li>
        <li class="md-nav__item"><a href="#namedtuple" class="md-nav__link">namedtuple</a>
        </li>
        <li class="md-nav__item"><a href="#array" class="md-nav__link">array 数组</a>
        </li>
        <li class="md-nav__item"><a href="#memoryview" class="md-nav__link">memoryview 内存视图</a>
        </li>
        <li class="md-nav__item"><a href="#deque" class="md-nav__link">deque 双向队列</a>
        </li>
        <li class="md-nav__item"><a href="#bytes" class="md-nav__link">bytes 字节</a>
        </li>
        <li class="md-nav__item"><a href="#str" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">str</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#support" class="md-nav__link">散列表-support</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#dict" class="md-nav__link">dict</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#defaultdict" class="md-nav__link">defaultdict</a>
        </li>
        <li class="md-nav__item"><a href="#ordereddict" class="md-nav__link">OrderedDict</a>
        </li>
        <li class="md-nav__item"><a href="#chainmaps" class="md-nav__link">ChainMaps</a>
        </li>
        <li class="md-nav__item"><a href="#counter" class="md-nav__link">Counter</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id34" class="md-nav__link">不可变的映射类型</a>
        </li>
        <li class="md-nav__item"><a href="#set" class="md-nav__link">set</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#sparse-matrix" class="md-nav__link">sparse_matrix</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#scipy-sparse-coo-matrix" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">scipy.sparse.coo_matrix</span></code></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id35" class="md-nav__link">堆</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#heapq-py" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">heapq.py</span></code>  堆队列 = 优先队列算法</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#code" class="md-nav__link">code</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#basic-operaions" class="md-nav__link">Basic operaions</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#n" class="md-nav__link">查找最大或最小的 N 个元素</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id36" class="md-nav__link">复杂对象</a>
        </li>
        <li class="md-nav__item"><a href="#id37" class="md-nav__link">其他常用</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id38" class="md-nav__link">并行迭代对象</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id39" class="md-nav__link">基本操作</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id40" class="md-nav__link">运算符</a>
        </li>
        <li class="md-nav__item"><a href="#iterator" class="md-nav__link">iterator 迭代器</a>
        </li>
        <li class="md-nav__item"><a href="#itertools-module" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">itertools</span></code>  module</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id41" class="md-nav__link">循环</a>
        </li>
        <li class="md-nav__item"><a href="#cls" class="md-nav__link">类 cls</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id42" class="md-nav__link">协议</a>
        </li>
        <li class="md-nav__item"><a href="#id43" class="md-nav__link">借口</a>
        </li>
        <li class="md-nav__item"><a href="#id44" class="md-nav__link">继承类</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id45" class="md-nav__link">可继承的类</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#userdict" class="md-nav__link">UserDict</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id46" class="md-nav__link">魔法方法</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#example" class="md-nav__link">Example</a>
        </li>
        <li class="md-nav__item"><a href="#init" class="md-nav__link">init</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id47" class="md-nav__link">私有属性</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#call" class="md-nav__link">call</a>
        </li>
        <li class="md-nav__item"><a href="#getitem" class="md-nav__link">getitem</a>
        </li>
        <li class="md-nav__item"><a href="#setitem" class="md-nav__link">setitem</a>
        </li>
        <li class="md-nav__item"><a href="#iterableobject" class="md-nav__link">IterableObject 可迭代对象</a>
        </li>
        <li class="md-nav__item"><a href="#id48" class="md-nav__link">字符串表现形式</a>
        </li>
        <li class="md-nav__item"><a href="#id49" class="md-nav__link">重载运算符</a>
        </li>
        <li class="md-nav__item"><a href="#hash" class="md-nav__link">hash</a>
        </li>
        <li class="md-nav__item"><a href="#id50" class="md-nav__link">一些优化</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id51" class="md-nav__link">重写</a>
        </li>
        <li class="md-nav__item"><a href="#re" class="md-nav__link">Re</a>
        </li>
        <li class="md-nav__item"><a href="#id52" class="md-nav__link">用户交互</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#input" class="md-nav__link">Input</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id53" class="md-nav__link">读照片</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#output" class="md-nav__link">output  格式化输出</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id54" class="md-nav__link">读写文件</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id55" class="md-nav__link">文件路径</a>
        </li>
        <li class="md-nav__item"><a href="#txt" class="md-nav__link">txt</a>
        </li>
        <li class="md-nav__item"><a href="#json" class="md-nav__link">json</a>
        </li>
        <li class="md-nav__item"><a href="#id56" class="md-nav__link">快速序列</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id57" class="md-nav__link">测试</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id58" class="md-nav__link">时间</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#time" class="md-nav__link">time</a>
        </li>
        <li class="md-nav__item"><a href="#cprofile-pstats" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">cProfile</span></code>  +  <code class="docutils literal notranslate"><span class="pre">pstats</span></code></a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#error" class="md-nav__link">Error</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id59" class="md-nav__link">字符串相关</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="elegant-python">
<h1 id="python-elegant--page-root">Elegant Python<a class="headerlink" href="#python-elegant--page-root" title="Link to this heading">¶</a></h1>
<div class="admonition- admonition hint">
<p class="admonition-title">迭代器 &amp; 生成器 区别 哪个更好”</p>
</div>
<ul class="simple">
<li><dl class="simple">
<dt><strong>python 程序运行</strong>， <code class="docutils literal notranslate"><span class="pre">python.exe</span> <span class="pre">xxx.py</span></code>  实质上是使用&lt;kbd&gt;python.exe&lt;/kbd&gt; 解释所写的 &lt;kbd&gt;.py文件&lt;/kbd&gt; 里的代码，效率很大程度依赖 exe 解释器的效率。</dt><dd><ol class="arabic simple">
<li><p>&lt;kbd&gt;python.exe&lt;/kbd&gt;  启动</p></li>
<li><p>&lt;kbd&gt;python.exe&lt;/kbd&gt; 把&lt;kbd&gt;.py文件&lt;/kbd&gt; 里的代码当作普通文本内容由硬盘读入内存。（本质上是向操作系统发起系统调用，控制硬件完成读取。）</p></li>
<li><p>&lt;kbd&gt;python.exe&lt;/kbd&gt; 识别 python 语法，执行读入内存的代码。</p></li>
</ol>
</dd>
</dl>
</li>
</ul>
<p><span class="defi">PyObject</span> . 内存中长度可变的内置对象的 C 语言结构体。</p>
<p>[提升python执行效率的若干方法]</p>
<p>一开始应让代码结构尽可能简单。先尽可能在一个文件中完成所有的工作，确定一切都能正确运行后，再将类移到独立的模块中。先找出让你能够编写出可行代码的方式，再尝试让代码更为组织有序。
都应紧跟在类定义后面包含一个文档字符串。这种文档字符串简要地描述类的功能，并遵循编写函数的文档字符串时采用的格式约定。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span>
<span class="linenos">2</span><span class="n">c</span> <span class="o">=</span> <span class="s1">'a'</span>
<span class="linenos">3</span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'a'</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="linenos">4</span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'a'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="linenos">5</span><span class="n">s</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'a'</span><span class="p">,</span> <span class="mi">1</span><span class="p">}</span>
<span class="linenos">6</span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'a'</span><span class="p">:</span><span class="s1">'A'</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="s1">'one'</span><span class="p">}</span>
</pre></div>
</div>
<section id="id1">
<h2 id="id1">对象<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<div class="admonition- admonition note">
<p class="admonition-title">万物皆可对象</p>
<p>一般对象 &amp; 函数对象</p>
</div>
<div class="line-block">
<div class="line">📕 属性</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">__doc__</span></code>  生成对象的帮助文本</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">__dict__</span></code>  储存用户属性</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">dir(obj)</span></code>  查看对象属性</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">callable(obj)</span></code>  查看对象是否可调用</div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">C</span><span class="p">:</span> <span class="k">pass</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="n">C</span><span class="p">()</span>  <span class="c1"># 一般对象</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func</span><span class="p">():</span> <span class="k">pass</span>  <span class="c1"># 函数对象</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">func</span><span class="p">))</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="n">obj</span><span class="p">)))</span>
<span class="go">['__annotations__', '__builtins__', '__call__', '__closure__',</span>
<span class="go">'__code__', '__defaults__', '__get__', '__globals__',</span>
<span class="go">'__kwdefaults__', '__name__', '__qualname__']</span>
</pre></div>
</div>
<p><span class="defi">可调用对象</span> 。可使用 <span class="defi">调用运算符</span> <code class="docutils literal notranslate"><span class="pre">()</span></code>  的对象。可用  <code class="docutils literal notranslate"><span class="pre">callable(obj)</span></code>  进行判断。</p>
<ul class="simple">
<li><p>用户定义： 用  <code class="docutils literal notranslate"><span class="pre">def</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">lambda</span></code>  创建的</p></li>
<li><p>内置函数： <code class="docutils literal notranslate"><span class="pre">map</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">filter</span></code>  …</p></li>
<li><p>内置方法：  <code class="docutils literal notranslate"><span class="pre">dict.get</span></code></p></li>
<li><p>方法：在类的定义体中定义的函数</p></li>
<li><p>类：调用是会运行  <code class="docutils literal notranslate"><span class="pre">__new__</span></code>  创建一个实例，然后运行  <code class="docutils literal notranslate"><span class="pre">__init__</span></code>  初始化实例，然后返回实例</p></li>
<li><p>类的实例：如果定义了  <code class="docutils literal notranslate"><span class="pre">__call__</span></code>  方法</p></li>
<li><p>生成器函数：使用  <code class="docutils literal notranslate"><span class="pre">yield</span></code>  的 函数或方法</p></li>
</ul>
</section>
<section id="some">
<h2 id="some">Some<a class="headerlink" href="#some" title="Link to this heading">¶</a></h2>
<section id="path">
<h3 id="path">环境变量 系统路径 PATH<a class="headerlink" href="#path" title="Link to this heading">¶</a></h3>
<p>python 会在系统路径中找寻所需要的包</p>
<p><code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">sys</span></code></p>
<table>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>meth</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>查看当前系统路径</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">print(sys.path)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>加入系统路径</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sys.path.append(new_path)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>查看环境变量</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">os.getenv(key)</span></code></p></td>
</tr>
</tbody>
</table>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">'HANLP_HOME'</span><span class="p">)</span>  <span class="c1"># 为空就是系统没有储存HANLP_HOME的环境变量</span>
</pre></div>
</div>
</section>
</section>
<section id="id2">
<h2 id="id2">对象引用机制<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<div class="admonition- admonition danger">
<p class="admonition-title">变量是✅贴在对象上的标注，而不是❌承载对象的盒子。</p>
<div class="line-block">
<div class="line"><span class="defi">赋值</span> 。是把变量分配给对象。对象在赋值之前就已经创建。</div>
<div class="line">赋值语句 从右到左执行。</div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span> <span class="o">=</span> <span class="s1">'obj'</span>  <span class="c1"># 先创建 obj 对象，再把 var 绑定给 obj (贴给 obj 上)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">=</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># 链式赋值</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">n</span><span class="p">,</span> <span class="n">m</span>  <span class="c1"># 交叉赋值</span>
<span class="go"># 解压赋值</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="o">*</span><span class="n">_</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="n">nums</span>
<span class="go">a=1, e=4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">nums</span>
<span class="go">a=1, c=3</span>
</pre></div>
</div>
</div>
<img alt="../_images/assign_2.png" src="../_images/assign_2.png"/>
<img alt="../_images/assign_1.png" src="../_images/assign_1.png"/>
<p>每个对象都有标识、类型、值。对象一旦创建， <strong>标识</strong> 绝不会变。可以将标识理解为对象在内存中的地址。  <code class="docutils literal notranslate"><span class="pre">id(var)</span></code>  返回变量所引用的 <strong>对象标识</strong> 的整数表示。</p>
<section id="is">
<h3 id="is">is &amp; == 标识 &amp; 相等性<a class="headerlink" href="#is" title="Link to this heading">¶</a></h3>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">var1</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'name'</span><span class="p">:</span><span class="s1">'Lily'</span><span class="p">,</span> <span class="s1">'sex'</span><span class="p">:</span><span class="s1">'F'</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var2</span> <span class="o">=</span> <span class="n">var1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var3</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'name'</span><span class="p">:</span><span class="s1">'Lily'</span><span class="p">,</span> <span class="s1">'sex'</span><span class="p">:</span><span class="s1">'F'</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var1</span> <span class="ow">is</span> <span class="n">var2</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var1</span> <span class="ow">is</span> <span class="n">var3</span>  <span class="c1"># id 是唯一的标识</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">var1</span> <span class="p">:</span><span class="n">defi</span><span class="p">:</span><span class="err">`</span> <span class="n">var3</span>  <span class="c1"># 内容相同</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">`</span> <span class="pre">B</span></code>  对象内容 ↔️  <code class="docutils literal notranslate"><span class="pre">__eq__</span></code>  【相等】</div>
<div class="line">通常我们关注的是值。</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">A</span> <span class="pre">is</span> <span class="pre">B</span></code>  id地址 是否同一个对象引用。【标识】</div>
<div class="line">经常用来确定是不是  <code class="docutils literal notranslate"><span class="pre">None</span></code> :  <code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">None</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">not</span> <span class="pre">None</span></code></div>
</div>
<div class="admonition-is admonition note">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">is</span></code>  通常比  <code class="docutils literal notranslate"><span class="pre">==</span></code>  快。</p>
<p>因为  <code class="docutils literal notranslate"><span class="pre">is</span></code>  不能重载，所以 python 不需要寻找和调用特殊方法，而是直接比较两个整数ID。 <code class="docutils literal notranslate"><span class="pre">==</span></code>  挂钩的是  <code class="docutils literal notranslate"><span class="pre">__eq__</span></code>  能重载，考虑更有实际意义的比较，相比于直接继承  <code class="docutils literal notranslate"><span class="pre">object</span></code>  的 直接比较ID的  <code class="docutils literal notranslate"><span class="pre">__eq__</span></code> ，大多数类重载了  <code class="docutils literal notranslate"><span class="pre">__eq__</span></code> ，设计到对象的类型、属性、可能复杂嵌套架构的值。需要多种比较。</p>
</div>
<div class="admonition-is-defi-syntaxwarning admonition danger">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">is</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">:defi:`</span></code>  SyntaxWarning</p>
<p>从python 3.8 开始，使用 is 和 is not 运算符时，会抛出  <code class="docutils literal notranslate"><span class="pre">SyntaxWarning</span></code>  语句警告信息。解决方法：建议将对应语句中 is/is not 用 ` 和 != 代替</p>
</div>
</section>
<section id="id3">
<h3 id="id3">内存管理<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<section id="id4">
<h4 id="id4">栈区和堆区<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line"><strong>栈区</strong>：存放的是变量名于内存地址的对应关系，简单理解是变量名存内存地址</div>
<div class="line"><strong>堆区</strong>：存放的是变量值。</div>
<div class="line"><strong>直接引用</strong>：直接从&lt;u&gt;栈区找到堆区&lt;/u&gt;的关系是对变量值的直接引用</div>
<div class="line"><strong>间接引用</strong>：在&lt;u&gt;堆区内找到堆区&lt;/u&gt;的关系是对变量值的间接引用</div>
</div>
<div class="admonition-defi-defi admonition warning">
<p class="admonition-title">变量名的赋值、变量名的传参，传递都是 <span class="defi">栈区</span> 的数据，而且栈的数据是 <span class="defi">变量名与内存地址的对应关系</span> ，是对变量值的引用</p>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span>
<span class="go">lst = [1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span>
<span class="go">lst = [1, 2, 2]</span>
</pre></div>
</div>
</section>
<section id="id5">
<h4 id="id5">垃圾回收机制<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h4>
<p><span class="defi">垃圾变量</span> ， 当一个值 <strong>没有任何变量名和它进行捆绑</strong> ，该变量值就会无法被访问到，涉及到 <strong>引用计数</strong> 的算法</p>
<div class="admonition-del-x admonition danger">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">x</span></code>  的理解</p>
<div class="line-block">
<div class="line">解除了 x 和它所指向对象ID为*的 obj 的绑定关系</div>
<div class="line">ID为* 的 obj 的引用计数 -1</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">value</span>
<span class="c1"># 生成 x-value 的 ID为* 的 obj，把 x 变量名贴到 ID为* 的 obj</span>
<span class="k">del</span> <span class="n">x</span>  <span class="c1"># 解除</span>
</pre></div>
</div>
</div>
<div class="line-block">
<div class="line"><span class="defi">引用计数、标记清楚、分代回收</span></div>
<div class="line"><strong>引用计数</strong>，变量值被引用(指向)的数量，一旦没有引用关系(箭头指向)，引用计数=0，就当成需要回收的&lt;u&gt;垃圾&lt;/u&gt;。垃圾对象会被销毁，释放被分配的内存</div>
<div class="line"><strong>标记清除</strong>，因为间接引用有可能造成&lt;u&gt;循环引用&lt;/u&gt;，导致引用计数不可能为0，以至于变量值永远不可能被删除。所以引入标记清除，将所有变量值进行扫描，若存在无法从栈区访达的变量值，则证明是&lt;u&gt;无直接引用，纯间接引用的垃圾&lt;/u&gt;</div>
<div class="line"><strong>分代回收</strong>，用空间换时间，不会每时每刻地去扫描全部变量值，而是将变量值分类，以不同的频率去扫描归属不同类别的变量。刚刚新建的变量属于 <strong>新生代</strong> 的变量，有可能用完即弃，所以扫描频率会高一点；被引用过很多次的变量属于 <strong>成熟变量</strong>，可能属于一直都要用的重要变量，所以扫描频率会低一些。</div>
</div>
<div class="mermaid">
            flowchart
subgraph 堆区
A -.- B
B -.- A
end
subgraph 栈区
None
end
        </div></section>
</section>
<section id="id6">
<h3 id="id6">不变 &amp; 可变<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line"><span class="defi">不可变</span> 。数据结构的物理内容(即&lt;u&gt;元素保存的引用 item obj 的标识&lt;/u&gt;)不可变，与 item obj 的内容无关。</div>
<div class="line">不可变类型，不能进行 item assignment。赋值会改变元素的 ID。</div>
<div class="line">不可变类型，一旦内容改变，百分之百是指向了新的内容，引用的ID已经改变。</div>
</div>
<p>tuple 是不可变的，只是说 每个元素引用的 ID 不可变，元素可能引用的是可变类型的对象。如果就地修改，元素引用的ID不变，元素引用的内容发生改变。也不会产生 Error。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>
<span class="go">[4309582064, 4312627712]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="nb">id</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">a</span><span class="p">]</span>
<span class="go">[4309582064, 4312627712]  # id 不变</span>
<span class="go">a = (1, [1, 2, 3])  # 内容变</span>
</pre></div>
</div>
<div class="admonition-defi admonition warning">
<p class="admonition-title">变量名的赋值、变量名的传参，传递都是 <span class="defi">栈区</span> 的数据</p>
<p>赋值就是将一个&lt;u&gt;旧的变量名&lt;/u&gt;和
- &lt;u&gt;旧值的地址&lt;/u&gt;解绑关系
- &lt;u&gt;新值的地址&lt;/u&gt;绑定关系</p>
<div class="admonition-a admonition hint">
<p class="admonition-title">对于a重新赋值</p>
<ul class="simple">
<li><p>与 4的地址 解绑关系</p></li>
<li><p>与 5的地址 绑定关系</p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mi">4</span>
<span class="go">id(a) = 4373905744</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="mi">5</span>
<span class="go">id(a) = 4373905776</span>
<span class="go">id(4) = 4373905744</span>
<span class="go">id(5) = 4373905776</span>
</pre></div>
</div>
</div>
<div class="admonition-lst admonition hint">
<p class="admonition-title">对于lst重新赋值</p>
<ul class="simple">
<li><p>解绑关系</p></li>
<li><p>绑定关系</p></li>
</ul>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="go">id(lst) = 4376984512</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="go">id(lst) = 4376922944</span>
</pre></div>
</div>
<div class="admonition-lst-item-assignment admonition hint">
<p class="admonition-title">对于lst 的 item assignment【可变】</p>
<ul class="simple">
<li><p>不改变id地址</p></li>
<li><p>但会改变容器内的地址</p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">lst[1] = 3</span>
<span class="go">id(lst[1]) = 4373905712</span>
<span class="go">id(3) = 4373905712</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="go">lst = [1, 2]</span>
<span class="go">id(lst) = 4376922944 # 和之前一致</span>
<span class="go">id(lst[1]) = 4373905680 # 改了之前的</span>
</pre></div>
</div>
</div>
</div>
<section id="id7">
<h4 id="id7">深浅拷贝<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h4>
<div class="admonition- admonition warning">
<p class="admonition-title">默认作浅拷贝</p>
<p>对不可变类型施加的把戏：赋值时不创建副本，而是返回同一个对象的引用。因为不能进行修改，一旦修改就是 new 一个新对象 with 新 ID。</p>
</div>
<div class="line-block">
<div class="line"><span class="defi">浅拷贝</span> 。无论如何，直接指向 item 所引用的对象地址。</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">a.copy()</span></code>  &amp; 构造方法 &amp;  <code class="docutils literal notranslate"><span class="pre">[:]</span></code></div>
<div class="line"><span class="defi">深拷贝</span> 。区分要拷贝的是可变的还是不可变的。</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">b</span> <span class="pre">=</span> <span class="pre">copy.deepcopy(a)</span></code></div>
</div>
<ol class="arabic simple">
<li><p>&lt;u&gt;不可变&lt;/u&gt;，指向原来的地址（地址相同，同一个对象）；</p></li>
<li><p>&lt;u&gt;可变的&lt;/u&gt;，重新构建一个，copy内容（地址不同，内容相同）。</p></li>
</ol>
<div class="admonition-ab-a-b admonition note">
<p class="admonition-title">对于容器类型的分别：看是否在作出【修改之后 ab不一样】🟰 【a b 是独立的】</p>
<div class="line-block">
<div class="line">修改从元素对象分：可变元素 &amp; 不可变元素；从ID变化分 ID变 &amp; ID不变。</div>
<div class="line">不可变元素一旦改变，只能进行赋值，ID一定会变。可变元素只有在赋值的时候 ID变，就地更改时ID不会变（譬如说 item assignment）。</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">[1,</span> <span class="pre">(1,</span> <span class="pre">2),</span> <span class="pre">[1,</span> <span class="pre">2]]</span></code></div>
</div>
<table>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>不可变的赋值</p></th>
<th class="head"><p>可变的赋值</p></th>
<th class="head"><p>可变的item assignment</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b[1]='a'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b[2]='a'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b[2][0]='a'</span></code></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>元组</p></td>
<td><p>列表</p></td>
<td><p>列表的item assignment</p></td>
</tr>
<tr class="row-even"><td><p>浅拷贝</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p>深拷贝</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
</tr>
</tbody>
</table>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">]</span>
<span class="go">lst=[1, [1]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">+=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">lst=[1, [1, 1]]</span>
</pre></div>
</div>
</div>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column docutils">
<img alt="../_images/memory_1.png" src="../_images/memory_1.png"/>
</div>
<div class="sd-col sd-d-flex-column docutils">
<p>a 是不可变；b是可变。假设创建对象的ID从1开始。
1. 创建 ID=1的1 &amp; ID=2列表[1]
2. 把 a &amp; b 分别贴到 ID=1 &amp; ID=2上
3. 创建 ID=3的列表，把[0]位贴到ID=1，[1]位贴到ID=2。而不是贴到 a &amp; b 上
4. 创建 ID=4的2，把 a 从ID=1撕掉，给ID=3
5. 修改b，b没有撕掉，其实修改ID=3
lst的位[0]在ID=1上与a无关；位[1]在ID=3上，所以也修改了。</p>
</div>
</div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">copy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">11</span><span class="p">,</span> <span class="mi">22</span><span class="p">],</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">)]</span>  <span class="c1"># [不可变, 可变， 不可变]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l2</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">l3</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span>
</span><span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">id</span><span class="p">(</span><span class="n">l2</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">id</span><span class="p">(</span><span class="n">l1</span><span class="p">)</span><span class="o">==</span><span class="nb">id</span><span class="p">(</span><span class="n">l3</span><span class="p">)</span>
</span><span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i2</span> <span class="p">:</span> <span class="nb">id</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span><span class="o">==</span><span class="nb">id</span><span class="p">(</span><span class="n">i1</span><span class="p">),</span> <span class="n">l1</span> <span class="p">,</span><span class="n">l2</span><span class="p">))</span>
<span class="go">[True, True, True]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i1</span><span class="p">,</span> <span class="n">i3</span> <span class="p">:</span> <span class="nb">id</span><span class="p">(</span><span class="n">i1</span><span class="p">)</span><span class="o">==</span><span class="nb">id</span><span class="p">(</span><span class="n">i3</span><span class="p">),</span> <span class="n">l1</span> <span class="p">,</span><span class="n">l3</span><span class="p">))</span>
<span class="go">[True, False, True]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+=</span><span class="p">[</span><span class="mi">33</span><span class="p">,</span><span class="mi">44</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l1</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">l1=[1, [22, 33, 44], (7, 8, 9, 10), -1]</span>
<span class="go">l2=[0, [22, 33, 44], (7, 8)]</span>
<span class="go">l3=[0, [11, 22], (7, 8)]</span>
</pre></div>
</div>
<img alt="../_images/memory_2.jpg" src="../_images/memory_2.jpg"/>
</section>
<section id="id8">
<h4 id="id8">整数池<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h4>
<p><strong>理论上的正常情况</strong>，变量都是需要申请 <strong>内存空间（id不同）</strong> 存储数据然后把地址返回给变量名引用。但在 Python解释器（一般是cpython） <span class="defi">[-5, 256]</span> 是不会申请新的内存，而都是 <strong>引用同一块早已在解释器运行时就开辟的内存,==小整数池==</strong>，导致 <strong>id相同</strong>。另外 pycharm/vscode 有 <span class="defi">大整数池</span> 的概念</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">"""正常来说，每次申请，id都不一样"""</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">9999999999999</span><span class="p">,</span> <span class="mi">9999999999999</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="ow">is</span> <span class="n">b</span>
<span class="go">Fasle</span>
<span class="go">id(a) = 4336403888</span>
<span class="go">id(b) = 4336403152</span>

<span class="go">""" 在vscode里id依旧一样：大整数池"""</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span><span class="p">(</span><span class="mi">221111111</span><span class="p">)</span>
<span class="go">4336403952</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span><span class="p">(</span><span class="mi">221111111</span><span class="p">)</span>
<span class="go">4336403952</span>
</pre></div>
</div>
<p>[小整数池]</p>
</section>
</section>
</section>
<section id="general">
<h2 id="general">General<a class="headerlink" href="#general" title="Link to this heading">¶</a></h2>
<section id="convention">
<h3 id="convention">convention<a class="headerlink" href="#convention" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>prefernce</dt><dd><ul>
<li><p>PEP8建议 <strong>indent using space 空格缩进 = 4</strong>，这既可提高可读性，又留下了足够的多级缩进空间。</p></li>
<li><p><strong>垂直参考线</strong>，帮助你遵守行长不能超过79字符的约定。</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">.py</span></code>  file</dt><dd><ul>
<li><p>在开头加上姓名和当前日期，再用一句话阐述程序的功能</p></li>
<li><p>声明编码方式:  <code class="docutils literal notranslate"><span class="pre">#</span> <span class="pre">-*-</span> <span class="pre">coding:utf-8</span> <span class="pre">-*-</span></code></p></li>
<li><dl class="simple">
<dt>可使用空行来组织代码，但不要滥用。</dt><dd><ul>
<li><p>在类中，可使用一空行来分隔方法；</p></li>
<li><p>在模块中，可使用两个空行来分隔类</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p>诸如  <code class="docutils literal notranslate"><span class="pre">==,</span> <span class="pre">&gt;=,</span> <span class="pre">&lt;=</span></code> 等**比较运算符**两边各添加一个空格，例如， <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">age</span> <span class="pre">&lt;</span> <span class="pre">4</span></code>  :要比  <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">age&lt;4</span></code>  好。</p></li>
<li><p><strong>文档字符串, docstring</strong>, 的注释，描述了函数是做什么的。文档字符串用三引号括起，Python使用它们来生成有关程序中函数的文档。</p></li>
</ul>
<section id="naming-conventions">
<h4 id="naming-conventions">naming conventions<a class="headerlink" href="#naming-conventions" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><p><strong>驼峰命名</strong> 的时候</p></li>
<li><p><strong>使用单数和复数式名称</strong>，可帮助你判断代码段处理的是单个列表元素还是整个列表。</p></li>
</ul>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>类型</p></th>
<th class="head"><p>notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Package，Module.py，全局变量，Function</p></td>
<td rowspan="2"><p>全小写，下划线</p></td>
</tr>
<tr class="row-odd"><td><p>实例变量 instance varaibles</p></td>
</tr>
<tr class="row-even"><td><p>Classes</p></td>
<td><p><strong>驼峰命名</strong>, 所有的缩写都要大写： <code class="docutils literal notranslate"><span class="pre">HTTPSever</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>常量 constant</p></td>
<td><p><strong>全大写</strong>，下划线</p></td>
</tr>
</tbody>
</table>
<p>实例变量 instance varaibles</p>
<ul class="simple">
<li><p>Non-public instance variables should begin with a single underscore</p></li>
<li><p>If an instance name needs to be mangled, two underscores may begin its name</p></li>
</ul>
<p>[CodingConvention] | [python3-cookbook] | [Python 中的下划线命名规则]</p>
</section>
</section>
</section>
<section id="id9">
<h2 id="id9">函数<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h2>
<div class="admonition-u-function-u admonition note">
<p class="admonition-title">函数也是对象的一种，是 &lt;u&gt; <code class="docutils literal notranslate"><span class="pre">function</span></code>  类的实例&lt;/u&gt;, 所以可以赋给变量，通过变量名调用；作为参数传给别的函数。。。</p>
<div class="line-block">
<div class="line"><span class="defi">function 类</span></div>
<div class="line">📕 函数对象特有属性  <code class="docutils literal notranslate"><span class="pre">dir(func)</span></code>  查看对象属性</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">__call__:method-wrapper</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">__closure__:tuple=None</span></code> <span class="defi">函数闭包</span> 对自由变量的的绑定</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">__defaults__:tuple</span></code>  放 <strong>形式参数</strong> 的默认值</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">__globals__:dict</span></code>  所在 module 的全局变量</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">__kwdefaults__</span></code>  放 <strong>关键字形式参数</strong> 的默认值</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">__name__</span></code>  函数名</div>
</div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span><span class="w">    </span><span class="sd">""" return param """</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">n</span>

<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span><span class="n">func</span>
</span><span class="go">f=func=&lt;function func at 0x102fe88b0&gt;</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class="go">f(1)=func(1)=1</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
</span><span class="go">[0, 1, 2]</span>
</pre></div>
</div>
<dl class="simple">
<dt><span class="defi">higher-order func 高阶函数</span> 。接受 <strong>函数</strong> 为参数，或把 <strong>函数</strong> 作为结果返回的函数。</dt><dd><p>map &amp; filter &amp; reduce &amp; apply &amp;…
sorted(因为能用key去接受k函数作为参数，把k函数结果作为排序的依据)</p>
</dd>
</dl>
<div class="line-block">
<div class="line"><span class="defi">函数内省 Function introspection</span> 。是指通过一些机制来获取 <strong>函数的元信息</strong>，例如函数名称、参数列表、返回值类型等。它使得程序能够在运行时检查函数的结构和特性，进而进行动态的操作和分析。</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">type()</span></code> : 获取对象的类型</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">dir()</span></code> : 返回一个对象的所有属性和方法的列表。</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">inspect</span> <span class="pre">module</span></code> ： <code class="docutils literal notranslate"><span class="pre">inspect.isfunction(obj)</span></code> :判断一个对象是否是函数， <code class="docutils literal notranslate"><span class="pre">inspect.getargspec(func)</span></code> : 获取函数的参数信息， <code class="docutils literal notranslate"><span class="pre">inspect.signature(func)</span></code>  : 获取函数的签名信息。</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">__doc__</span></code>  属性：函数的文档字符串</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">装饰器</span></code>  ：装饰器是一种修改函数行为的方式，也可以用于函数内省。通过定义一个装饰器函数，可以在函数执行前后进行一些操作，例如记录日志、计时等。装饰器可以用来动态地修改函数的行为，从而实现函数内省的目的。</div>
</div>
<p><span class="defi">泛函数 generic function</span> 。根据第一个参数的类型，以不同方式装饰</p>
<div class="line-block">
<div class="line"><span class="defi">空函数</span></div>
<div class="line">应用场景：写大纲，提醒 developer 有什么功能，在预设行为的时候</div>
</div>
<section id="id10">
<h3 id="id10">参数传递<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h3>
<section id="id11">
<h4 id="id11">共享传参<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h4>
<div class="admonition-notes admonition note">
<p class="admonition-title">notes</p>
<p>参数传递 根据引用的方式分为</p>
<ul class="simple">
<li><dl class="simple">
<dt>按值传递，函数得到参数的副本。</dt><dd><p>传 a 的时候，拿到 a</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>按引用传递，函数得到指向参数的指针</dt><dd><p>传 a 的时候，拿到 指向 a 的指针</p>
</dd>
</dl>
</li>
</ul>
</div>
<p><span class="defi">共享传参 call by sharing</span> 。函数的各个形式的参数获得实参中各个应用的副本。</p>
<div class="admonition- admonition danger">
<p class="admonition-title">参数传递是按值传递，但这里的值是引用</p>
<div class="line-block">
<div class="line">参数传递是【引用】按值的传递。函数内部的形参是实参的别名，就是贴在实参所引用的对象上，但是不能解除实参和对象的绑定关系。</div>
<div class="line">所以 函数内部能&lt;u&gt;修改&lt;/u&gt;作为参数传入的可变类型。</div>
</div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">a</span> <span class="o">+=</span> <span class="n">b</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">a</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">3</span>
<span class="go">x, y=(1, 2)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">(1, 1, 2, 2)</span>
<span class="go">x, y=((1, 1), (2, 2))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="go">[1, 1, 2, 2]</span>
<span class="go">x, y=([1, 1, 2, 2], [2, 2])  # 可变类型对象被修改</span>
</pre></div>
</div>
<div class="admonition-dict-none admonition danger">
<p class="admonition-title">不要使用可变类型  <code class="docutils literal notranslate"><span class="pre">[]</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">dict{}</span></code>  作为默认参数，而是选择  <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
<div class="line-block">
<div class="line">默认参数会自建对象，如果没有指定，就一律贴在其上，所以如果可变类型变化，引用的ID对象变了，只要绑定在这个ID对象（只要不是赋值），都随着一起变化。</div>
<div class="line">默认值在定义函数计算（通常在加载模块时进行对象创建），因此默认值会变成函数对象的属性，凡是没有传入，都会指向这个在一开始就创建好的默认值对象（ID为同一个）。</div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">a</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">a</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">([</span><span class="mi">3</span><span class="p">])</span>
<span class="go">[3, 3]  &lt;- [3]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span> <span class="o">=</span> <span class="n">func</span><span class="p">()</span>
<span class="go">res=[1, 2, 3]  &lt;- [1, 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">res=[1, 2, 3, -1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">()</span>  <span class="c1"># 默认参数被改变</span>
<span class="go">[1, 2, 3, -1, 3] &lt;- [1, 2, 3, -1]</span>
<span class="go">res=[1, 2, 3, -1, 3]</span>
</pre></div>
</div>
</div>
<div class="admonition- admonition warning">
<p class="admonition-title">如果定义参数接受可变参数，谨慎考虑调用方是否期望修改传入的参数。</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">C</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">lst</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">modified</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">lst</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># 当需要空的时候 用 None 来判定</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lst</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">elif</span> <span class="n">modified</span> <span class="o">==</span> <span class="n">Ture</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lst</span> <span class="o">=</span> <span class="n">lst</span>  <span class="c1"># 指向传入的 ID，里面变，外面同样 ID的 也会变</span>
        <span class="k">elif</span> <span class="n">modified</span> <span class="o">==</span> <span class="n">Flase</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lst</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>  <span class="c1"># 浅拷贝，for 元素都是不可变的</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">lst</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">()</span> <span class="c1"># 深拷贝，for 元素有可变的</span>
</pre></div>
</div>
</div>
</section>
<section id="args-kwargs">
<h4 id="args-kwargs">args &amp; kwargs<a class="headerlink" href="#args-kwargs" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line"><span class="defi">仅限关键词参数 kwargs</span> 。只能用 <strong>关键字模式</strong> 传递。在函数定义时放在  <code class="docutils literal notranslate"><span class="pre">*args</span></code>  的后面.</div>
<div class="line"><span class="defi">一般参数 args</span> 。定位模式 &amp; 关键字模式都可以。在函数定义时放在  <code class="docutils literal notranslate"><span class="pre">*args</span></code>  的前面</div>
<div class="line"><span class="defi">定位模式，定位参数</span> 。传入时没有用参数名捆绑，就按位置进行一一对应。用定位模式的是定位参数。</div>
<div class="line"><span class="defi">关键字模式，关键词参数</span> 。传入时有用参数名捆绑，用关键词模式的是关键词参数。</div>
</div>
<p>不设默认值 🟰 强制传入实参。无论是 args &amp; kwargs</p>
<div class="admonition-tuple-dict admonition note">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">*</span></code>  展开 tuple 🟰 一般参数 &amp;  <code class="docutils literal notranslate"><span class="pre">**</span></code>  展开 dict 🟰 关键词参数</p>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">general</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">kw_only</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
</span><span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'*args=</span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'**kwargs=</span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>

<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">()</span>
</span><span class="go">TypeError: func() missing 1 required positional argument: 'general'</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">)</span>
</span><span class="go">*args=('a', 'b', 'c') **kwargs={}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'c'</span><span class="p">)</span>
<span class="go">*args=('a', 'b') **kwargs={'c': 'c'}</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="s1">'a'</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span> <span class="s1">'b'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</span><span class="go">SyntaxError: positional argument follows keyword argument</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="s1">'a'</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">general</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span class="go">*args=()  **kwargs={'args': 'a', 'b': 'b'}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">'general'</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'a'</span><span class="p">:</span> <span class="s1">'a'</span><span class="p">}</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
</span><span class="go">*args=()  **kwargs={'a': 'a'}</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
</span><span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">params</span><span class="p">)</span>
<span class="go">*args=(2, 3)  **kwargs={}</span>
</pre></div>
</div>
<p>&lt;p&gt;&amp;#9312; kw-only 只允许使用关键字模式，因为在 <a href="#id12"><span class="problematic" id="id13">*</span></a>args 后面&lt;/p&gt;
&lt;p&gt;&amp;#9316; 没有指定默认值的，得不到参数就会报错&lt;/p&gt;
&lt;p&gt;&amp;#9318; 都是定位模式传入，按顺序进行分配，多出的不定量的参数会被 <a href="#id14"><span class="problematic" id="id15">*</span></a>args 捕获，存入元组&lt;/p&gt;
&lt;p&gt;&amp;#9320; 按定位模式传入多余的参数只会被 args 捕获，而不会被 kwargs捕获。按关键字模式传入的多余的才会被**kwargs捕获，存入字典&lt;/p&gt;
&lt;p&gt;&amp;#9322; 在传入时，定位模式的参数一定要在采用关键字模式的参数前面。&lt;/p&gt;
&lt;p&gt;&amp;#9324; 在传入时，一般参数可以使用关键字模式，此时不需要考虑位置关系。&lt;/p&gt;
&lt;p&gt;&amp;#9327; 字典传入的是纯关键字模式&lt;/p&gt;
&lt;p&gt;&amp;#9329; 元组传入的是定位模式，此时不能存在没有指定默认值的仅限关键字的参数。&lt;/p&gt;</p>
<aside class="system-message" id="id12">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/home/runner/work/io/io/docs/source/python/elegant.rst</span>, line 566); <em><a href="#id13">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</aside>
<aside class="system-message" id="id14">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/home/runner/work/io/io/docs/source/python/elegant.rst</span>, line 566); <em><a href="#id15">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</aside>
</section>
</section>
<section id="id16">
<h3 id="id16">变量作用域<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h3>
<p><span class="defi">名称空间 namespace</span> ：存放名字的地方，是对栈区的划分。名称空间的”嵌套”关系是以函数定义阶段为准</p>
<img alt="../_images/namespace_1.png" src="../_images/namespace_1.png"/>
<img alt="../_images/namespace_2.png" src="../_images/namespace_2.png"/>
<div class="line-block">
<div class="line">按照由上至下： 内置名称空间 》 全局名称空间 》 局部名称空间。</div>
<div class="line"><strong>加载顺序</strong>：内置名称空间&gt;全局名称空间&gt;局部名称空间</div>
<div class="line"><strong>销毁顺序</strong>：局部名称空间&gt;全局名空间&gt;内置名称空间</div>
</div>
<div class="line-block">
<div class="line">名字的查找优先级：当前所在的位置向上一层一层查找</div>
<div class="line">如果当前在局部名称空间: 局部名称空间-&gt;全局名称空间-&gt;内置名称空间</div>
</div>
<div class="admonition-python-u-u-defi admonition danger">
<p class="admonition-title">python 在没有任何声明的前提下，假定在函数定义体内中&lt;u&gt;赋值&lt;/u&gt;的变量是 <span class="defi">局部变量</span> 。</p>
<div class="line-block">
<div class="line">如果想在函数定义体内赋值，还想 python 解释器把其认为全局变量，需要声明  <code class="docutils literal notranslate"><span class="pre">global</span></code></div>
<div class="line">如果再局部想要修改全局的名字对应的值（不可变类型），需要用global</div>
<div class="line">[Python 全局变量]</div>
</div>
</div>
<div class="line-block">
<div class="line"><span class="defi">全局名称空间</span></div>
<div class="line">存放的名字：只要不是函数内定义、也不是内置的，剩下的都是全局名称空间的名字。包括 import 进来的函数和变量</div>
<div class="line">存活周期：python文件执行则产生，python 文件运行完毕后销毁</div>
</div>
<div class="line-block">
<div class="line"><span class="defi">局部名称空间</span></div>
<div class="line">存放的名字：在调用函数时，运行函数体代码过程中产生的函数内的名字</div>
<div class="line">存活周期：在调用函数时存活，函数调用完毕后则销毁</div>
</div>
<div class="line-block">
<div class="line"><span class="defi">闭包</span> 。延伸了作用域的函数，其中包含函数定义体中运用，但不在定义体内定义的 <strong>非全局变量</strong>。一般出现在嵌套函数里。闭包是一种函数，他会保留定义函数时存在的自由变量的绑定，哪怕是定义作用域不能用，绑定也能使用。</div>
<div class="line"><span class="defi">自由变量</span> 。未在本地作用域内绑定的变量。用  <code class="docutils literal notranslate"><span class="pre">nonlocal</span></code>  声明，哪怕是在函数定义体内赋值，python 解释器会把其认为自由变量(类  <code class="docutils literal notranslate"><span class="pre">global</span></code>  )。保存在 返回对象的 <code class="docutils literal notranslate"><span class="pre">.__code__.co_afreevars</span></code>   &amp;  <code class="docutils literal notranslate"><span class="pre">.__closure__[idx].cell_contents</span></code>  一一对应。</div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">outer</span><span class="p">():</span>
    <span class="c1"># 3-10 inner 的闭包延伸到 inner 之外，包含 自由变量 的定义</span>
<span class="hll">    <span class="n">series</span> <span class="o">=</span> <span class="p">[]</span>
</span><span class="hll">    <span class="n">total</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">inner</span><span class="p">(</span><span class="n">new_v</span><span class="p">):</span>
</span><span class="hll">        <span class="k">nonlocal</span> <span class="n">total</span><span class="p">,</span> <span class="n">count</span>
</span><span class="hll">        <span class="n">total</span> <span class="o">+=</span> <span class="n">new_v</span>  <span class="c1"># 哪怕赋值了会解释自由变量。</span>
</span><span class="hll">        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span class="hll">        <span class="n">series</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_v</span><span class="p">)</span>  <span class="c1"># 自由变量</span>
</span><span class="hll">        <span class="k">return</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="nb">sum</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nb">len</span><span class="p">(</span><span class="n">series</span><span class="p">)</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">total</span><span class="o">/</span><span class="n">count</span><span class="si">}</span><span class="s1">'</span>
</span>
    <span class="k">return</span> <span class="n">inner</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">avg</span> <span class="o">=</span> <span class="n">outer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="go">'10.0 10.0'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg</span><span class="p">(</span><span class="mi">11</span><span class="p">)</span>
<span class="go">'10.5 10.5'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg2</span> <span class="o">=</span> <span class="n">outer</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg2</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">'0 0'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg</span><span class="o">.</span><span class="vm">__code__</span><span class="o">.</span><span class="n">co_freevars</span>
<span class="go">('count', 'series', 'total')</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">avg</span><span class="o">.</span><span class="vm">__closure__</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">cell_contents</span>
<span class="go">[10, 11]</span>
</pre></div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">glo</span> <span class="o">=</span> <span class="s1">'a'</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">glo</span><span class="p">)</span>  <span class="c1"># 使用内部变量</span>
    <span class="n">glo</span> <span class="o">=</span> <span class="mi">3</span>     <span class="c1"># 定义内部变量</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">glo</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">&gt;&gt; func()</span>
<span class="go">UnboundLocalError: cannot access local variable 'glo'</span>
</pre></div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">Sol_A</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">glo</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">glo</span><span class="p">)</span>
    <span class="n">glo</span> <span class="o">=</span> <span class="s1">'A'</span>    <span class="c1"># 修改外部变量</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">glo</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">Sol_B</span><span class="p">():</span>
    <span class="n">glo</span> <span class="o">=</span> <span class="s1">'B'</span>    <span class="c1"># 定义内部变量</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">glo</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Sol_A</span><span class="p">()</span>
<span class="go">a</span>
<span class="go">A</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">glo</span><span class="p">)</span>  <span class="c1"># 外部变量改变</span>
<span class="go">A</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sol_B</span><span class="p">()</span>
<span class="go">B</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">glo</span><span class="p">)</span>  <span class="c1"># 外部变量不变</span>
<span class="go">A</span>
</pre></div>
</div>
</section>
<section id="id17">
<h3 id="id17">函数分类<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h3>
<section id="id18">
<h4 id="id18">用户定义的函数<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">def</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">lambda</span></code>  创建</p>
<section id="lambda">
<h5 id="lambda">lambda 匿名函数<a class="headerlink" href="#lambda" title="Link to this heading">¶</a></h5>
<p>在表达式内创建，定义体内不能赋值，不能用 while for。</p>
</section>
</section>
<section id="id19">
<h4 id="id19">内置函数<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h4>
<p>生成迭代器 iterator (后续需要搭配  <code class="docutils literal notranslate"><span class="pre">list</span></code>  等储存)： <code class="docutils literal notranslate"><span class="pre">map</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">filter</span></code></p>
<p>规约函数： <code class="docutils literal notranslate"><span class="pre">sum</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">all</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">any</span></code></p>
<section id="map">
<h5 id="map">map<a class="headerlink" href="#map" title="Link to this heading">¶</a></h5>
<div class="admonition-map-for admonition note">
<p class="admonition-title">为什么 map 运行速度比 for 循环要快</p>
<div class="line-block">
<div class="line">map 用 C 编写的并且经过高度优化, <strong>底层自动实现并行</strong></div>
<div class="line">使用 map() 的第二个优势与内存消耗有关。使用 for 循环，您需要将整个列表存储在系统的内存中。使用 map() 可以按需获得项目，并且在给定时间系统内存中只有一个项目。</div>
</div>
</div>
<p>[Python’s map(): Processing Iterables Without a Loop]</p>
<p><code class="docutils literal notranslate"><span class="pre">map(function,</span> <span class="pre">iterable[,</span> <span class="pre">iterable1,</span> <span class="pre">iterable2,...,</span> <span class="pre">iterableN])</span></code></p>
<p>如果我们将n序列传递给map()，则该函数必须采用n个参数，并且并行使用序列中的项，直到用尽最短的序列。</p>
<div class="admonition- admonition danger">
<p class="admonition-title">死循环</p>
<p>纯计算无 IO 的死循环会导致致命的效率问题</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1  有 IO 会卡 IO 所以不会死机</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="n">name</span> <span class="o">=</span> <span class="nb">input</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># 2 没有 IO 会耗尽计算资源</span>
<span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
    <span class="mi">1</span><span class="o">+</span><span class="mi">1</span>
</pre></div>
</div>
</div>
</section>
<section id="id20">
<h5 id="id20">规约函数<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">sum(iterable)</span></code> <strong>累计</strong> 之前的结果求和</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">all(iterable)</span></code>  只有全 True 才是 True</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">any(iterable)</span></code>  一个 True 都是 True</div>
</div>
</section>
</section>
<section id="id21">
<h4 id="id21">装饰器<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h4>
<p><span class="defi">装饰器</span> 是可调用对象，参数是另外一个函数（ <span class="defi">被装饰的函数</span> ）。装饰器可能： 1️⃣ 处理被装饰的函数再将其返回； 2️⃣ 将其替换成另外一个函数或可调用对象在返回。</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">decorate</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>  <span class="c1"># 装饰器</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'running decorator(</span><span class="si">{</span><span class="n">func</span><span class="si">}</span><span class="s1">)'</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">function</span>  <span class="c1"># 必须返回**一个可调用对象或者函数**s</span>

<span class="nd">@decorate</span>  <span class="c1"># 装饰</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="k">pass</span>
</pre></div>
</div>
<div class="admonition-func-decorate-func-func-decorate-func admonition danger">
<p class="admonition-title">等于的是   <code class="docutils literal notranslate"><span class="pre">func</span> <span class="pre">=</span> <span class="pre">decorate(func)</span></code>  而不是  <code class="docutils literal notranslate"><span class="pre">func()</span> <span class="pre">=</span> <span class="pre">decorate(func)</span></code></p>
<ul>
<li><p>装饰器会在被装饰函数定义之后立刻执行，通常是加载模块时。即背地里运行。所以一般会分开定义。装饰器在一个模块，应用在其他模块的函数上。但是不代表马上运行被装饰的函数。</p>
<blockquote>
<div><div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">func</span> <span class="o">=</span> <span class="n">decorate</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="go">running decorator(&lt;function func at 0x1356...&gt;)</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<div class="line-block">
<div class="line">如果  <code class="docutils literal notranslate"><span class="pre">decorate</span></code>  内 return 的是别的函数 🟰  <code class="docutils literal notranslate"><span class="pre">func=deco.return_func</span></code>  ，那么  <code class="docutils literal notranslate"><span class="pre">func.__name__</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">func.__doc__</span></code>  变成了  <code class="docutils literal notranslate"><span class="pre">deco.return_func.__name__</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">deco.return_func.__doc__</span></code></div>
<div class="line">✏️  <code class="docutils literal notranslate"><span class="pre">functools.wraps</span></code> ，不仅能传递，还能实现关键字传参。</div>
</div>
<ul>
<li><p>装饰器需要返回 <strong>一个可调用对象或者函数</strong>，才能在运行  <code class="docutils literal notranslate"><span class="pre">func()</span></code>  时返回来 跟后面的  <code class="docutils literal notranslate"><span class="pre">()</span></code>  继续用。&lt;u&gt;所以如果 func 需要传参，一般装饰器需要进行嵌套。&lt;/u&gt;</p>
<blockquote>
<div><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">func</span><span class="p">()</span> <span class="c1"># 等同于 decorate(func)()</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</div>
<div class="admonition- admonition warning">
<p class="admonition-title">被装饰的函数完全是作为参数传入.</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">decorate(func)</span></code>  ，此时没有带 <code class="docutils literal notranslate"><span class="pre">()</span></code> , 所以  <code class="docutils literal notranslate"><span class="pre">func</span></code>  还没被调用。</div>
<div class="line">在  <code class="docutils literal notranslate"><span class="pre">deco1</span></code>  函数体内 带着  <code class="docutils literal notranslate"><span class="pre">()</span></code>  或者在  <code class="docutils literal notranslate"><span class="pre">deco2</span></code>  里 被返回 才是被调用运行,  <code class="docutils literal notranslate"><span class="pre">deco3</span></code>  就是完全没运行</div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">deco1</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">func</span><span class="p">()</span> <span class="o">+</span> <span class="mi">1</span>  <span class="c1"># 在函数体内被运行</span>
    <span class="k">return</span> <span class="n">res</span>

<span class="k">def</span> <span class="nf">deco2</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="c1"># func = deco2(func) = func</span>
    <span class="k">return</span> <span class="n">func</span>  <span class="c1"># deco2(func) () = func ()</span>

<span class="k">def</span> <span class="nf">deco3</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="c1"># 没运行 func 运行的是 inner</span>
    <span class="c1"># func = deco3(func) = inner</span>
    <span class="k">def</span> <span class="nf">inner</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">inner</span>  <span class="c1"># deco3(func) () = inner ()</span>
</pre></div>
</div>
</div>
<div class="admonition- admonition note">
<p class="admonition-title">装饰器可以叠放</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="nd">@d1</span>
<span class="nd">@d2</span>
<span class="k">def</span> <span class="nf">func</span><span class="p">():</span>
    <span class="k">pass</span>
<span class="c1"># 等价于 func = d1(d2(func))</span>
<span class="c1"># func() = d1(d2(func))()</span>
</pre></div>
</div>
</div>
<div class="admonition- admonition hint">
<p class="admonition-title">更新策略。</p>
<p>当商场做营销，不断更新不同的折扣活动，在结算的时候往往需要计算不同策略下的价格，然后进行比较。如果把 所有的活动写进去结算函数，会使结算函数体变长还会在更改的时候需要修改着至关重要的结算函数，使错误的可能增高。所以思路大多都是把分开一个个策略写成函数，然后放进一个全局变量的数组里，for 循环地去 call 数组里的策略。但是在维持数组需要记得相应的函数名，对数组里的元素进行添删，比较麻烦。所以采用装饰器来完成 <strong>“注册”</strong> 这一功能</p>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">promos</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">promotion</span><span class="p">(</span><span class="n">promo_func</span><span class="p">):</span>
    <span class="n">promos</span><span class="o">.</span><span class="n">appred</span><span class="p">(</span><span class="n">promo_func</span><span class="p">)</span>  <span class="c1"># 只是放进去，不改变 promo_func 本身</span>
    <span class="k">return</span> <span class="n">promo_func</span>

<span class="nd">@promotion</span>  <span class="c1"># 需要就加上</span>
<span class="k">def</span> <span class="nf">fidelity</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">discount</span>

<span class="c1"># @promotion  # 不需要就注释</span>
<span class="k">def</span> <span class="nf">large_order</span><span class="p">(</span><span class="n">order</span><span class="p">)</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="n">discount</span>

<span class="n">der</span> <span class="n">best_promo</span><span class="p">(</span><span class="n">order</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="n">promo</span><span class="p">(</span><span class="n">order</span><span class="p">)</span> <span class="k">for</span> <span class="n">promo</span> <span class="ow">in</span> <span class="n">promos</span><span class="p">)</span>
</pre></div>
</div>
<section id="id22">
<h5 id="id22">参数化装饰器<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h5>
<ol class="arabic simple">
<li><p>被装饰的函数本身需要参数</p></li>
<li><p>装饰器本身也想拥有参数</p></li>
</ol>
<div class="admonition-func-u-func-u admonition note">
<p class="admonition-title">装饰器需要返回 <strong>一个可调用对象或者函数</strong> ，才能在运行  <code class="docutils literal notranslate"><span class="pre">func()</span></code>  时返回来 跟后面的  <code class="docutils literal notranslate"><span class="pre">()</span></code>  继续用。&lt;u&gt;所以如果 func 需要传参，一般装饰器需要进行嵌套。&lt;/u&gt;</p>
</div>
<p>被装饰的函数本身需要参数 + 装饰器本身也想拥有参数</p>
<div class="admonition- admonition hint">
<p class="admonition-title">一个参数化的注册计时装饰器</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span><span class="o">,</span> <span class="nn">functools</span>
<span class="n">registry</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>  <span class="c1"># 增删更快</span>

<span class="hll"><span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="n">active</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>  <span class="c1"># 装饰工厂函数</span>
</span><span class="hll">    <span class="k">def</span> <span class="nf">decorate</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>  <span class="c1"># 真正的装饰器（接受的是函数</span>
</span>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'running register=</span><span class="si">{</span><span class="n">active</span><span class="si">}</span><span class="s1"> --&gt; decorate </span><span class="si">{</span><span class="n">func</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">active</span><span class="p">:</span>  <span class="c1">#  True 注册</span>
            <span class="n">registry</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># False 注销</span>
            <span class="n">registry</span><span class="o">.</span><span class="n">discard</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>

<span class="hll">        <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>  <span class="c1"># 包装一下才能接受关键词参数 &amp; 变成 func 属性</span>
</span><span class="hll">        <span class="k">def</span> <span class="nf">clocked</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># 包装被装饰的函数</span>
</span>            <span class="n">t0</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
            <span class="n">_result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">_args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  <span class="c1"># 接受同样的参数</span>
            <span class="n">t1</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="hll">            <span class="k">return</span> <span class="n">_result</span>  <span class="c1"># 返回：想要的结果</span>
</span>
<span class="hll">        <span class="k">return</span> <span class="n">clocked</span>  <span class="c1"># 返回：函数</span>
</span>
<span class="hll">    <span class="k">return</span> <span class="n">decorate</span>  <span class="c1"># 返回：装饰器</span>
</span>
<span class="hll"><span class="nd">@register</span><span class="p">(</span><span class="n">active</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>  <span class="c1"># f1 注销</span>
</span><span class="k">def</span> <span class="nf">f1</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="hll"><span class="nd">@register</span><span class="p">()</span>  <span class="c1"># 必须作为函数调用</span>
</span><span class="k">def</span> <span class="nf">f2</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="hll"><span class="n">f1</span> <span class="o">=</span> <span class="n">register</span><span class="p">()(</span><span class="n">f1</span><span class="p">)</span> <span class="c1"># f1 重新注册</span>
</span></pre></div>
</div>
</div>
</section>
<section id="id23">
<h5 id="id23">现有的有用的装饰器<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">functools.lru_cache(maxsize=128,</span> <span class="pre">typed=False)</span></code>  做备忘。【自动优化】。储存耗时的函数调用结果，避免重新计算。</div>
<div class="line">Least Recently Used  缓存不会无限增长，一段时间不用就会被扔掉。</div>
<div class="line">用字典存储结果，所以用  <code class="docutils literal notranslate"><span class="pre">lru_cache</span></code>  修饰的函数所有参数必须是可散列的</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">maxsize</span></code>  超过会被舍弃，建议 2的幂</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">typed</span></code>  是否根据类型把缓存的东西分开存放</p></li>
</ul>
<div class="admonition-n-f-n-f-n-1-f-n-2-f-6-f-2-5 admonition hint">
<p class="admonition-title">第 n 个 斐波那契数 f(n) = f(n-1)+f(n-2) 当算f(6)的时候 f(2)会算5遍。。。重复计算</p>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">functools</span>

<span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">fibonacci</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">functools.wraps</span></code> ，包装使得装饰后的函数或对象拥有被装饰函数的 <code class="docutils literal notranslate"><span class="pre">__doc__</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">__name__</span></code>  等，还能实现关键字传参。</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">functools.singledispatch</span></code>  可以吧整体方案拆分成多个模块。</div>
<div class="line">使用  <code class="docutils literal notranslate"><span class="pre">singledispatch</span></code>  装饰的普通函数会变成 <strong>泛函数</strong>。</div>
<div class="line">使用  <code class="docutils literal notranslate"><span class="pre">@func.register(type)</span></code>  来装饰，因为选用的函数名字没有关系，所以  <code class="docutils literal notranslate"><span class="pre">_</span></code>  是个不错的选择</div>
<div class="line">装饰器 叠放 支持不同类型</div>
<div class="line">注册的函数不一定与原来的函数放在一块，可以在不同的模块去做，也可以为不是自己写的或者不能修改那里去加。</div>
</div>
<div class="admonition-numbers-integral-abc-mutablesequence-int-list admonition note">
<p class="admonition-title">使用抽象基类  <code class="docutils literal notranslate"><span class="pre">numbers.Integral</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">abc.MutableSequence</span></code>  而不是具体实现  <code class="docutils literal notranslate"><span class="pre">int</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">list</span></code></p>
<p>可以支持抽象基类以及未来的具体子类或虚拟子类，使得代码支持的兼容类型1更广泛。</p>
</div>
<div class="admonition-p admonition hint">
<p class="admonition-title">想要生成一个标签，常规的前后用 “p” 包围。如果是</p>
<div class="line-block">
<div class="line">数字：显示十进制 &amp; 16进制，前后用 “pre” 包围</div>
<div class="line">str：里面的换行符“n” 变成 “br”</div>
<div class="line">list：对每个元素都产生相应的标签</div>
</div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">singledispatch</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">abc</span>
<span class="kn">import</span> <span class="nn">numbers</span>

<span class="hll"><span class="nd">@singledispatch</span>
</span><span class="k">def</span> <span class="nf">tag</span><span class="p">(</span><span class="n">obj</span><span class="p">):</span>  <span class="c1"># obj 类基函数</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">'&lt;p&gt;</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s1">&lt;/p&gt;'</span>

<span class="hll"><span class="nd">@tag</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">)</span>  <span class="c1"># 是 int 的虚拟超类</span>
</span><span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">'&lt;pre&gt;</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1"> &amp; </span><span class="si">{</span><span class="nb">hex</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="si">}</span><span class="s1">&lt;/pre&gt;'</span>

<span class="hll"><span class="nd">@tag</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span>
</span><span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="n">string</span><span class="p">):</span>
    <span class="n">content</span><span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">,</span> <span class="s1">'&lt;</span><span class="se">\b</span><span class="s1">r&gt;'</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">'&lt;p&gt;</span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s1">&lt;p&gt;'</span>

<span class="hll"><span class="nd">@tag</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="nb">tuple</span><span class="p">)</span>  <span class="c1"># 叠放 支持不同类型</span>
</span><span class="hll"><span class="nd">@tag</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="n">abc</span><span class="o">.</span><span class="n">MutableSequence</span><span class="p">)</span>
</span><span class="k">def</span> <span class="nf">_</span><span class="p">(</span><span class="n">seq</span><span class="p">):</span>
    <span class="n">content</span> <span class="o">=</span> <span class="s1">'&lt;/li&gt;</span><span class="se">\n</span><span class="s1">&lt;li&gt;'</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tag</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">)</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">'&lt;ul&gt;</span><span class="se">\n</span><span class="s1">&lt;li&gt;</span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s1">&lt;/li&gt;</span><span class="se">\n</span><span class="s1">&lt;ul&gt;'</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tag</span><span class="p">([</span><span class="s1">'a/nb'</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span>
<span class="go">'&lt;ul&gt;\n&lt;li&gt;&lt;p&gt;a/nb&lt;p&gt;&lt;/li&gt;\n&lt;li&gt;&lt;pre&gt;2 &amp; 0x2&lt;/pre&gt;&lt;/li&gt;\n&lt;ul&gt;'</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id24">
<h3 id="id24">函数式编程<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">operator</span> <span class="pre">module</span></code></p>
<ul>
<li><dl class="simple">
<dt>为算术运算符提供对应函数</dt><dd><p><code class="docutils literal notranslate"><span class="pre">mul(a,b)</span></code>  🟰  <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">a,</span> <span class="pre">b:</span> <span class="pre">a*b</span></code></p>
</dd>
</dl>
</li>
<li><dl>
<dt>从序列中**取出元素** ｜ <strong>读取对象属性</strong></dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">itemgetter(n)</span></code>  🟰  <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">seq:</span> <span class="pre">seq[n]</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">attrgetter('a')</span></code>  🟰 <code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">obj:</span> <span class="pre">obj.a</span></code></div>
</div>
</dd>
</dl>
</li>
</ul>
<p>如果传入的是多个参数，返回来的就会是对应的元组</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">itemgetter</span><span class="p">,</span> <span class="n">attrgetter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">seq</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">'A'</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">(</span><span class="s1">'D'</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">'B'</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="s1">'C'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Obj</span><span class="p">():</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">return</span> <span class="sa">f</span><span class="s1">'&lt;Obj (</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="si">}</span><span class="s1">,</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="si">}</span><span class="s1">)&gt;'</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">objs</span> <span class="o">=</span> <span class="p">[</span><span class="n">Obj</span><span class="p">(</span><span class="o">*</span><span class="n">obj</span><span class="p">)</span> <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">seq</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="go">[('C', 1), ('D', 2), ('B', 2), ('A', 3)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="go">[('C', 1), ('B', 2), ('D', 2), ('A', 3)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s1">'b'</span><span class="p">))</span>
<span class="go">[&lt;Obj (C,1)&gt;, &lt;Obj (D,2)&gt;, &lt;Obj (B,2)&gt;, &lt;Obj (A,3)&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s1">'b'</span><span class="p">,</span><span class="s1">'a'</span><span class="p">))</span>
<span class="go">[&lt;Obj (C,1)&gt;, &lt;Obj (B,2)&gt;, &lt;Obj (D,2)&gt;, &lt;Obj (A,3)&gt;]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">functools</span> <span class="pre">module</span></code></p>
<ul>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">reduce（func,</span> <span class="pre">iterable,</span> <span class="pre">initializer)</span></code></dt><dd><dl>
<dt><code class="docutils literal notranslate"><span class="pre">initializer</span></code>  避免出现  <code class="docutils literal notranslate"><span class="pre">TyperError：empty</span> <span class="pre">sequence</span> <span class="pre">with</span> <span class="pre">no</span> <span class="pre">initial</span> <span class="pre">value</span></code> 。如果序列为空，则返回初始值。否则在归约中作为第一个参数使用，所以应该使用恒等值</dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">*</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">&amp;</span></code> : 1</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">+</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">^</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">|</span></code> : 0</div>
</div>
</dd>
</dl>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">partial</span></code> <strong>部分应用**一个**函数</strong>。基于一个函数创建一个新的可调用对象，把原函数的某些参数固定。</dt><dd><p>可以通过  <code class="docutils literal notranslate"><span class="pre">func.func</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">func.args</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">func.keywords</span></code>  来查询固定了的原函数和参数</p>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">partialmethod</span></code>  和  <code class="docutils literal notranslate"><span class="pre">partial</span></code>  类似，后者处理**方法**</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lru_cache</span></code>  做备忘。【自动优化】。储存耗时的函数调用结果，避免重新计算。</p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">mul</span>

<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">triple</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># 本来是 mul(a, b)，固定了 a=3</span>
</span><span class="gp">&gt;&gt;&gt; </span><span class="n">triple</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>  <span class="c1"># 一个新的调用对象，返回3倍的结果</span>
<span class="go">21</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">triple</span><span class="o">.</span><span class="n">func</span>
</span><span class="go">&lt;built-in function mul&gt;</span>
</pre></div>
</div>
</section>
</section>
<section id="class">
<h2 id="class">Class<a class="headerlink" href="#class" title="Link to this heading">¶</a></h2>
<div class="admonition- admonition danger">
<p class="admonition-title">方法和函數</p>
<table>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"></th>
<th class="head"><p>inplaced</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>方法</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">var.func()</span></code></p></td>
<td><p>内置, ✅</p></td>
</tr>
<tr class="row-odd"><td><p>函数</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">func(var)</span></code></p></td>
<td><p>❌</p></td>
</tr>
</tbody>
</table>
</div>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>按存值个数区分</p></th>
<th class="head"></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>只能存一个值</p></td>
<td><p>标量/原子类型</p></td>
<td><p>数字、字符串</p></td>
</tr>
<tr class="row-odd"><td><p>可以存放多个值</p></td>
<td><p>容器类型</p></td>
<td><p>列表、元组、字典</p></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>按照访问方式区分</p></th>
<th class="head"></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>直接访问</p></td>
<td><p>只能通过变量名访问整个值</p></td>
<td><p>数字</p></td>
</tr>
<tr class="row-odd"><td><p>顺序访问</p></td>
<td><p>可以用索引访问指定的值，索引I代表顺序，又称为序列类型</p></td>
<td><p>字符串、列表、元组</p></td>
</tr>
<tr class="row-even"><td><p>key访问</p></td>
<td><p>可以用key访问指定的值，又称为映射类型</p></td>
<td><p>字典</p></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>按可变不可变区分</p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>可变类型</p></td>
<td><p>列表、宇典</p></td>
</tr>
<tr class="row-odd"><td><p>不可变类型</p></td>
<td><p>数字、字符串、元组</p></td>
</tr>
</tbody>
</table>
<section id="none">
<h3 id="none">空  <code class="docutils literal notranslate"><span class="pre">None</span></code><a class="headerlink" href="#none" title="Link to this heading">¶</a></h3>
<div class="admonition- admonition danger">
<p class="admonition-title">数据为空不代表是空对象</p>
<table>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>包括</p></th>
<th class="head"><p>判别</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>空的对象</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">None</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">instance==None</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>数据为空</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[],</span> <span class="pre">'',</span> <span class="pre">{},</span> <span class="pre">()</span></code> , <code class="docutils literal notranslate"><span class="pre">None</span></code> , <code class="docutils literal notranslate"><span class="pre">0,</span> <span class="pre">False</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">not</span> <span class="pre">instance</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="id25">
<h3 id="id25">原子不可变对象<a class="headerlink" href="#id25" title="Link to this heading">¶</a></h3>
<p><span class="defi">可散列</span></p>
<section id="int-float">
<h4 id="int-float">数值  <code class="docutils literal notranslate"><span class="pre">int</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">float</span></code><a class="headerlink" href="#int-float" title="Link to this heading">¶</a></h4>
<p>转换</p>
<p>与  <code class="docutils literal notranslate"><span class="pre">char</span></code>  的转换</p>
<div class="admonition-float admonition danger">
<p class="admonition-title">万事先转  <code class="docutils literal notranslate"><span class="pre">float()</span></code></p>
<div class="line-block">
<div class="line">在不确定这个字符串是整形还是浮点数的情况下, 先转成 <code class="docutils literal notranslate"><span class="pre">float()</span></code> ，再转 <code class="docutils literal notranslate"><span class="pre">int()</span></code></div>
<div class="line">[ValueError: invalid literal for int() with base 10问题处理]</div>
</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">int(str)</span></code>  将**符合整数**的规定的字符串转换成 int</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">float(str)</span></code>  将**符合浮点型**的规定的字符串转换成 float</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str(num)</span></code>  将**整数、浮点型**转换成 char</p></li>
</ul>
<p>进制之间的转换</p>
<p>[Python 二进制，十进制，十六进制转换]</p>
<ul class="simple">
<li><p>➡️ 10： <code class="docutils literal notranslate"><span class="pre">int(str,</span> <span class="pre">origin_进制)</span></code></p></li>
<li><p>10 ➡️ 2:  <code class="docutils literal notranslate"><span class="pre">bin(int)</span></code></p></li>
<li><p>10 ➡️ 16:  <code class="docutils literal notranslate"><span class="pre">hex(x)</span></code></p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">""" 16 -&gt; 10 """</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">(</span><span class="s1">'B'</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="go">11</span>
</pre></div>
</div>
<p>&lt;u&gt;Base convention&lt;/u&gt;： <span class="defi">除基倒取余法</span></p>
<p><strong>以10进制转2进制为例</strong>：</p>
<p>输入一个十进制数n，每次用n除以2，把余数记下来，再用商去除以2…依次循环，直到商为0结束，把余数倒着依次排列，就构成了转换后的二进制数。</p>
<p>所有进制之间的转换都是如此，2可以换成任何数字。十进制转二进制、八进制、十六进制、64进制，</p>
<img alt="../_images/baseconvertion1.png" src="../_images/baseconvertion1.png"/>
<img alt="../_images/baseconvertion2.png" src="../_images/baseconvertion2.png"/>
<img alt="../_images/baseconvertion3.png" src="../_images/baseconvertion3.png"/>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">two_ten</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" 2 -&gt; 10 """</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">i</span><span class="p">:</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="o">-</span><span class="n">i</span><span class="p">])</span><span class="o">*</span><span class="mi">2</span><span class="o">**</span><span class="n">i</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">))))</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">ten_two</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" 10 -&gt; 2 """</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">a</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">ans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">%</span><span class="mi">2</span><span class="p">))</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">a</span> <span class="o">//</span> <span class="mi">2</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
    <span class="n">ans</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
    <span class="k">return</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">two_eight</span><span class="p">(</span><span class="n">a</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">""" 2 -&gt; 8 """</span>
    <span class="n">ans</span><span class="p">,</span> <span class="n">tmp</span> <span class="o">=</span> <span class="p">[],</span> <span class="mi">0</span>
    <span class="n">num</span><span class="p">,</span> <span class="n">more</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">//</span><span class="mi">3</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">%</span><span class="mi">3</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="n">a</span><span class="p">))</span>
    <span class="n">tmp</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="n">more</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">more</span><span class="p">):</span>
            <span class="n">tmp</span> <span class="o">+=</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">more</span><span class="o">-</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">ans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tmp</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num</span><span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="n">more</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">more</span><span class="o">+</span> <span class="mi">1</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="p">[</span><span class="n">more</span><span class="o">+</span><span class="mi">2</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="mi">1</span>
        <span class="n">ans</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">tmp</span><span class="p">))</span>
    <span class="k">return</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
</pre></div>
</div>
<p>格式要求</p>
</section>
</section>
<section id="id26">
<h3 id="id26">序列<a class="headerlink" href="#id26" title="Link to this heading">¶</a></h3>
<p>任何一种都满足 迭代、切片、排序、拼接</p>
<p>按&lt;u&gt;是否存放多种类型&lt;/u&gt; 🟰 &lt;u&gt;是否存放的是引用&lt;/u&gt;</p>
<ul class="simple">
<li><dl class="simple">
<dt>✅ <span class="defi">容器序列</span> 。存放的是它们所包含的 <strong>任意类型</strong> 的对象的 <strong>引用</strong></dt><dd><p>list, tuple, collections.deque</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>❌ <span class="defi">扁平序列</span> 。存放的是**值**, 一段连续的内存空间，更紧凑，只能存放字符、字节和数值这种 <strong>原子数据类型</strong>。每次只能存放一种类型。</dt><dd><p>str, bytes, bytearray, memoryview, array.array</p>
</dd>
</dl>
</li>
</ul>
<div class="admonition-set-dict admonition warning">
<p class="admonition-title">set &amp; dict 属于 容器 但是不属于序列。</p>
</div>
<p>按&lt;u&gt;能否迭代&lt;/u&gt;</p>
<ul class="simple">
<li><dl class="simple">
<dt>✅ <span class="defi">IterableObject 可迭代对象</span> 。如果我们可以从中获取迭代器。只要对象是可迭代的, 就可以执行 <strong>分解操作</strong></dt><dd><p>str, tuple, list, dict</p>
</dd>
</dl>
</li>
</ul>
<p>按&lt;u&gt;能否被修改&lt;/u&gt;</p>
<ul class="simple">
<li><dl class="simple">
<dt>✅ <span class="defi">Mutable Sequence</span></dt><dd><p>list, bytearray, array.array, collections.deque, memoryview</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>❌ <span class="defi">Sequence</span></dt><dd><p>tuple, str, bytes</p>
</dd>
</dl>
</li>
</ul>
<div class="admonition-mapset admonition hint">
<p class="admonition-title">一定要知道常用的容器底层都是如何实现的，最基本的就是map、set等等，否则自己写的代码，自己对其性能分析都分析不清楚</p>
</div>
<p>[collections — 容器数据类型]</p>
<div class="admonition- admonition note">
<p class="admonition-title">如何选序列。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list</span></code> : 方便又快捷，可修改，</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set</span></code> : 去掉重复元素, 不关心元素的顺序问题，经常检查是否包含</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tuple</span></code> : 不可变的列表</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">array.array</span></code>  只包含数字，尤其是浮点数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">deque</span></code>  频繁做两端增删。适合做“最近n个元素”</p></li>
</ul>
</div>
<div class="admonition-set-dict admonition danger">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">set</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>都是  <code class="docutils literal notranslate"><span class="pre">{}</span></code> , 但是 <code class="docutils literal notranslate"><span class="pre">a={}</span></code> 默认空字典，空集合是 <code class="docutils literal notranslate"><span class="pre">a=set()</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">set</span> <span class="pre">=</span> <span class="pre">{1,</span> <span class="pre">2,</span> <span class="pre">...}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict</span> <span class="pre">=</span> <span class="pre">{a:1,</span> <span class="pre">b:2,</span> <span class="pre">...}</span></code></p></li>
</ul>
</div>
<section id="id27">
<h4 id="id27">序列操作<a class="headerlink" href="#id27" title="Link to this heading">¶</a></h4>
<p>任何一种都满足 迭代、切片、排序、拼接</p>
<section id="listcomps-genexps">
<h5 id="listcomps-genexps">listcomps &amp; genexps<a class="headerlink" href="#listcomps-genexps" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line"><span class="defi">list comprehension, listcomps，列表推导</span>  。只用来生成列表。</div>
<div class="line">原则是：只用列表推导来创建新的列表，并且尽量保持简短， <strong>不要超过了两行</strong></div>
<div class="line">[python中，(x for y in z for x in y)这个结构怎么理解？]</div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">""" listcomps """</span>
<span class="go"># 1. 一层</span>
<span class="hll"><span class="go">[item for item in items]</span>
</span>
<span class="go"># 2. 二层， 可以将二维的列表展平</span>
<span class="hll"><span class="go">[item for items in items_list for item in items]</span>
</span><span class="go">for items in items_list:</span>
<span class="go">    for item in items:</span>
<span class="go">        list_.append(item)</span>

<span class="go"># 3. mix 两个</span>
<span class="hll"><span class="go">[(x,y) for x in list_x for y in list_y if x!=y]</span>
</span><span class="go">for x in list_x:  # 所以是先按 y 再按 x</span>
<span class="go">    for y in list_y:</span>
<span class="go">        if x != y:</span>
<span class="go">            yield (x,y)</span>
</pre></div>
</div>
<div class="admonition-with-listcomps admonition note">
<p class="admonition-title">笛卡尔积  with Listcomps</p>
<div class="line-block">
<div class="line"><span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Cartesian Product</mtext><mo separator="true">,</mo><mi>A</mi><mo>×</mo><mi>B</mi><mo>=</mo><mo stretchy="false">{</mo><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mi mathvariant="normal">∣</mi><mi>x</mi><mo>∈</mo><mi>A</mi><mo>∧</mo><mi>y</mi><mo>∈</mo><mi>B</mi><mo stretchy="false">}</mo><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mi mathvariant="normal">#</mi><mi>A</mi><mo>∗</mo><mi mathvariant="normal">#</mi><mi>B</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\text{Cartesian Product}, A×B=\{(x,y)|x∈A∧y∈B\}\in\R^{\#A*\#B}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord">Cartesian Product</span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{(</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mord">∣</span><span class="mord mathnormal">x</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∧</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7335em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="mclose">}</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8491em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">#</span><span class="mord mathnormal mtight">A</span><span class="mbin mtight">∗</span><span class="mord mtight">#</span><span class="mord mathnormal mtight" style="margin-right:0.05017em;">B</span></span></span></span></span></span></span></span></span></span></span></span></span></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">[(a,</span> <span class="pre">b)</span> <span class="pre">for</span> <span class="pre">a</span> <span class="pre">in</span> <span class="pre">A</span> <span class="pre">for</span> <span class="pre">b</span> <span class="pre">in</span> <span class="pre">B]</span></code></div>
<div class="line">内存里不会留下一个有组合的列表。因为在每次 for 循环的时候才会产生一个组合，所以内存变成是&lt;u&gt;一个组合的大小&lt;/u&gt;</div>
</div>
</div>
<div class="line-block">
<div class="line"><span class="defi">generator expression, genexps, 生成器表达式</span> 。具有生成各种类型的元素并用它们来填充 <strong>除列表外其他序列</strong> 的功能。</div>
<div class="line">genexps 遵守了&lt;u&gt;迭代器协议&lt;/u&gt;， <strong>可以逐个地产出元素（节省内存）</strong>，而不是先建立一个完整的列表，然后再把这个列表传递到某个构造函数里 <code class="docutils literal notranslate"><span class="pre">tuple(list(range(3)))</span></code></div>
<div class="line">如果 genexps 是一个函数调用过程中的唯一参数，那么不需要额外再用括号把它围起来。
| <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">tuple(ord(str_)</span> <span class="pre">for</span> <span class="pre">str_</span> <span class="pre">in</span> <span class="pre">'abc')</span></code>  1个括号
| <code class="docutils literal notranslate"><span class="pre">array.array('I',</span> <span class="pre">(ord(str_)</span> <span class="pre">for</span> <span class="pre">str_</span> <span class="pre">in</span> <span class="pre">'abc'))</span></code>  2个括号</div>
</div>
</section>
<section id="id28">
<h5 id="id28">拆包<a class="headerlink" href="#id28" title="Link to this heading">¶</a></h5>
<p><span class="defi">可迭代元素拆包</span> 。把 <strong>任何一个可迭代对象</strong> 拆开进行</p>
<ul class="simple">
<li><p><strong>赋值</strong></p></li>
<li><p>用  <code class="docutils literal notranslate"><span class="pre">*</span></code>  解析作为 <strong>函数参数</strong>。</p></li>
</ul>
<div class="line-block">
<div class="line">因为位置有意义时拆包显得格外有意义，所以一般指 Tuple 拆包。</div>
<div class="line"><strong>唯一的要求：</strong> 被可迭代对象中的元素数量必须是和接受这些元素的元组的空档数一致。</div>
<div class="line">允许 <strong>嵌套拆包</strong></div>
</div>
<div class="admonition- admonition warning">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">_</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">*</span></code></p>
<div class="line-block">
<div class="line">对待&lt;u&gt;少量不需要&lt;/u&gt;的元素： <code class="docutils literal notranslate"><span class="pre">_</span></code>  占位符。必须数量对应，和位置对应</div>
<div class="line">对待&lt;u&gt;不确定数量无谓需不需要&lt;/u&gt;的元素  <code class="docutils literal notranslate"><span class="pre">*</span></code> 。可以出现在前中后</div>
</div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">)</span>  <span class="c1"># 平行赋值</span>
</span><span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>  <span class="c1"># 不使用中间变量交换两个变量</span>
</span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">8</span><span class="p">)</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="nb">divmod</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># 用 * 解析作为函数参数</span>
</span><span class="go">(2, 4) # 20/8=2...4</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">filedir</span> <span class="o">=</span> <span class="s1">'/home/dir1/dir2/a.txt'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filedir</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span>
<span class="go">['', 'home', 'dir1', 'dir2', 'a.txt']</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">filedir</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span> <span class="c1"># 只要最后面的, 必须数量一样</span>
</span><span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">,</span> <span class="o">*</span><span class="n">dirs</span><span class="p">,</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">filedir</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">'/'</span><span class="p">)</span> <span class="c1"># 每个文件储存的文件夹数量是不一定的</span>
</span><span class="go"># 用占位符巧妙减少列表内存（第一个/前面的空格是不需要的）</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span>
<span class="go">a.txt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dirs</span>
<span class="go">['home', 'dir1', 'dir2']</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">area</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'Beijing'</span><span class="p">,</span> <span class="s1">'CN'</span><span class="p">,</span> <span class="p">(</span><span class="mi">111</span><span class="p">,</span><span class="mi">222</span><span class="p">))</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">city</span><span class="p">,</span> <span class="n">cc</span><span class="p">,</span> <span class="p">(</span><span class="n">latitude</span><span class="p">,</span> <span class="n">longitude</span><span class="p">)</span> <span class="o">=</span> <span class="n">area</span>  <span class="c1"># 嵌套拆包</span>
</span></pre></div>
</div>
</section>
<section id="id29">
<h5 id="id29">切片<a class="headerlink" href="#id29" title="Link to this heading">¶</a></h5>
<div class="admonition-seq-n-seq-n-1-n admonition note">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">seq[n]</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">seq[n-1:n]</span></code></p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">seq[n]</span></code>  获得是一个元素，元素什么类型，返回就什么类型；</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">seq[n-1:n]</span></code>  获得是一个长度为1的 seq 对象，seq 什么类型，返回就什么类型。”</div>
</div>
</div>
<ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">seq[a:b:c]</span></code>  对 s 在  <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>a</mi><mo separator="true">,</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[a, b)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">a</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></span>  之间以 c 为间隔取值。【1d】</dt><dd><p>其实是调用  <code class="docutils literal notranslate"><span class="pre">seq.__getitem__(slice(a,b,c))</span></code></p>
<ul class="simple">
<li><p><strong>c = 1</strong>. c&gt;0 从第一个开始正向; c&lt;0 从倒数第一个开始反向。&lt;u&gt;有可能完全不一样！&lt;/u&gt;</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">seq[m:n,</span> <span class="pre">k:l]</span></code>  对 <strong>多维</strong> s 取  <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[m, n)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal">m</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">n</span><span class="mclose">)</span></span></span></span></span>  行  <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mi>k</mi><mo separator="true">,</mo><mi>l</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[k, l)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose">)</span></span></span></span></span>  列 交叠的值。【&gt;2d】</dt><dd><p>其实是调用  <code class="docutils literal notranslate"><span class="pre">seq.__getitem__([(m,k)(m,k+1)...])</span></code></p>
<div class="admonition-seq-i-j-i-j-u-u admonition warning">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">seq[i,</span> <span class="pre">j]</span></code>  取 i 行 j 列的&lt;u&gt;一个值&lt;/u&gt;</p>
<p>其实是  <code class="docutils literal notranslate"><span class="pre">seq.__getitem__((i,j))</span></code></p>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>切片赋值</dt><dd><p>如果赋值的对象是一个切片，那么赋值的右边 <strong>必须</strong> 是一个&lt;u&gt;可迭代序列&lt;/u&gt;，哪怕只有单独一个值。</p>
</dd>
</dl>
</li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="s1">'abcd'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">[::</span><span class="mi">1</span><span class="p">]</span>
<span class="go">['a', 'b', 'c', 'd']</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">[::</span><span class="mi">2</span><span class="p">]</span>
</span><span class="go">['a', 'c']</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">[::</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="c1"># != s[::2]的相反</span>
</span><span class="go">['d', 'b']</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">TypeError: can only assign an iterable</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># 哪怕只有单独一个值。</span>
</span><span class="go">[1, 'd']</span>
</pre></div>
</div>
</section>
<section id="id30">
<h5 id="id30">拼接<a class="headerlink" href="#id30" title="Link to this heading">¶</a></h5>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">+</span></code>  不修改原有的操作形象，而是构建一个全新的序列</p></li>
</ul>
<section id="id31">
<h6 id="id31">复制后拼接<a class="headerlink" href="#id31" title="Link to this heading">¶</a></h6>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">seq</span> <span class="pre">*</span> <span class="pre">n</span></code>  不修改原有的操作形象，而是构建一个全新的序列。 <code class="docutils literal notranslate"><span class="pre">seq[item]</span></code> ➡️  <code class="docutils literal notranslate"><span class="pre">seq[item1,</span> <span class="pre">item1,</span> <span class="pre">...]</span></code></p>
<blockquote>
<div><div class="admonition-seq-defi admonition danger">
<p class="admonition-title">seq 里的元素是引用，复制的将会是引用，<span class="defi">一改全改</span></p>
<p>seq 里的元素是值，复制的将会是值 <span class="defi">具有独立</span></p>
</div>
</div></blockquote>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">seqA(seqB</span> <span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">range(n))</span></code>  对嵌套序列的序列，嵌套内的序列是存放不同内容的东西。</dt><dd><div class="line-block">
<div class="line">🟰 <code class="docutils literal notranslate"><span class="pre">seA[seqB]</span></code> ➡️  <code class="docutils literal notranslate"><span class="pre">seqA[seqB1,</span> <span class="pre">seqB2,</span> <span class="pre">...]</span></code>  里面相互独立。</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">seqA(seqB)</span> <span class="pre">*n</span></code>  🟰  <code class="docutils literal notranslate"><span class="pre">seA[seqB]</span></code> ➡️  <code class="docutils literal notranslate"><span class="pre">seqA[seqB,</span> <span class="pre">seqB,</span> <span class="pre">...]</span></code> （第一个方法，里面一改全改。）</div>
</div>
</dd>
</dl>
</li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">3</span>  <span class="c1"># [0] 是 seq， 0 是元素 = 值</span>
</span><span class="go">a = [0, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
<span class="go">a = [1, 0, 0]</span>

<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span>  <span class="c1"># [0] 是 seq，0 是元素 = 值</span>
</span><span class="go">b = [[0, 0, 0]]  # 在 b 内层复制, b 只有1个元素 []</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
<span class="go">b = [1]</span>

<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">*</span> <span class="mi">3</span>  <span class="c1"># [[0]] 是 seq， [0] 是元素 = 引用</span>
</span><span class="go">c = [[0], [0], [0]] # 在 c 复制，c 有3个元素 []</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">c = [1, [0], [0]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span>
<span class="go">c = [1, [2], [2]]</span>

<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
</span><span class="go">d = [[0], [0], [0]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="go">d = [1, [0], [0]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">2</span>
<span class="go">d = [1, [2], [0]]</span>

<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">e</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'-'</span><span class="o">*</span><span class="mi">3</span><span class="p">]</span>
</span><span class="go">e = ['---']</span>
</pre></div>
</div>
<div class="mermaid">
            flowchart LR
subgraph 栈区
c --一直没变--&gt; c_address
end
subgraph 堆区
0_address
0
1
2
B[【0_address】]
C[【0_address,0_address,0_address】]
D[【1,0_address,0_address】]
end
c_address -.- B -.-&gt; 0_address -.- 0
c_address -.- C -.-&gt; 0_address
B --1)复制--&gt; C
c_address -.- D
C --2)c0=1--&gt; D
D -.-&gt; 0_address
D -.- 1
0_address -.- 2
0 --3)c10=2--&gt;2
        </div><p>只有前两步改的是  <code class="docutils literal notranslate"><span class="pre">c</span></code>  存的的东西，最后一步其实 <code class="docutils literal notranslate"><span class="pre">c</span></code>  存的的东西没变， <code class="docutils literal notranslate"><span class="pre">c</span></code>  存的的东西存的东西变了</p>
</section>
<section id="id32">
<h6 id="id32">就地加乘<a class="headerlink" href="#id32" title="Link to this heading">¶</a></h6>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">+=</span></code> ,  <code class="docutils literal notranslate"><span class="pre">*=</span></code> ,  <code class="docutils literal notranslate"><span class="pre">__iadd__</span></code> ,  <code class="docutils literal notranslate"><span class="pre">__imul__</span></code></div>
<div class="line"><strong>重要</strong>：对 <span class="defi">Seq</span> &amp; <span class="defi">MutableSeq</span> 内存地址的变化</div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go"># Seq 变了</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</span><span class="go">t=(1,2), id(t)=4313022720</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="go">t=(1,2,1,2), id(t)=4311067808</span>
<span class="go"># MutableSeq 不变</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span><span class="go">l=[1,2], id(l)=4311024448</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">*=</span> <span class="mi">2</span>
<span class="go">l=[1,2,1,2], id(l)=4311024448</span>
</pre></div>
</div>
<div class="admonition- admonition warning">
<p class="admonition-title">关于就地加乘一个还没解决的问题</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,[</span><span class="mi">30</span><span class="p">,</span><span class="mi">40</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+=</span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="mi">60</span><span class="p">]</span>
<span class="go">TypeError: 'tuple' object does not support item assignment</span>
<span class="go">t=(1, 2, [30, 40, 50, 60])</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="id33">
<h5 id="id33">排序<a class="headerlink" href="#id33" title="Link to this heading">¶</a></h5>
<div class="admonition-timsort admonition note">
<p class="admonition-title">稳定的 <code class="docutils literal notranslate"><span class="pre">Timsort</span></code></p>
<div class="line-block">
<div class="line">两个元素同样大小的情况下，在排序的时候位置是相互固定的。如果在比较长的时候，两个元素一样长，那么结果的先后会以原本本身列表的先后决定，这样相对稳定。</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">lst.sort()</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">sorted(iterableObject)</span></code>  背后用的都是 Timsort。</div>
<div class="line"><span class="defi">Timsort</span> 。一种自适应算法，根据原始数据的顺序特点交替使用插入排序 &amp; 归并排序。=，以达到最佳效率。</div>
</div>
</div>
<p><strong>不需要维护排序：</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lst.sort()</span></code>  就地排序列表，返回 None。</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">sorted(iterableObject)</span></code>  返回新建的列表。</dt><dd><ul>
<li><p>接受任何形式可迭代的对象为参数，包括不可变序列或生成器。</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>📗 都有两个可选的关键词参数</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reverse=False</span></code>  默认升序</p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">key=IdentityFunction</span></code>  一个只有一个参数的函数。这个函数会被用在序列上的每一个元素上，产生元素相对应的用于排序的对比关键词。默认恒等函数，以元素自己的值来排序。</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">=len</span></code>  对比长度</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">=str.lower</span></code>  忽略大小写的的排序</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">=reverse</span></code>  从左到右进行比较</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Aa'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'Cc'</span><span class="p">]</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">lst</span><span class="p">)</span>
</span><span class="go">['Aa', 'Cc', 'b']  # 按 首字母 ord</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>  <span class="c1"># 按 不分大小写 ord</span>
</span><span class="go">['Aa', 'b', 'Cc']</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="nb">sorted</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="nb">len</span><span class="p">)</span>
</span><span class="go">['b', 'Aa', 'Cc']</span>
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="id60">
<div class="code-block-caption"><span class="caption-text">不支持原生比较的对象</span><a class="headerlink" href="#id60" title="Link to this code">¶</a></div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">User</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">age</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">id</span> <span class="o">=</span> <span class="nb">id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">age</span> <span class="o">=</span> <span class="n">age</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">'User(id:</span><span class="si">{}</span><span class="s1">, age:</span><span class="si">{}</span><span class="s1">)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">age</span><span class="p">)</span>

<span class="n">users</span> <span class="o">=</span> <span class="p">[</span><span class="n">User</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">User</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">User</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">--- uncomparable class ---"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">users</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"</span><span class="se">\t</span><span class="s2">"</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">users</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="n">d</span><span class="o">.</span><span class="n">id</span><span class="p">),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"</span><span class="se">\t</span><span class="s2">"</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">users</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">d</span><span class="p">:</span> <span class="p">(</span><span class="n">d</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="n">d</span><span class="o">.</span><span class="n">age</span><span class="p">)))</span>


<span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="n">attrgetter</span> <span class="c1"># another</span>
<span class="nb">print</span><span class="p">(</span><span class="n">users</span><span class="p">,</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"</span><span class="se">\t</span><span class="s2">"</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">users</span><span class="p">,</span>  <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s1">'id'</span><span class="p">)),</span> <span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span>
    <span class="s2">"</span><span class="se">\t</span><span class="s2">"</span><span class="p">,</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">users</span><span class="p">,</span>  <span class="n">key</span><span class="o">=</span><span class="n">attrgetter</span><span class="p">(</span><span class="s1">'id'</span><span class="p">,</span> <span class="s1">'age'</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<p><strong>需要维护排序：</strong></p>
<div class="admonition- admonition note">
<p class="admonition-title">已经排好了序，如何查找&amp;维护</p>
<p>排序很耗时，得到有序序列后最好保持它一直有序。</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">bisect</span> <span class="pre">module</span></code>  底下的  <code class="docutils literal notranslate"><span class="pre">bisect</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">insort</span></code>  都是用&lt;u&gt;二分查找&lt;/u&gt;在有序序列上 查找并插入元素。</p>
<p>📗 有 <code class="docutils literal notranslate"><span class="pre">lo</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">hi</span></code> ,来缩小搜寻范围。</p>
<ul>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">bisect.bisect(sortedlst,</span> <span class="pre">target)</span></code>  查找索引，相同时，在同一个的右边。</dt><dd><div class="line-block">
<div class="line">可搭配上  <code class="docutils literal notranslate"><span class="pre">sortedlst.insert(idx,</span> <span class="pre">target)</span></code> 配合使用</div>
<div class="line">有  <code class="docutils literal notranslate"><span class="pre">bisect.bisect_left</span></code>  相同时，在同一个的左边。</div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">bisect.insort(sortedlst,</span> <span class="pre">target)</span></code>  查找并插入。就地改变。一步到位，速度更快。</dt><dd><p>同样有  <code class="docutils literal notranslate"><span class="pre">bisect.insort_left</span></code></p>
</dd>
</dl>
</li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">bisect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bisect</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bisect</span><span class="o">.</span><span class="n">insort</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">[2, 3, 4, 6]</span>

<span class="go"># 用途</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">grade</span><span class="p">(</span><span class="n">score</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">breakpoints</span><span class="o">=</span><span class="p">[</span><span class="mi">60</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">90</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">grades</span> <span class="o">=</span> <span class="s1">'FDCBA'</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">i</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="n">breakpoints</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">grades</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">grade</span><span class="p">(</span><span class="n">score</span><span class="p">)</span> <span class="k">for</span> <span class="n">score</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">33</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">60</span><span class="p">]]</span>
<span class="go">['F', 'A', 'C', 'D']</span>
</pre></div>
</div>
</section>
</section>
<section id="list">
<h4 id="list">list<a class="headerlink" href="#list" title="Link to this heading">¶</a></h4>
<p><span class="defi">容器</span> + <span class="defi">MutableSequence</span></p>
<ul>
<li><dl>
<dt>init。</dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">list(range(start,</span> <span class="pre">end,</span> <span class="pre">step))</span></code></div>
<div class="line">将 <code class="docutils literal notranslate"><span class="pre">range()</span></code> 作为 <code class="docutils literal notranslate"><span class="pre">list()</span></code> 的参数，输出将为一个数字列表</div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>增加</dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">lst.append(x)</span></code>  末尾</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lst.insert(idx,</span> <span class="pre">x)</span></code>  any position</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt>删除</dt><dd><table>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>根据____来删除</p></th>
<th class="head"><p>return</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">lst[idx]</span></code></p></td>
<td><p>idx</p></td>
<td><p>❌ no-return</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">lst.pop(idx)</span></code></p></td>
<td><p>idx</p></td>
<td><p>✅ <strong>lst[idx]</strong>，不指定索引默认删除最后一个</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">lst.remove(x)</span></code></p></td>
<td><p>value, 只删除 <strong>第一个</strong> 指定的值</p></td>
<td><p>✅  <strong>x</strong></p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>查 search</dt><dd><p><code class="docutils literal notranslate"><span class="pre">lst.index(val)</span></code>  返回第一个找到的idx。找不到就会  <code class="docutils literal notranslate"><span class="pre">ValueError</span></code></p>
</dd>
</dl>
</li>
</ul>
<div class="admonition-lst-1r-lst-1 admonition warning">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">lst_1r</span> <span class="pre">=</span> <span class="pre">lst_1[:]</span></code>   切片等于浅拷贝</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="s1">'a:a:a:b'</span>
<span class="go">&gt;&gt; b = a[:]</span>
<span class="go">id(a)=id(b)=4382924912</span>
</pre></div>
</div>
</div>
<p>拼接</p>
<table>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>cases</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">+</span> <span class="pre">append</span></code></p></td>
<td><p>修改元素</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">list_c</span> <span class="pre">=</span> <span class="pre">list_a</span> <span class="pre">+</span> <span class="pre">list_b</span></code></p></td>
<td><p>效率好, 不适合做大数据处理</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">list_c</span> <span class="pre">=</span> <span class="pre">[*list_a,</span> <span class="pre">*list_b]</span></code> <strong>通过 ‘*’ 解构</strong></p></td>
<td><p>效率好, 不适合做大数据处理</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">list_a.extend(list_b)</span></code>  内置的meth: extend</p></td>
<td><p>需要修改原始列表比较合适</p></td>
</tr>
</tbody>
</table>
<p>[Python3 - 6种方法拼接合并列表list]</p>
</section>
<section id="tuple">
<h4 id="tuple">tuple<a class="headerlink" href="#tuple" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line"><span class="defi">容器</span> + <span class="defi">Sequence</span></div>
<div class="line"><span class="defi">不可变的列表</span> (除了增删改，支持 list 其他所有操作)</div>
<div class="line"><span class="defi">没有字段名的记录</span> (item 是携带位置信息，所以一般不搞排序)</div>
</div>
<p>虽好但是没有字段名 ➡️  <code class="docutils literal notranslate"><span class="pre">namedtuple</span></code></p>
<ul>
<li><dl>
<dt>init</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>【单条记录】 <code class="docutils literal notranslate"><span class="pre">tuple(val1,</span> <span class="pre">val2,</span> <span class="pre">...)</span></code> ,  <code class="docutils literal notranslate"><span class="pre">tuple(list1)</span></code></dt><dd><p>返回： <code class="docutils literal notranslate"><span class="pre">Tuple</span></code></p>
</dd>
</dl>
</li>
<li><p>【多列合并】  <code class="docutils literal notranslate"><span class="pre">list(zip(col1,</span> <span class="pre">col2,</span> <span class="pre">...))</span></code></p></li>
</ul>
<div class="admonition-zip admonition warning">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">zip</span></code></p>
<p>zip 返回来的是  <code class="docutils literal notranslate"><span class="pre">&lt;zip</span> <span class="pre">object</span> <span class="pre">at</span> <span class="pre">0x103abc288&gt;</span></code> : 元组组成的对象。需要叠层 list。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="s1">'c'</span><span class="p">]</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="nb">zip</span><span class="p">(</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">)</span>
</span><span class="go">&lt;zip object at 0x103abc288&gt;</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">))</span>
</span><span class="go">[(1, 'a'), (2, 'b'), (3, 'c')]</span>
</pre></div>
</div>
</div>
</dd>
</dl>
</li>
<li><p>因为不可变可用作 <code class="docutils literal notranslate"><span class="pre">dict</span></code> 的key</p>
<blockquote>
<div><div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">d</span><span class="p">[(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">)])</span>
<span class="go">5</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="namedtuple">
<h4 id="namedtuple">namedtuple<a class="headerlink" href="#namedtuple" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">collections.namedtuple</span></code> . 可以用来构建一个带字段名的元组和一个有名字的类</div>
<div class="line"><span class="defi">容器</span> + <span class="defi">Sequence</span></div>
<div class="line"><span class="defi">不可变的列表</span> + <span class="defi">有字段名的记录</span></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">namedtuple</span></code>  构建的类的实例所&lt;u&gt;消耗的内存跟元组是一样的&lt;/u&gt;，因为字段名都被存在对应的类里面。小号的内存比普通的实例对象要小一点，因为 python 不会用  <code class="docutils literal notranslate"><span class="pre">__dict__</span></code>  存放实例的属性。
<code class="docutils literal notranslate"><span class="pre">p</span></code> 的字段名都被存在对应的类 <code class="docutils literal notranslate"><span class="pre">Point</span></code> 里面</div>
</div>
<ul>
<li><dl>
<dt>init</dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">Records</span> <span class="pre">=</span> <span class="pre">namedtuple(typename:str,</span> <span class="pre">field_names:Optional(Iterable,</span> <span class="pre">String))</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">rec1</span> <span class="pre">=</span> <span class="pre">Records(*rec1_data)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">rec2</span> <span class="pre">=</span> <span class="pre">Records._make(*rec2_data)</span></code></div>
</div>
</dd>
</dl>
</li>
</ul>
<dl class="simple">
<dt>📕 Args:</dt><dd><ul class="simple">
<li><p>typename: 类表名的感觉</p></li>
<li><p>field_names: 由数个字符串组成的可迭代对象，或者是由**空格分隔开**的字段名组成的字符串</p></li>
</ul>
</dd>
</dl>
<ul class="simple">
<li><dl class="simple">
<dt>📗 属性</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">Records._fields</span></code>  包含字段名的元组</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rec1._asdict()</span></code> 把 namedtuple 以  <code class="docutils literal notranslate"><span class="pre">collections.OrderedDict</span></code>  形式返回。友好呈现信息</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rec1._replace(field_name=v)</span></code>  修改值。</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">namedtuple</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">Point</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="s1">'Point'</span><span class="p">,</span> <span class="p">[</span><span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">])</span>
</span><span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">22</span><span class="p">)</span>  <span class="c1"># 根据位置和kw实例化</span>
</span><span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">p</span><span class="o">.</span><span class="n">x</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">y</span>  <span class="c1"># by idx | name</span>
<span class="go">True  # = 33</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">_asdict</span><span class="p">()</span>  <span class="c1"># namedtuple ➡️ dict</span>
</span><span class="go">d = {'x': 11, 'y': 22}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Point</span><span class="p">(</span><span class="o">**</span><span class="n">d</span><span class="p">)</span>      <span class="c1"># dict ➡️ namedtuple</span>
<span class="go">Point(x=11, y=22)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">p</span><span class="o">.</span><span class="n">_replace</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="go">Point(x=100, y=22)</span>
</pre></div>
</div>
</section>
<section id="array">
<h4 id="array">array 数组<a class="headerlink" href="#array" title="Link to this heading">¶</a></h4>
<div class="admonition-array-list admonition note">
<p class="admonition-title">需要纯数字的列表是，array 比 list 更高效</p>
<div class="line-block">
<div class="line">在存数字时，array 背后存的不是 float 或者 int 对象，而是数字的机器翻译 <span class="defi">字节表述</span> 。</div>
<div class="line">指定数据类型，当序列很大的时候，可以节省很多时间。</div>
<div class="line">还提供从文件读取和存入文件更快的方法。</div>
</div>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>init</dt><dd><p>需要 <strong>类型码</strong>，表示底层 C 语言需要存放的数据类型
-  <code class="docutils literal notranslate"><span class="pre">b</span></code>  signed char 有符号的字符，只能存放一个字节的整数。 <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>7</mn></msup><mo>=</mo><mo stretchy="false">[</mo><mo>−</mo><mn>128</mn><mo separator="true">,</mo><mn>127</mn><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">2^7=[-128, 127]</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">7</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">128</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">127</span><span class="mclose">]</span></span></span></span></span>
-  <code class="docutils literal notranslate"><span class="pre">d</span></code>  双精度浮点数组</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>快速读写文件</dt><dd><p><code class="docutils literal notranslate"><span class="pre">array.fromfile(fp)</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">array.tofile(fp)</span></code> 。读写二进制文件时间比对文本文件读写要快，因为不需要转换字符和数字形式；还节省空间。</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>排序</dt><dd><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">=</span> <span class="pre">array.array(a.typecode,</span> <span class="pre">sorted(a))</span></code></p>
</dd>
</dl>
</li>
</ul>
<div class="line-block">
<div class="line">不支持就地排序方法。</div>
<div class="line">但是不支持 浅复制  <code class="docutils literal notranslate"><span class="pre">s.copy()</span></code>  操作，</div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">array</span> <span class="kn">import</span> <span class="n">array</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">random</span>

<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">floats</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="s1">'d'</span><span class="p">,</span> <span class="p">(</span><span class="n">random</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>
</span><span class="go">floats=array('d', [0.7997733053807442, 0.15195105711939816, 0.013224926567956818])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'floats.bin'</span><span class="p">,</span> <span class="s1">'wb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span>    <span class="n">floats</span><span class="o">.</span><span class="n">tofile</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span><span class="gp">&gt;&gt;&gt; </span><span class="n">floats2</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="s1">'d'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'floats.bin'</span><span class="p">,</span> <span class="s1">'rb'</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span>    <span class="n">floats2</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="n">fp</span><span class="p">)</span>
</span></pre></div>
</div>
</section>
<section id="memoryview">
<h4 id="memoryview">memoryview 内存视图<a class="headerlink" href="#memoryview" title="Link to this heading">¶</a></h4>
<p>能在不复制内容的时候，操作同一个数组不同切片。</p>
</section>
<section id="deque">
<h4 id="deque">deque 双向队列<a class="headerlink" href="#deque" title="Link to this heading">¶</a></h4>
<div class="admonition-append-pop-0-list-queue admonition note">
<p class="admonition-title">利用  <code class="docutils literal notranslate"><span class="pre">.append()</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">.pop(0)</span></code>  可以把 list 当作 queue 使用。但是删除第一个或者增加到列表开始是很耗时，因为要移动其他元素。</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">collections.deque</span></code>  double-end queue 线程安全，可以快速向两端添加或者删除元素。</p>
<ul class="simple">
<li><p>但是只在两端做了优化，从中间增删还是慢的。</p></li>
<li><p>append &amp; popleft 都是原子操作，deque 可以在多线程程序中安全地作为先进先出的队列使用，而不需要考虑资源锁的问题。</p></li>
</ul>
<div class="admonition- admonition hint">
<p class="admonition-title">原子操作</p>
<p>适合做类似“最近用到的几个元素”。因为在初始化的时候，指定队列的大小(一旦设定之后不能改)。如果满员的话，可以从 <strong>反向端</strong> 删除过期的元素，在尾端添加新元素。</p>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>init</dt><dd><p><code class="docutils literal notranslate"><span class="pre">q</span> <span class="pre">=</span> <span class="pre">deque([iterable[,</span> <span class="pre">maxlen=None])</span></code></p>
</dd>
</dl>
</li>
</ul>
<dl>
<dt>📕</dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">[iterable]</span></code>  没有指定，新队列为空</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">maxlen=None</span></code>  ，deques 可以增长到任意长度。一旦设定之后不能改。</div>
</div>
</dd>
</dl>
<ul>
<li><dl class="simple">
<dt>旋转</dt><dd><p><code class="docutils literal notranslate"><span class="pre">deque.rotate(n)</span></code>  当 n&gt;0, 最右边的 n 个元素会被旋转到最左边；当 n&lt;0, 最左边的 n 个元素会被旋转到最右边。</p>
</dd>
</dl>
</li>
<li><dl>
<dt>增加 <strong>O(1)</strong></dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">deque.append(item)</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">deque.appendleft(item)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">deque.extend(iterable)</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">deque.extendleft(iterable)</span></code></div>
<div class="line">如果满员的话，可以从**反向端**删除过期的元素，在尾端添加新元素。</div>
</div>
<div class="admonition-deque-extendleft-lst admonition warning">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">deque.extendleft(lst)</span></code>  将迭代器的元素逐个增加到队列上，最后呈现出来的是逆序。</p>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>删除 <strong>O(1)</strong></dt><dd><p><code class="docutils literal notranslate"><span class="pre">deque.pop()</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">deque.popleft()</span></code></p>
</dd>
</dl>
</li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">dq</span> <span class="o">=</span> <span class="n">deque</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">maxlen</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span class="go">dq=deque([1, 2, 3], maxlen=5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dq</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
<span class="go">dq=deque([3, 4, 5, 6, 7], maxlen=5)</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">dq</span><span class="o">.</span><span class="n">extendleft</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</span><span class="go">dq=deque([2, 1, 3, 4, 5], maxlen=5)</span>
</pre></div>
</div>
</section>
<section id="bytes">
<h4 id="bytes">bytes 字节<a class="headerlink" href="#bytes" title="Link to this heading">¶</a></h4>
<p><span class="defi">二进制序列</span> 其实是整数序列：各个元素是介于 0 ～ 255= <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mn>2</mn><mn>8</mn></msup><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">2^8-1</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.8974em;vertical-align:-0.0833em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">8</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></span>  之间的整数。</p>
<div class="line-block">
<div class="line"><strong>为什么返回来的结果不一样？</strong></div>
<div class="line">虽然二进制序列是整数序列，但他们的字面量表示法表明其中有 ASCII 文本。所以各个字节的值可能会使用下列三种不同的文本表示：</div>
</div>
<ul class="simple">
<li><p>可打印的 ASCII 范围内的字节 ➡️  ASCII 字符本身</p></li>
<li><p>制表符、换行符、回车符、对应的字节 ➡️ 转义序列</p></li>
<li><p>其他字节的值 ➡️ 16进制转义序列</p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="s1">'A</span><span class="se">\t</span><span class="s1">啊'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf8'</span><span class="p">)</span>
<span class="go">b=b'A\t\xe5\x95\x8a'</span>
<span class="hll"><span class="go">b[0]=65    b[1]=9       b[2]=229 其实是整数</span>
</span><span class="hll"><span class="go">b[:1]=b'A' b[1:2]=b'\t' b[2:3]= b'\xe5'</span>
</span></pre></div>
</div>
</section>
<section id="str">
<h4 id="str"><code class="docutils literal notranslate"><span class="pre">str</span></code><a class="headerlink" href="#str" title="Link to this heading">¶</a></h4>
<p><span class="defi">Sequence</span></p>
<div class="admonition-s-i-n-math-impliedby-str admonition danger">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">s[i]</span> <span class="pre">=</span> <span class="pre">'n'</span></code>  切片赋值 ❌  <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>  </mtext><mo>⟸</mo><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\impliedby</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟸</span><span class="mspace" style="margin-right:0.2778em;"></span></span></span></span></span>  str 不可变</p>
</div>
<div class="line-block">
<div class="line"><strong>字符编码问题：</strong></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">t</span></code>  文本</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">b</span></code>  二进制/bytes,非文本只能 byte 模式</div>
</div>
<div class="admonition-kbd-unicode-kbd-u-u admonition note">
<p class="admonition-title">内存固定使用 &lt;kbd&gt;unicode&lt;/kbd&gt;, 我们改变的是从&lt;u&gt;内存存入硬盘的格式&lt;/u&gt;</p>
<p>linux 默认 utf-8， windows 默认 gbk</p>
</div>
<div class="admonition- admonition note">
<p class="admonition-title">存储数据 - 大小写</p>
<p>存储数据时，方法 <code class="docutils literal notranslate"><span class="pre">lower()</span></code> 很有用。很多时候，你无法依靠用户来提供正确的大小写，因此需要将字符串先转换为小写，再存储它们。以后需要显示这些信息时，再将其转换为最合适的大小写方式。</p>
</div>
<div class="admonition- admonition danger">
<p class="admonition-title">空白泛指任何非打印字符，如空格、制表符和换行符</p>
</div>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>cases</p></th>
<th class="head"><p>code</p></th>
<th class="head"><p>return=non-inplaced</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="5"><p>大小写</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str.upper()</span></code></p></td>
<td rowspan="4"><p>✅ 结果</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">str.lower()</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str.capitalize()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">str.title()</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str.swapcase()</span></code></p></td>
<td><p>✅ 结果 大小写互换</p></td>
</tr>
<tr class="row-odd"><td rowspan="3"><p>去除前后字符串</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str.lstrip(sub_str)</span></code></p></td>
<td rowspan="3"><p>✅ 结果 默认是空白</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str.rstrip(sub_str)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">str.strip(sub_str)</span></code></p></td>
</tr>
<tr class="row-even"><td rowspan="8"><p>字符串是否只由dd组成</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str_.isalpha()</span></code></p></td>
<td><p>✅ bool</p></td>
</tr>
<tr class="row-odd"><td><p>只由字母, <span class="defi">中文也是</span></p></td>
<td rowspan="7"><p>✅ bool</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str_.isdigit()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">str.isnumeric()</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str.isdecimal()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>只由数字</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str_.isspace()</span></code> , 只由空格</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">in</span> <span class="pre">string.punctuation</span></code>  标点</p></td>
</tr>
<tr class="row-even"><td rowspan="5"><p>查找</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">long_str.find(sub_str)</span></code>       ➡️</p></td>
<td rowspan="2"><p>第一次出现的位置 or <span class="defi">-1</span> ✅</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">long_str.rfind(sub_str)</span></code> ⬅️</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">long_str.index(sub_str)</span></code> ➡️</p></td>
<td rowspan="2"><p>第一次出现的位置 or <span class="defi">ValueError</span> ✅</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">long_str.rindex(sub_str)</span></code> ⬅️</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str.count(sub,</span> <span class="pre">start=</span> <span class="pre">0,</span> <span class="pre">end=len(str))</span></code></p></td>
<td><p>✅  sub 在 str中出现的次数</p></td>
</tr>
<tr class="row-odd"><td><p>执行</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">eval(string)</span></code> 执行一个字符串表达式</p></td>
<td><p>✅ 表达式的值</p></td>
</tr>
<tr class="row-even"><td rowspan="4"><p>填充</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">str.ljust(int,</span> <span class="pre">pad_str)</span></code></p></td>
<td rowspan="3"><p>✅ 结果  <code class="docutils literal notranslate"><span class="pre">pad_str='</span> <span class="pre">'</span></code> 默认是空格</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">str.rjust(int,</span> <span class="pre">pad_str)</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str.center(int,</span> <span class="pre">pad_str)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">str.zfill(int)</span></code></p></td>
<td><p>✅ 结果 用0在前面的填充</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>修改</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">s[:l]</span> <span class="pre">+</span> <span class="pre">s[l:][::-1]</span></code>  重新赋值</p></td>
<td><p>✅ 结果</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">string.replace(old,</span> <span class="pre">new)</span></code> 所有都换一遍</p></td>
<td><p>✅ 结果</p></td>
</tr>
<tr class="row-even"><td><p>连接字符串</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">s3</span> <span class="pre">=</span> <span class="pre">s1</span> <span class="pre">+</span> <span class="pre">s2</span></code> <span class="defi">不推荐</span></p></td>
<td><p>✅ 结果</p></td>
</tr>
</tbody>
</table>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="s1">'string'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">'   string'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="go">'  string '</span>
</pre></div>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>识别数字</dt><dd><p>数字分：</p>
</dd>
</dl>
</li>
</ul>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">num1</span><span class="p">,</span> <span class="n">num2</span><span class="p">,</span> <span class="n">num3</span><span class="p">,</span> <span class="n">num4</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">'4'</span><span class="p">,</span> <span class="sa">u</span><span class="s1">'4'</span><span class="p">,</span> <span class="s1">'四'</span><span class="err">，</span> <span class="s1">'IV'</span>
</pre></div>
</div>
<table>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>bytes(二进制储存)</p></th>
<th class="head"><p>unicode(就是普通的数字)</p></th>
<th class="head"><p>中文数字</p></th>
<th class="head"><p>罗马数字</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">num=</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b'4'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">u'4'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'四'</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">'IV'</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">num=</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">b'4'</span></code></p></td>
<td><p>python3前面不带 <code class="docutils literal notranslate"><span class="pre">u</span></code> 就是</p></td>
<td><p>^</p></td>
<td><p>^</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str.isdigit()</span></code></p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">str.isnumeric()</span></code></p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">str.isdecimal()</span></code></p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
</tr>
</tbody>
</table>
<p>[Python中修改字符串的四种方法]</p>
<p>str match</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">str.startswith(sub_str)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">str.endswith(sub_str)</span></code></p></li>
</ul>
<p>str的 转换</p>
<p>list ↔️ str</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">str</span> <span class="pre">=</span> <span class="pre">''.join(lst)</span></code></p></li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">lst</span> <span class="pre">=</span> <span class="pre">str.split(':')</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">lst</span> <span class="pre">=</span> <span class="pre">str.split(':',</span> <span class="pre">1)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">lst</span> <span class="pre">=</span> <span class="pre">str.rsplit(':',</span> <span class="pre">1)</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">lst</span> <span class="pre">=</span> <span class="pre">list(str)</span></code></p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="s1">'a:a:a:a'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="go">['a', ':', 'a', ':', 'a', ':', 'a']</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="go">['a:a:a:a']</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">':'</span><span class="p">)</span>
<span class="go">['a', 'a', 'a', 'a']</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">':'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">['a', 'a:a:a']</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">rsplit</span><span class="p">(</span><span class="s1">':'</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="go">['a:a:a', 'a']</span>
</pre></div>
</div>
</section>
</section>
<section id="support">
<h3 id="support">散列表-support<a class="headerlink" href="#support" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line"><span class="defi">查询性能出众</span> <span class="defi">无序</span> <span class="defi">键不稳定</span> <span class="defi">空间换时间</span></div>
<div class="line">是 dict &amp; set 性能出众的根本原因。虽然无序但是内容一样的话一样等价。</div>
</div>
<p>==可散列类型 hashable==。如果一个对象是可散列的，那么在这个对象**生命周期**中，它的散列值是不变的，而且这个对象需要实现  <code class="docutils literal notranslate"><span class="pre">.__hash__()</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">.__eq__()</span></code>  。因为 <code class="docutils literal notranslate"><span class="pre">hash()</span></code>  方法可以作用于对象上，并且如果两个可散列的对象是相等，那么散列值一定是一样。</p>
<ul>
<li><p>原子不可变类型( str &amp; bytes &amp; 数值)</p></li>
<li><p>frozenset（因为只能容纳可散列类型）</p></li>
<li><p>&lt;u&gt;包含的所有元素都是可散列的&lt;/u&gt; tuple</p></li>
<li><p>一般用户自定义的的类型的对象是可散列的。所有对象在比较的时候都是不相等，哪怕是内容一样。</p>
<blockquote>
<div><div class="admonition-id admonition hint">
<p class="admonition-title">散列值是  <code class="docutils literal notranslate"><span class="pre">id()</span></code> ?</p>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Fruit</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">name</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">apple1</span><span class="p">,</span> <span class="n">apple2</span> <span class="o">=</span> <span class="n">Fruit</span><span class="p">(</span><span class="s1">'apple'</span><span class="p">),</span> <span class="n">Fruit</span><span class="p">(</span><span class="s1">'apple'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">hash</span><span class="p">(</span><span class="n">apple1</span><span class="p">)</span> <span class="o">==</span> <span class="nb">hash</span><span class="p">(</span><span class="n">apple2</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<div class="admonition-python3-3-str-byte-datetime-defi admonition note">
<p class="admonition-title">从 python3.3 开始，str &amp; byte &amp; datetime 的单列值计算多了 <span class="defi">随机加盐</span> 这一步。</p>
<p>所加的盐值是 python 进程的一个常量，但是每次启动时 python.exe 都会生成一个不同的盐值。随机盐值是为了防止 DOS 攻击而采取的一种安全措施。</p>
</div>
<div class="admonition-python-hashable admonition danger">
<p class="admonition-title">python 里所有不可变的类型都是 hashable ❌</p>
<p>虽然 tuple 是不可变的，但是里面的元素可能是其他可变类型的引用。</p>
</div>
<div class="line-block">
<div class="line"><strong>散列表的工作原理。</strong></div>
<div class="line">需要  <code class="docutils literal notranslate"><span class="pre">hash()</span></code>  来计算散列值，并且如果两个可散列的对象是相等，那么散列值一定是一样。</div>
</div>
<blockquote>
<div><div class="line-block">
<div class="line">1 :defi:` 1.0  <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>  </mtext><mo>⟹</mo><mtext>  </mtext></mrow><annotation encoding="application/x-tex">\implies</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟹</span><span class="mspace" style="margin-right:0.2778em;"></span></span></span></span></span>  hash(1) ` hash(1.0)</div>
<div class="line">哪怕是整型和浮点的内部结构完全不一样。</div>
</div>
</div></blockquote>
<div class="admonition-math-nrightarrow admonition danger">
<p class="admonition-title">散列值一定是一样  <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇏</mo></mrow><annotation encoding="application/x-tex">\nRightarrow</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel amsrm">⇏</span></span></span></span></span>  两个可散列的对象是相等</p>
</div>
<div class="line-block">
<div class="line">为了让散列值能胜任散列表索引这一角色，散列值必须在索引空间尽量分散开。在最理想的情况下，越相似但不想等的两个对象的散列值差异应该越大。</div>
<div class="line"><span class="defi">表元</span> ，散列表里的单元，所有的表元的大小一致，所以可以通过偏移量来读取某个单元。</div>
<div class="line">为了查询  <code class="docutils literal notranslate"><span class="pre">search_item</span></code>  是否存在在结构中：</div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hash(search_item)</span></code>  计算散列值</p></li>
<li><p>把散列值最低的几位数字当作偏移量，在散列表查找表元。</p></li>
<li><p>🟰 空，➡️  <code class="docutils literal notranslate"><span class="pre">search_item</span></code>  不在结构中。 🔚</p></li>
<li><p>🟰 非空，即表元存放了一个  <code class="docutils literal notranslate"><span class="pre">found_item</span></code> ，但是散列值相同的不一定是一样的</p></li>
<li><p>比较  <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">search_item</span> <span class="pre">:defi:`</span> <span class="pre">found_item</span></code></p></li>
<li><p>🟰  <code class="docutils literal notranslate"><span class="pre">True</span></code>  ，就对了。🔚</p></li>
<li><dl class="simple">
<dt>🟰  <code class="docutils literal notranslate"><span class="pre">False</span></code> ，只能证明出现 &lt;u&gt;散列冲突&lt;/u&gt;。</dt><dd><p>为了解决散列冲突，算法在散列值中再另外去几位，然后用特殊的方法处理一下，得到新的散列值来在散列表查找表元，重复 2-7。</p>
</dd>
</dl>
</li>
<li><p>直至发现 1️⃣ 表元为空 2️⃣  <code class="docutils literal notranslate"><span class="pre">search_item</span> <span class="pre">`</span> <span class="pre">found_item</span></code>  结束循环</p></li>
</ol>
<p><strong>效率到底有多高？</strong></p>
<div class="admonition-s2-s1-if-s-in-s1 admonition hint">
<p class="admonition-title">对 s2 里每个元素，查询是否存在 s1 里？  <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">s</span> <span class="pre">in</span> <span class="pre">s1</span></code></p>
<ol class="arabic simple">
<li><p>集合进行并操作，但前提是 s1 &amp; s2 都是集合</p></li>
<li><p>s1 是 字典</p></li>
<li><p>s1 是 集合</p></li>
<li><p>s1 是 列表。</p></li>
</ol>
<div class="line-block">
<div class="line">在字典和集合不超出内存的前提下，无论 s1 里有多少元素，查询时间可忽略不计。</div>
<div class="line">因为列表没有散列表支持  <code class="docutils literal notranslate"><span class="pre">__contains__</span></code>  操作，每一次扫描都需要扫描一遍完整的列表，时间根据 s1 的大小呈 <strong>线性增加</strong></div>
<div class="line">虽然第一种最快，但是需要 s2 也是集合，涉及转成 set 的成本，不必强求。</div>
</div>
</div>
<div class="line-block">
<div class="line"><strong>为什么元素是无序且不稳定？</strong></div>
<div class="line">键对的排列顺序与添加顺序不同，也与存储顺序不同。</div>
<div class="line"><span class="defi">散列表</span> 是一个稀疏数组(<strong>总是**有空白元素)。 **为了减少散列冲突的概率</strong>，python 会设法保证大概还有三分之一的表元是空白的，每快到这个阈值时，python 会重新分配内存，所有的散列表就会被复制到一个更大的空间里面。 <strong>【空间换时间】</strong> 如果增加散列表的大小，散列值所占的位数和索引的位数都随之增加。</div>
<div class="line">在扩容的过程中，有可能发生新的散列冲突，导致新散列表中元素的次序变化。所以是无序且不稳定。</div>
</div>
<div class="admonition-dict-set admonition danger">
<p class="admonition-title">不要在迭代的过程中 对 dict &amp; set 进行修改。有可能会跳过一些键。”</p>
<ol class="arabic simple">
<li><p>首先迭代，记录要修改的东西，再在迭代后进行更新。</p></li>
</ol>
</div>
<section id="dict">
<h4 id="dict">dict<a class="headerlink" href="#dict" title="Link to this heading">¶</a></h4>
<p>一系列键—值对。每个键都与一个值相关联，使用键来访问与之相关联的值。
内存开销巨大，不仅因为散列表耗费，还因为需要【重复的键】在每个记录里都要存一遍。
模块的命名空间、实例的属性、函数的关键字参数。跟它相关的内置函数在  <code class="docutils literal notranslate"><span class="pre">__builtins__.__dict__</span></code>  模块中</p>
<ul>
<li><dl>
<dt>init</dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">dict(one=1,</span> <span class="pre">two=2)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">{'one':1,</span> <span class="pre">'two':2}</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">dict(zip(['one',</span> <span class="pre">'two'],[1,2]))</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">dict([('one',</span> <span class="pre">1),('two',</span> <span class="pre">2)])</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">{k:</span> <span class="pre">v</span> <span class="pre">for</span> <span class="pre">k,</span> <span class="pre">v</span> <span class="pre">in</span> <span class="pre">[('one',</span> <span class="pre">1),('two',</span> <span class="pre">2)]}</span></code>  字典推导</div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>get. 只想查，并不想对字典更改。</dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">d[k]</span></code> , 没有就 <code class="docutils literal notranslate"><span class="pre">KeyError</span></code> .</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">d.get(k,</span> <span class="pre">[default=None])</span></code> , 没有就返回 <code class="docutils literal notranslate"><span class="pre">default</span></code> ， 纯粹 get</div>
</div>
<div class="admonition-notes admonition warning">
<p class="admonition-title">notes</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d.__getitem__(v)</span></code>  的 call 是  <code class="docutils literal notranslate"><span class="pre">d[k]</span></code> ； 和 <code class="docutils literal notranslate"><span class="pre">d.get(..)</span></code>  一点关系都没有。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">d.get(..)</span></code>  不会改变原有的字典。</p></li>
</ol>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>contains</dt><dd><p><code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">in</span> <span class="pre">d.keys()</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">k</span> <span class="pre">in</span> <span class="pre">d:</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">v</span> <span class="pre">in</span> <span class="pre">d.values()</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>loop</dt><dd><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">k,</span> <span class="pre">v</span> <span class="pre">in</span> <span class="pre">d.items():</span></code></p>
</dd>
</dl>
</li>
<li><dl>
<dt>更新。</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">d[k]=v</span></code>  只有赋值时管用。</p></li>
<li><dl>
<dt>更新的时候</dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">d.setdefault(k,</span> <span class="pre">default)</span></code>  值的格式不统一</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">from</span> <span class="pre">collections</span> <span class="pre">import</span> <span class="pre">defaultdict</span></code>  值的格式统一，都是 list | str | int</div>
</div>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<div class="admonition-get-v admonition warning">
<p class="admonition-title">为什么不用 get 的方法。【针对部分改变 v 值 情况】</p>
<div class="line-block">
<div class="line">更新 1️⃣ 彻底改变 v 值(包括新增 k-v 对) 2️⃣ 部分改变 v 值（ <code class="docutils literal notranslate"><span class="pre">d[k]+=1</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">d[v].append()</span></code> ）</div>
<div class="line">对于 1️⃣： <code class="docutils literal notranslate"><span class="pre">k[v]</span></code>  是可以的，标准赋值语句，但是 2️⃣ 会引发  <code class="docutils literal notranslate"><span class="pre">KeyError</span></code>  直接报错，因为操作需要 k-v 存在。</div>
<div class="line">如果用  <code class="docutils literal notranslate"><span class="pre">.get()</span></code>  的方法 就必须涉及二次查询，因为当不存在时，返回的 default 并没有跟  <code class="docutils literal notranslate"><span class="pre">d[k]</span></code>  绑定在一起，需要赋值语句进行绑定，其中涉及再次查询。</div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="n">v</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="p">[])</span>  <span class="c1"># 查一次</span>
</span><span class="n">v</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>  <span class="c1"># 查两次</span>
<span class="hll"><span class="n">d</span><span class="o">.</span><span class="n">setdefault</span><span class="p">[</span><span class="n">k</span><span class="p">,</span> <span class="p">[]]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>  <span class="c1"># 只查一次</span>
</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="hll"><span class="n">d</span>  <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>  <span class="c1"># list []</span>
</span><span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition-defaultdict-setdefault admonition hint">
<p class="admonition-title">如非需要， <code class="docutils literal notranslate"><span class="pre">defaultdict</span></code>  比  <code class="docutils literal notranslate"><span class="pre">.setdefault()</span></code> 更快”</p>
<div class="line-block">
<div class="line">因为一个是在创建初期就设好统一的初始值，一个是根据值的不一样，在找的时候设值</div>
<div class="line">[setdefault vs defaultdict performance](<a class="reference external" href="https://stackoverflow.com/questions/38625608/setdefault-vs-defaultdict-performance">https://stackoverflow.com/questions/38625608/setdefault-vs-defaultdict-performance</a>)</div>
</div>
</div>
<section id="defaultdict">
<h5 id="defaultdict">defaultdict<a class="headerlink" href="#defaultdict" title="Link to this heading">¶</a></h5>
<p><code class="docutils literal notranslate"><span class="pre">collections.defaultdict</span></code>  当值的格式统一，都是 list | str | int。</p>
<p>具体而言，在实例化一个 defaultdict 对象时，给构造方法提供了一个**可调用对象(不是方法)**。当  <code class="docutils literal notranslate"><span class="pre">.__getitem__</span></code>  找不到键时，调用 <code class="docutils literal notranslate"><span class="pre">.__missing__</span></code> , 然后  <code class="docutils literal notranslate"><span class="pre">.__missing__</span></code>  调用存放在  <code class="docutils literal notranslate"><span class="pre">default_factory</span></code> 属性的这个可调用对象，可调用对象产生默认值，让  <code class="docutils literal notranslate"><span class="pre">.__getitem__</span></code>  返回。</p>
<div class="admonition-missing admonition note">
<p class="admonition-title">关键是实现了  <code class="docutils literal notranslate"><span class="pre">.__missing__</span></code> 方法。</p>
<div class="line-block">
<div class="line">为了自定义映射类型在找不到键时的反应，可以重定义 <code class="docutils literal notranslate"><span class="pre">.__missing__</span></code> （见魔法方法那一节）。</div>
<div class="line">基类 dict 没有定义，但是它知道，所以如果某个类继承了 dict，又是实现了  <code class="docutils literal notranslate"><span class="pre">__missing__</span></code>  ，那么在  <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>  找不到键时，python 会自动调用它，而不是抛出  KeyError.</div>
</div>
</div>
<ul>
<li><dl>
<dt>init</dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">defaultdict([default_factory])</span></code></div>
<div class="line">如果没有指定 default_factory， 找不到还是会产生 keyError</div>
</div>
</dd>
</dl>
</li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="go">defaultdict(&lt;class 'list'&gt;, {})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">default_factory</span>
<span class="go">&lt;class 'list'&gt;</span>
</pre></div>
</div>
<p>&gt;  <code class="docutils literal notranslate"><span class="pre">d</span> <span class="pre">=</span> <span class="pre">defaultdict(list)</span></code> ，当 k 找不到的时候：
&gt; 1）调用  <code class="docutils literal notranslate"><span class="pre">list()</span></code>  建立一个新 list
&gt; 2）d[k] 存放 新 list 的引用
&gt; 3）返回 d[k]</p>
</section>
<section id="ordereddict">
<h5 id="ordereddict">OrderedDict<a class="headerlink" href="#ordereddict" title="Link to this heading">¶</a></h5>
<p><code class="docutils literal notranslate"><span class="pre">collections.OrderedDict</span></code> .</p>
<div class="line-block">
<div class="line">与 dict 的 区别 : 维护插入顺序的字典，区别只在于 <strong>记录了键—值对的添加顺序</strong></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">.popitem()</span></code>  默认删除并返回的时字典里最后一个元素（最新添加的）</div>
</div>
</section>
<section id="chainmaps">
<h5 id="chainmaps">ChainMaps<a class="headerlink" href="#chainmaps" title="Link to this heading">¶</a></h5>
</section>
<section id="counter">
<h5 id="counter">Counter<a class="headerlink" href="#counter" title="Link to this heading">¶</a></h5>
<p><code class="docutils literal notranslate"><span class="pre">collections.Counter</span></code>  整数计数器</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">Counter</span>

<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">ct</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">(</span><span class="s1">'abbcbcbb'</span><span class="p">)</span>
</span><span class="go">ct=Counter({'b': 5, 'c': 2, 'a': 1})</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">ct</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s1">'aaa'</span><span class="p">)</span>
</span><span class="go">ct=Counter({'b': 5, 'a': 4, 'c': 2})</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">ct</span><span class="o">.</span><span class="n">most_common</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span class="go">[('b', 5)]</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="n">ct</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="c1"># 求总数</span>
</span><span class="go">11</span>
</pre></div>
</div>
</section>
</section>
<section id="id34">
<h4 id="id34">不可变的映射类型<a class="headerlink" href="#id34" title="Link to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">types.MappingProxyType</span></code>
| 提供一个映射的 <strong>只读的动态视图</strong>。不能进行修改，但是如果原映射改了，作为的动态视图 MappingProxyType 也能看见。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">types</span> <span class="kn">import</span> <span class="n">MappingProxyType</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span><span class="s1">'A'</span><span class="p">}</span>  <span class="c1"># dict \in mapping</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">d_proxy</span> <span class="o">=</span> <span class="n">MappingProxyType</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</span><span class="go"> d=d_proxy=mappingproxy({1: 'A'})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d_proxy</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'B'</span>
<span class="hll"><span class="go">TypeError: 'mappingproxy' object does not support item assignment</span>
</span><span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'B'</span>
</span><span class="go">d=d_proxy=mappingproxy({1: 'A', 2: 'B'})</span>
</pre></div>
</div>
</section>
<section id="set">
<h4 id="set">set<a class="headerlink" href="#set" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line"><span class="defi">Mutable</span> + <span class="defi">去重</span> ， <span class="defi">无序</span></div>
<div class="line">专为 <strong>检查元素是否存在</strong> 做过优化。</div>
<div class="line">set 里的元素必须是 hashable，但 set 本身是 unhashable。如果set 底下是要放集合，必须放 <strong>frozenset</strong></div>
</div>
<div class="admonition-frozenset-defi-unmutable-defi-hashable admonition note">
<p class="admonition-title">姊妹类型 frozenset ： <span class="defi">unmutable</span> + <span class="defi">hashable</span></p>
</div>
<ul>
<li><dl>
<dt>init</dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">set()</span></code>  &lt;u&gt;空集合必须&lt;/u&gt;。</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">set(iterater)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">{v</span> <span class="pre">for</span> <span class="pre">v</span> <span class="pre">in</span> <span class="pre">iterater}</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">s</span> <span class="pre">=</span> <span class="pre">{v1,</span> <span class="pre">v2,</span> <span class="pre">...}</span></code></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>element level</dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">s.add(e)</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">s.discard(e)</span></code>  &lt;u&gt;不存在do nothing&lt;/u&gt;</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">s.remove(e)</span></code>  &lt;u&gt;不存在就报错&lt;/u&gt;</div>
</div>
</dd>
</dl>
</li>
<li><p>数学运算</p>
<blockquote>
<div><div class="line-block">
<div class="line">同样存在 in-placed 的方法  <code class="docutils literal notranslate"><span class="pre">&amp;=</span></code> <code class="docutils literal notranslate"><span class="pre">|=</span></code> <code class="docutils literal notranslate"><span class="pre">-=</span></code> <code class="docutils literal notranslate"><span class="pre">^=</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">s1</span> <span class="pre">&amp;</span> <span class="pre">s2</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>1</mn><mo>∩</mo><mi>s</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">s1 \cap s2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">s</span><span class="mord">2</span></span></span></span></span>  交  <code class="docutils literal notranslate"><span class="pre">.__and__</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">s1</span> <span class="pre">|</span> <span class="pre">s2</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>1</mn><mo>∪</mo><mi>s</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">s1 \cup s2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">s</span><span class="mord">2</span></span></span></span></span>  并  <code class="docutils literal notranslate"><span class="pre">.__or__</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">s1</span> <span class="pre">-</span> <span class="pre">s2</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>1</mn><mo>∖</mo><mi>s</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">s1 \setminus s2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∖</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">s</span><span class="mord">2</span></span></span></span></span>  差  <code class="docutils literal notranslate"><span class="pre">.__sub__</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">s1</span> <span class="pre">^</span> <span class="pre">s2</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>s</mi><mn>1</mn><mo>∪</mo><mi>s</mi><mn>2</mn><mo stretchy="false">)</mo><mo>−</mo><mo stretchy="false">(</mo><mi>s</mi><mn>1</mn><mo>∩</mo><mi>s</mi><mn>2</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(s1 \cup s2) - (s1 \cap s2)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∪</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord">2</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∩</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span>  对称差集  <code class="docutils literal notranslate"><span class="pre">.__xor__</span></code></div>
</div>
</div></blockquote>
</li>
<li><dl>
<dt>比较运算</dt><dd><div class="line-block">
<div class="line">重写了  <code class="docutils literal notranslate"><span class="pre">__le__</span></code> <code class="docutils literal notranslate"><span class="pre">__lt__</span></code> <code class="docutils literal notranslate"><span class="pre">__ge__</span></code> <code class="docutils literal notranslate"><span class="pre">__gt__</span></code></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">s1</span> <span class="pre">&lt;</span> <span class="pre">s2</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>1</mn><mo>⊂</mo><mi>s</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">s1 \subset s2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.6835em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">s</span><span class="mord">2</span></span></span></span></span></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">s.issuperset(it)</span></code>  把可迭代 it 转换为 set，然后看 s 是否是它的子集</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">s1</span> <span class="pre">&lt;=</span> <span class="pre">s2</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mn>1</mn><mo>⊆</mo><mi>s</mi><mn>2</mn></mrow><annotation encoding="application/x-tex">s1 \subseteq s2</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7804em;vertical-align:-0.136em;"></span><span class="mord mathnormal">s</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊆</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord mathnormal">s</span><span class="mord">2</span></span></span></span></span></div>
</div>
</dd>
</dl>
</li>
</ul>
</section>
</section>
<section id="sparse-matrix">
<h3 id="sparse-matrix">sparse_matrix<a class="headerlink" href="#sparse-matrix" title="Link to this heading">¶</a></h3>
<section id="scipy-sparse-coo-matrix">
<h4 id="scipy-sparse-coo-matrix"><code class="docutils literal notranslate"><span class="pre">scipy.sparse.coo_matrix</span></code><a class="headerlink" href="#scipy-sparse-coo-matrix" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line"><strong>只存储非零元素</strong></div>
<div class="line">三元组 <code class="docutils literal notranslate"><span class="pre">(row,</span> <span class="pre">col,</span> <span class="pre">data)</span></code> (或称为 <strong>ijv format</strong> )的形式来存储矩阵中非零元素的信息。</div>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>实际</dt><dd><ul>
<li><p>用来创建矩阵，因为 <code class="docutils literal notranslate"><span class="pre">coo_matrix</span></code> <strong>无法</strong> 对矩阵的元素进行增删改操作</p></li>
<li><p>转置、矩阵运算等，要转  <code class="docutils literal notranslate"><span class="pre">csr_matrix</span></code> 、 <code class="docutils literal notranslate"><span class="pre">csc_matrix</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><p>实例</p></li>
<li><p>转化</p></li>
</ul>
<p>[Python稀疏矩阵详解]</p>
</section>
</section>
<section id="id35">
<h3 id="id35">堆<a class="headerlink" href="#id35" title="Link to this heading">¶</a></h3>
<div class="admonition-heap-0-is-smallest admonition note">
<p class="admonition-title">最小的元素总是在根结点： <code class="docutils literal notranslate"><span class="pre">heap[0]</span> <span class="pre">is</span> <span class="pre">smallest</span></code></p>
<div class="line-block">
<div class="line">堆是一个二叉树，它的每个父节点的值都只会小于或等于所有孩子节点</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">parent</span> <span class="pre">&lt;=</span> <span class="pre">childs</span></code> 。</div>
</div>
</div>
<ul class="simple">
<li><p>一棵完全二叉树的数组对象 = 它使用了数组来实现：</p></li>
<li><p>【最小堆】从零开始计数，对于所有的 k ，都有  <code class="docutils literal notranslate"><span class="pre">heap[k]</span> <span class="pre">&lt;=</span> <span class="pre">heap[2*k+1]</span></code>  和  <code class="docutils literal notranslate"><span class="pre">heap[k]</span> <span class="pre">&lt;=</span> <span class="pre">heap[2*k+2]</span></code> 。 为了便于比较，不存在的元素被认为是无限大。</p></li>
</ul>
<section id="heapq-py">
<h4 id="heapq-py"><code class="docutils literal notranslate"><span class="pre">heapq.py</span></code>  堆队列 = 优先队列算法<a class="headerlink" href="#heapq-py" title="Link to this heading">¶</a></h4>
<p><strong>Heap queue algorithm (a.k.a. priority queue):</strong></p>
<div class="admonition- admonition note">
<p class="admonition-title">最小堆</p>
<p><code class="docutils literal notranslate"><span class="pre">heapq[0]</span> <span class="pre">is</span> <span class="pre">smallest</span></code></p>
</div>
<ul class="simple">
<li><dl class="simple">
<dt>properties</dt><dd><ul>
<li><p><strong>排序稳定性</strong>：具有相同的优先级的话就会按他们被插入到队列的顺序返回 ——&gt; 条目计数可用来打破平局</p></li>
<li><p><strong>堆</strong> pop 操作总是返回优先级最高</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ref</dt><dd><ul>
<li><p>[heapq –堆队列算法]</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<section id="code">
<h5 id="code">code<a class="headerlink" href="#code" title="Link to this heading">¶</a></h5>
<p><code class="docutils literal notranslate"><span class="pre">heap.sort()</span></code>  维护了堆的不变性</p>
<div class="admonition-heapq admonition danger">
<p class="admonition-title">heapq 不是一个类而是一个模块</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">heapq</span>

<span class="n">Meth</span><span class="p">:</span>
<span class="o">-</span> <span class="n">heapify</span><span class="p">(</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>dd</p></th>
<th class="head"><p>❌</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>✅</p></td>
<td><p>➡️</p></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>operations</p></th>
<th class="head"><p>code</p></th>
<th class="head"><p>return</p></th>
<th class="head"><p>T(n)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>建立空堆</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">h</span> <span class="pre">=</span> <span class="pre">[]</span></code></p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>list  ➡️ heap</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">heapify(h)</span></code></p></td>
<td><p>❌ <strong>in-placed</strong></p></td>
<td><p>O(n)</p></td>
</tr>
<tr class="row-even"><td rowspan="6"><p>加入弹出</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">heapq.heappush(h,</span> <span class="pre">x)</span></code></p></td>
<td><p>❌</p></td>
<td><p><strong>O(logn)</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">heapq.heappop(h)</span></code></p></td>
<td><p>✅ 最小 <code class="docutils literal notranslate"><span class="pre">h[0]</span></code> , 空就有 <code class="docutils literal notranslate"><span class="pre">IndexError</span></code></p></td>
<td><p>O(logn)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">heapq.heappushpop(h,</span> <span class="pre">x)</span></code></p></td>
<td rowspan="2"><p>✅  &lt;= x(因为先加x)</p></td>
<td rowspan="4"><p>比连调两个单纯函数要快</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;=&gt;  <code class="docutils literal notranslate"><span class="pre">push+pop</span></code> , 先加x再弹出</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">heapq.heapreplace(h,</span> <span class="pre">x)</span></code></p></td>
<td><p>✅             x(因为后加x)</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;=&gt;  <code class="docutils literal notranslate"><span class="pre">pop+push</span></code></p></td>
<td><p>空就有 <code class="docutils literal notranslate"><span class="pre">IndexError</span></code></p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
</section>
<section id="basic-operaions">
<h2 id="basic-operaions">Basic operaions<a class="headerlink" href="#basic-operaions" title="Link to this heading">¶</a></h2>
<section id="n">
<h3 id="n">查找最大或最小的 N 个元素<a class="headerlink" href="#n" title="Link to this heading">¶</a></h3>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>简单对象</p></th>
<th class="head"></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>全部排序或查找Top N&lt;len(lst) 个</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">sorted(lst,</span> <span class="pre">*,</span> <span class="pre">key=None,</span> <span class="pre">reverse=False)</span></code> ,  <code class="docutils literal notranslate"><span class="pre">sorted(lst)[:N]</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>查找Top N&lt;&lt;len(lst) 个</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">heapq.nlargest()</span></code> ,  <code class="docutils literal notranslate"><span class="pre">heapq.smallest()</span></code></p></td>
</tr>
<tr class="row-even"><td><p>最大/最小</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">max(lst)</span></code> <code class="docutils literal notranslate"><span class="pre">min(lst)</span></code></p></td>
</tr>
</tbody>
</table>
<section id="id36">
<h4 id="id36">复杂对象<a class="headerlink" href="#id36" title="Link to this heading">¶</a></h4>
<ul>
<li><p>comparable :  <code class="docutils literal notranslate"><span class="pre">key=lambda</span></code>  or  <code class="docutils literal notranslate"><span class="pre">key=</span> <span class="pre">itemgetter()</span></code></p></li>
<li><dl>
<dt>uncmparable<span class="classifier"><code class="docutils literal notranslate"><span class="pre">key=lambda</span></code>  or  <code class="docutils literal notranslate"><span class="pre">key=</span> <span class="pre">attrgetter()</span></code></span></dt><dd><p>选择使用  <code class="docutils literal notranslate"><span class="pre">lambda</span></code>  函数或者是  <code class="docutils literal notranslate"><span class="pre">attrgetter()</span></code>  可能取决于个人喜好。 但是，  <code class="docutils literal notranslate"><span class="pre">attrgetter()</span></code>  函数通常会运行的快点，并且还能同时允许多个字段进行比较。同样适用于像  <code class="docutils literal notranslate"><span class="pre">min()</span></code>  和  <code class="docutils literal notranslate"><span class="pre">max()</span></code>  之类的函数</p>
</dd>
</dl>
</li>
</ul>
<p>[python之排序操作及heapq模块]</p>
</section>
<section id="id37">
<h4 id="id37">其他常用<a class="headerlink" href="#id37" title="Link to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">random.choice(seq)</span></code>  从一个序列中随机选出一个元素</p>
<ul>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">math</span></code></dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">.sqrt(n)</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><msqrt><mi>n</mi></msqrt></mrow><annotation encoding="application/x-tex">=\sqrt{n}</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.04em;vertical-align:-0.2397em;"></span><span class="mord sqrt"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8003em;"><span class="svg-align" style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord" style="padding-left:0.833em;"><span class="mord mathnormal">n</span></span></span><span style="top:-2.7603em;"><span class="pstrut" style="height:3em;"></span><span class="hide-tail" style="min-width:0.853em;height:1.08em;"><svg height="1.08em" preserveaspectratio="xMinYMin slice" viewbox="0 0 400000 1080" width="400em" xmlns="http://www.w3.org/2000/svg"><path d="M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z"></path></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2397em;"><span></span></span></span></span></span></span></span></span></span> <code class="docutils literal notranslate"><span class="pre">.pow(n,</span> <span class="pre">a)</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><msup><mi>n</mi><mi>a</mi></msup></mrow><annotation encoding="application/x-tex">=n^a</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">a</span></span></span></span></span></span></span></span></span></span></span></span> <code class="docutils literal notranslate"><span class="pre">.exp(n)</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><msup><mi>e</mi><mi>n</mi></msup></mrow><annotation encoding="application/x-tex">=e^n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6644em;"></span><span class="mord"><span class="mord mathnormal">e</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6644em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span></span></span></span></span></span></span></span> <code class="docutils literal notranslate"><span class="pre">.log(n,</span> <span class="pre">a)</span></code>   | <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><msubsup><mrow><mi>log</mi><mo>⁡</mo></mrow><mn>2</mn><mi>n</mi></msubsup></mrow><annotation encoding="application/x-tex">=\log_2^n</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9957em;vertical-align:-0.247em;"></span><span class="mop"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7487em;"><span style="top:-2.453em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span><span style="top:-3.1473em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">.fabs(n)</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>float</mtext><mo stretchy="false">(</mo><mi mathvariant="normal">∣</mi><mi>n</mi><mi mathvariant="normal">∣</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{float}(|n|)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">float</span></span><span class="mopen">(</span><span class="mord">∣</span><span class="mord mathnormal">n</span><span class="mord">∣</span><span class="mclose">)</span></span></span></span></span> <code class="docutils literal notranslate"><span class="pre">abs(n)</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi mathvariant="normal">∣</mi><mi>n</mi><mi mathvariant="normal">∣</mi></mrow><annotation encoding="application/x-tex">=|n|</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">∣</span><span class="mord mathnormal">n</span><span class="mord">∣</span></span></span></span></span></div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">.factorial(n)</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>n</mi><mo stretchy="false">!</mo></mrow><annotation encoding="application/x-tex">=n!</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">n</span><span class="mclose">!</span></span></span></span></span></div>
</div>
<table>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">.ceil(f)</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mo>≥</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">=\ge f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">=≥</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">.floor(f)</span></code> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mo>≤</mo><mi>f</mi></mrow><annotation encoding="application/x-tex">=\le f</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7719em;vertical-align:-0.136em;"></span><span class="mrel">=≤</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span></span></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">.trunc(f)</span></code> 只要整数部分</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>3.3</p></td>
<td><p>4</p></td>
<td><p>3</p></td>
<td><p>3</p></td>
</tr>
<tr class="row-odd"><td><p>-2.3</p></td>
<td><p>-2</p></td>
<td><p>-3</p></td>
<td><p>-2</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</li>
</ul>
<section id="id38">
<h5 id="id38">并行迭代对象<a class="headerlink" href="#id38" title="Link to this heading">¶</a></h5>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">zip(IterableA,</span> <span class="pre">IterableB,</span> <span class="pre">...)</span></code>  并行多个迭代对象返回生成器，生成元组。但会在 <strong>最短</strong> 的可迭代对象耗尽时停止,但不给提示。</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">itertools.zip_longest(IterableA,</span> <span class="pre">IterableB,</span> <span class="pre">...,</span> <span class="pre">fillvalue=None)</span></code>  用 fillvalue 填充缺失的值，直到 <strong>最长</strong> 的可迭代对象耗尽。</div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">itertools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z1</span> <span class="o">=</span> <span class="nb">zip</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="s1">'ABC'</span><span class="p">,</span> <span class="s1">'ab'</span><span class="p">)</span>
<span class="go">z1=&lt;zip object at 0x10288bf40&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">z1</span><span class="p">)</span>
<span class="go">[(1, 'A', 'a'), (2, 'B', 'b')]  # 停止不给提示</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">z2</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">zip_longest</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="s1">'ABC'</span><span class="p">,</span> <span class="s1">'ab'</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="s1">'?'</span><span class="p">)</span>
<span class="go">z2=itertools.zip_longest(range(1,4), 'ABC', 'ab', fillvalue='?')</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">z2</span><span class="p">)</span>
<span class="go">[(1, 'A', 'a'), (2, 'B', 'b'), (3, 'C', '?')]  # 填充</span>
</pre></div>
</div>
</section>
</section>
</section>
</section>
<section id="id39">
<h2 id="id39">基本操作<a class="headerlink" href="#id39" title="Link to this heading">¶</a></h2>
<section id="id40">
<h3 id="id40">运算符<a class="headerlink" href="#id40" title="Link to this heading">¶</a></h3>
<div class="admonition- admonition note">
<p class="admonition-title">中缀运算符的基本原则是返回来一个新的值，而不改变操作对象本身。</p>
</div>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>❗算术运算符</p></th>
<th class="head"><p>a/b</p></th>
<th class="head"><p>a//b</p></th>
<th class="head"><p>a%b</p></th>
<th class="head"><p>a**b</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>a=3,b=2</p></td>
<td><p>整数+小数</p></td>
<td><p>只要整数</p></td>
<td><p>余数</p></td>
<td><p>幂</p></td>
</tr>
<tr class="row-odd"><td><p>^</p></td>
<td><p>1.5</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
<td><p>9</p></td>
</tr>
</tbody>
</table>
</section>
<section id="iterator">
<h3 id="iterator">iterator 迭代器<a class="headerlink" href="#iterator" title="Link to this heading">¶</a></h3>
<p>它是访问容器（例如列表、元组等）中的元素的一种方式，可以**逐个访问容器中的元素，而不必将整个容器存储在内存中**。</p>
<ul class="simple">
<li><dl class="simple">
<dt>properties</dt><dd><ul>
<li><dl class="simple">
<dt>惰性计算, lazy evaluation,</dt><dd><p>惰性计算指的是在需要时才进行计算，而非提前将所有的计算都执行完毕。对于大型数据集合，惰性计算可以节省内存开销并提高程序性能</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>可逆性, reversibility</dt><dd><p>可以通过 <strong>反向迭代器（reverse iterator）</strong> 来逆序访问容器中的元素。Python标准库中提供了 <code class="docutils literal notranslate"><span class="pre">reversed()</span></code> 函数用于创建反向迭代器。</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<table>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>只有data</p></th>
<th class="head"><p>一个列表</p></th>
<th class="head"><p>notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">iter()</span></code></p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">enumerate(sequence,</span> <span class="pre">[start=0])</span></code></p></td>
<td><p>❌ auto_index + data</p></td>
<td><p>✅</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">zip(strict)</span></code></p></td>
<td><p>✅</p></td>
<td><p>❌ 多个</p></td>
<td><p>3.10版本设 <code class="docutils literal notranslate"><span class="pre">strict=True</span></code> 为严格遵守大小相等</p></td>
</tr>
</tbody>
</table>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="n">names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'Alice'</span><span class="p">,</span> <span class="s1">'Bob'</span><span class="p">,</span> <span class="s1">'Charlie'</span><span class="p">]</span>
<span class="n">ages</span> <span class="o">=</span> <span class="p">[</span><span class="mi">24</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">18</span><span class="p">]</span>
<span class="n">sexs</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'M'</span><span class="p">,</span><span class="s1">'F'</span><span class="p">,</span> <span class="s1">'M'</span><span class="p">]</span>

<span class="c1"># 1. iter -&gt; data</span>
<span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">iter</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"</span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>

<span class="c1"># 2. enumerate -&gt; (index, data)</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">names</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'NO.</span><span class="si">{}</span><span class="s1"> is </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>

<span class="c1"># 3. zip -&gt;</span>
<span class="k">for</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">sex</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">ages</span><span class="p">,</span> <span class="n">sexs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">sex</span><span class="p">))</span>


<span class="c1"># 4. enumerate + zip</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">sex</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">names</span><span class="p">,</span> <span class="n">ages</span><span class="p">,</span> <span class="n">sexs</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">'NO.</span><span class="si">{}</span><span class="s1"> is </span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1"> - </span><span class="si">{}</span><span class="s1">'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">age</span><span class="p">,</span> <span class="n">sex</span><span class="p">))</span>
        <span class="c1"># 0 Alice 24 M</span>
        <span class="c1"># 1 Bob 50 F</span>
        <span class="c1"># 2 Charlie 18 M</span>
</pre></div>
</div>
<p>[Python中的zip()：从多个列表中获取元素]</p>
</section>
<section id="itertools-module">
<h3 id="itertools-module"><code class="docutils literal notranslate"><span class="pre">itertools</span></code>  module<a class="headerlink" href="#itertools-module" title="Link to this heading">¶</a></h3>
<div class="admonition- admonition note">
<p class="admonition-title">读取大型文件数据</p>
<p>当我们需要处理大量数据时，将整个数据集加载到内存中可能会导致程序崩溃或效率低下。使用Python迭代器来处理大型文件数据非常理想，这种方式只在内存中维护当前处理的数据块，而不需要一次性读取整个文件。</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'large_file.txt'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">process_line</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>[python迭代器详解]</p>
<div class="line-block">
<div class="line">迭代器必须实现__iter__和__next__方法，而生成器只需要实现一个yield语句即可。</div>
<div class="line">生成器可以保存状态，每次调用yield语句时会自动保存当前的局部变量和执行位置，并在下一次调用时恢复执行状态，从而实现了迭代器的功能。</div>
<div class="line">生成器的主要作用是生成序列，而迭代器则可以用于各种数据结构的遍历，包括序列、映射、文件等</div>
</div>
</section>
</section>
<section id="id41">
<h2 id="id41">循环<a class="headerlink" href="#id41" title="Link to this heading">¶</a></h2>
<p>想看索引   <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">idx,</span> <span class="pre">obj</span> <span class="pre">in</span> <span class="pre">enumerate(objs):</span></code></p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">animals</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'cat'</span><span class="p">,</span> <span class="s1">'dog'</span><span class="p">,</span> <span class="s1">'monkey'</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">animal</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">animals</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1"> - </span><span class="si">{</span><span class="n">animal</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
<span class="go">0 - cat</span>
<span class="go">1 - dog</span>
<span class="go">2 - monkey</span>
</pre></div>
</div>
<div class="admonition- admonition danger">
<p class="admonition-title">看清楚循环的是啥</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">'abc'</span><span class="p">,</span> <span class="s1">'def'</span><span class="p">,</span> <span class="s1">'ghj'</span><span class="p">]:</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="go">a b c</span>
<span class="go">d e f</span>
<span class="go">g h j</span>
<span class="go">"""！！！！ 而不是 a d g</span>
<span class="go">这种需要 zip</span>
<span class="go">"""</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="s1">'abc'</span><span class="p">,</span> <span class="s1">'def'</span><span class="p">,</span> <span class="s1">'ghj'</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span>
<span class="go">a d g</span>
<span class="go">b e h</span>
<span class="go">c f j</span>
</pre></div>
</div>
</div>
</section>
<section id="cls">
<h2 id="cls">类 cls<a class="headerlink" href="#cls" title="Link to this heading">¶</a></h2>
<div class="admonition-defi admonition note">
<p class="admonition-title"><span class="defi">实例化</span> 。根据类来创建对象</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">MyClass</span></code> : 类, <span class="defi">驼峰命名法</span> ，即将类名中的 <strong>每个单词的首字母都大写，而不使用下划线</strong>。</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">myclass_1</span></code> : 根据类创建的实例。实例名采用 <strong>小写格式，并在单词之间加上下划线</strong>。</div>
</div>
</div>
<section id="id42">
<h3 id="id42">协议<a class="headerlink" href="#id42" title="Link to this heading">¶</a></h3>
<div class="admonition-defi-duck-typing admonition note">
<p class="admonition-title"><span class="defi">鸭子类型 duck typing</span> 。主要是一种思想。不要去 <strong>严格验证</strong> 是不是鸭子，而是检查有没有鸭子的 <strong>重点特征和行为</strong> 。何谓重点特征和行为，取决于你想使用的类型的根本特征是什么。忽略对象的真正类别，转而关注对象又没有实现所需的 方法 &amp; 签名 &amp; 语义。”</p>
<div class="line-block">
<div class="line">序列类型，只要迭代就行。🟰 只要能迭代都是序列类型，而不需要继承什么或者什么严格定义。</div>
<div class="line">说序列，是因为它的行为像序列。如果只想迭代，只需要  <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>  就行，而不需要 <code class="docutils literal notranslate"><span class="pre">__len__</span></code>  多余的但是属于序列的行为。</div>
</div>
</div>
<div class="admonition-defi-cls-cls-abc-abcmeta-isinstance-obj-cls admonition note">
<p class="admonition-title"><span class="defi">白鹅类型</span> 。只要 cls 是抽象基类 🟰 cls 的元类是  <code class="docutils literal notranslate"><span class="pre">abc.ABCMeta</span></code> ，就可以使用  <code class="docutils literal notranslate"><span class="pre">isinstance(obj,</span> <span class="pre">cls)</span></code> “</p>
</div>
<div class="line-block">
<div class="line"><span class="defi">协议</span> 。是一种约定，用于指导对象之间的交互和行为。Python并没有严格的接口定义，而是通过协议来实现接口的概念。 <strong>协议是非正式的接口</strong>。对象的类型无关紧要，只要实现特定的协议即可。</div>
<div class="line">协议是 <strong>动态**的：函数不关心参数的类型，只要求对象实现了部分所需协议，即使一开始定义时没有实现， **也可以之后再补上</strong>。</div>
</div>
<div class="admonition- admonition note">
<p class="admonition-title">不一定要自己实现所需协议，如果能委托给对象的带有所需协议的属性也可以。但是单纯委托有缺点，可能会返回 委托类型，而不是自定义的类型。”</p>
<div class="admonition-list-list-vector admonition hint">
<p class="admonition-title">向量的切片操作委托给 list 的切片。但是有缺点：切片返回的是 list 类型，而不是自定义的 vector 类型。</p>
</div>
<p>✏️ 看 getitem</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Vector</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">components</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>  <span class="c1"># 委托给 list 类型的 _components</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>  <span class="c1"># 单纯委托</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="go">v[0]=0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[:]</span>
<span class="go">[0, 1, 2]  # list not vetor</span>
</pre></div>
</div>
</div>
<p><span class="defi">序列类型</span> 。</p>
<div class="mermaid">
            classDiagram
class Container
Container: __contains__ @
class Iterable
Iterable: __iter__ @
class Sized
Sized: __len__ @
class Sequence
Sequence: __getitem__ @
Sequence: __contains__
Sequence: __iter__
Sequence: __reversed__
Sequence: index
Sequence: count
class MutableSequence
MutableSequence: __setitem__ @
MutableSequence: __delitem__ @
MutableSequence: insert/append/extend
MutableSequence: pop/remove
MutableSequence: __iadd__
Container &lt;|-- Sequence
Iterable &lt;|-- Sequence
Sized &lt;|-- Sequence
Sequence &lt;|-- MutableSequence
        </div><div class="line-block">
<div class="line">具体方法和抽象方法是面向对象编程中的两个概念，用于描述类中的方法的特性和行为。</div>
<div class="line"><span class="defi">抽象方法 Abstract Methods</span> 。(后面加 <code class="docutils literal notranslate"><span class="pre">@</span></code> )在类中声明 <strong>但没有具体实现</strong>，它只包含方法的签名（返回类型、方法名和参数列表），没有方法体。<strong>子类必须实现抽象方法</strong>，才能创建对象并调用这个方法。否则就会产生  <code class="docutils literal notranslate"><span class="pre">NotImplentedError</span></code> ，或子类也必须声明为抽象类。</div>
<div class="line"><span class="defi">具体方法Concrete Methods</span> 。在类中实现了具体功能的方法，它 <strong>包含了具体的代码实现</strong>。</div>
</div>
<div class="admonition-sequence-iter admonition note">
<p class="admonition-title">Sequence 抽象方法没有  <code class="docutils literal notranslate"><span class="pre">__iter__</span></code> 。</p>
<p>python 存在一种 <strong>后备机制</strong> ：当有  <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>  时，python 会调用它，传入从 0 开始的整数索引，尝试迭代对象。哪怕是没有  <code class="docutils literal notranslate"><span class="pre">__iter__</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">__contains__</span></code>  python 也会设法使迭代 &amp; in 可用。</p>
</div>
<div class="admonition- admonition note">
<p class="admonition-title">猴子补丁：运行时实现协议。</p>
<div class="admonition-frenchdeck-setitem admonition hint">
<p class="admonition-title">FrenchDeck 类已经定义好了，但是突然想实现可变协议，就是需要添加  <code class="docutils literal notranslate"><span class="pre">__setitem__</span></code> 方法。</p>
</div>
<p>✏️ 在运行时修改修改类或模块，而**不改动源码**。但是关键是要和源码耦合十分紧密（即知道源码，并对上来写</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="c1"># 终端台写</span>
<span class="k">def</span> <span class="nf">set_card</span><span class="p">(</span><span class="n">deck</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">card</span><span class="p">):</span>
    <span class="n">deck</span><span class="o">.</span><span class="n">_card</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span> <span class="o">=</span> <span class="n">card</span>

<span class="hll"><span class="n">FrenchDeck</span><span class="o">.</span><span class="fm">__setitem__</span> <span class="o">=</span> <span class="n">set_card</span>  <span class="c1"># 把函数赋给属性</span>
</span></pre></div>
</div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">module</span>
<span class="n">myclass</span> <span class="o">=</span> <span class="n">module</span><span class="o">.</span><span class="n">MyClass</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="id43">
<h3 id="id43">借口<a class="headerlink" href="#id43" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>导入</dt><dd><p>导入整个模块，再使用句点表示法访问需要的类。需要从一个模块中导入很多类时，最好导入整个模块，并使用  <code class="docutils literal notranslate"><span class="pre">module_name.class_name</span></code>  语法来访问类。</p>
</dd>
</dl>
</li>
</ul>
<p>修改属性的值</p>
<ul class="simple">
<li><p>直接通过实例进行修改</p></li>
<li><p>通过方法进行设置-</p></li>
<li><p>通过方法进行递增（增加特定的值）。</p></li>
</ul>
</section>
<section id="id44">
<h3 id="id44">继承类<a class="headerlink" href="#id44" title="Link to this heading">¶</a></h3>
<p>如果你要编写的类是另一个现成类的特殊版本，可使用继承。一个类继承另一个类时，它将自动获得另一个类的所有属性和方法；</p>
<ul class="simple">
<li><p>原有的类称为父类，父类也称为超类（ <code class="docutils literal notranslate"><span class="pre">superclass</span></code> ）</p></li>
<li><p>新类称为子类。</p></li>
<li><p>子类继承了其父类的所有属性和方法，同时还可以定义自己的属性和方法。</p></li>
</ul>
<section id="id45">
<h4 id="id45">可继承的类<a class="headerlink" href="#id45" title="Link to this heading">¶</a></h4>
<section id="userdict">
<h5 id="userdict">UserDict<a class="headerlink" href="#userdict" title="Link to this heading">¶</a></h5>
<div class="admonition-userdict-dict admonition note">
<p class="admonition-title">更倾向继承 UserDict 而不是 dict</p>
<div class="line-block">
<div class="line">dict 会在某些方法的实现上走一些捷径，如果继承的话，可能需要在子类中重写这些方法。</div>
<div class="line"><span class="defi">UserDict</span> 。把标准 dict 用纯 python 实现了一遍，所以就不会遇到这个问题。</div>
</div>
</div>
<div class="admonition-question admonition hint">
<p class="admonition-title">Question:</p>
<p>UserDict 不是 Dict 的子类，但是 用来给 UserDict 最终存储数据的  <code class="docutils literal notranslate"><span class="pre">UserDict.data</span></code>  属性是 dict 的实例。所以”</p>
</div>
</section>
</section>
</section>
<section id="id46">
<h3 id="id46">魔法方法<a class="headerlink" href="#id46" title="Link to this heading">¶</a></h3>
<div class="line-block">
<div class="line"><span class="defi">magic method 魔法方法 dunder method 双下划线方法</span> 。类似 <strong>前后带双下划线</strong> 的 <code class="docutils literal notranslate"><span class="pre">__method__():</span></code> 内置函数的昵称。在这个方法的名称中，开头和末尾各有两个下划线，这是一种约定，旨在避免Python默认方法与普通方法发生名称冲突。</div>
<div class="line"><strong>工作方式</strong>：当对象接收到一个消息，但在该对象上没有对应的方法时，会自动查找并调用该对象所在类中的特殊方法，从而实现对该消息的处理。</div>
</div>
<div class="admonition-minmaxallmapc admonition hint">
<p class="admonition-title">如min、max、all、map等都是用C语言实现的。运算会更快</p>
</div>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>magic meth</p></th>
<th class="head"><p>call</p></th>
<th class="head"><p>解释</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__abs__(self)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">abs(myclass)</span></code></p></td>
<td><p>取模</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">__bool__(self)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">bool(myclass)</span></code></p></td>
<td rowspan="2"><p>判断真假</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">myclass:</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__call__(self,</span> <span class="pre">*args,</span> <span class="pre">**kwargs):</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">mycalss(params)</span></code></p></td>
<td><p>&lt;u&gt;可调用对象协议&lt;/u&gt; ()操作</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__contains__(self,</span> <span class="pre">a)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">in</span> <span class="pre">myclass</span></code></p></td>
<td><p>包含</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__getitem__(self,</span> <span class="pre">idx):</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">myclass[idx]</span></code></p></td>
<td><p>&lt;u&gt;序列协议&lt;/u&gt;[]操作</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__init__(self,</span> <span class="pre">*args,</span> <span class="pre">**kwargs)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MyClass()</span></code> step2</p></td>
<td><p>初始化实例</p></td>
</tr>
<tr class="row-odd"><td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">__iter__(self)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">iter(myclass)</span></code></p></td>
<td rowspan="2"><p>&lt;u&gt;迭代协议&lt;/u&gt;</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">myclass</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__len__(self)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">len(myclass)</span></code></p></td>
<td><p>长度</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__missing__</span></code></p></td>
<td><p>?</p></td>
<td><p>映射找不到键</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__new__(self)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">MyClass()</span></code>  step1</p></td>
<td><p>新建实例</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">__repr__(self)</span></code></p></td>
<td rowspan="2"><p>&lt;kbd&gt;控制台&lt;/kbd&gt; <code class="docutils literal notranslate"><span class="pre">myclass</span></code></p></td>
<td><p>表达是什么东西</p></td>
</tr>
<tr class="row-odd"><td><p>方便调试和记录日志</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__setitem__(self,</span> <span class="pre">idx,</span> <span class="pre">new):</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">myclass[idx]=new</span></code></p></td>
<td><p>&lt;u&gt;序列类修改&lt;/u&gt;</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__slots__</span></code></p></td>
<td><p>?</p></td>
<td><p>节省内存</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p><code class="docutils literal notranslate"><span class="pre">__str__</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">print(myclass)</span></code></p></td>
<td rowspan="2"><p>对终端用户友好</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">str(myclass)</span></code></p></td>
</tr>
</tbody>
</table>
<p>运算符的重载在它那个章节</p>
<ul>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">__bool__(self)</span></code>  ➡️  <code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">myclass</span></code>  |  <code class="docutils literal notranslate"><span class="pre">bool(myclass)</span></code></dt><dd><div class="line-block">
<div class="line">默认情况下，我们自己定义的类的实例总认为是真，除非这个类对 <code class="docutils literal notranslate"><span class="pre">__bool__</span></code>  |  <code class="docutils literal notranslate"><span class="pre">__len__</span></code>  有自己的实现。</div>
<div class="line">因为这个判断真假会先去搜  <code class="docutils literal notranslate"><span class="pre">__bool__</span></code>  存在吗，如果不存在就会去找  <code class="docutils literal notranslate"><span class="pre">__len__</span></code> 。 <strong>一般默认模为0就是假的</strong></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">__call__(self)</span></code>  ➡️  <code class="docutils literal notranslate"><span class="pre">myclass()</span></code></dt><dd><p>成为可调用对象，也可以作为类方法的快捷方式。</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">func1</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="o">...</span>

<span class="hll">    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="hll">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">func1</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># mycalss() = myclass.func1()</span>
</span></pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">__contains__(self,</span> <span class="pre">a)</span></code> ➡️ <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">in</span> <span class="pre">myclass</span></code></dt><dd><p>如果没有实现， <code class="docutils literal notranslate"><span class="pre">in</span></code>  就会按顺序做迭代搜索</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">__getitem__(self,</span> <span class="pre">idx):</span></code>  ➡️  <code class="docutils literal notranslate"><span class="pre">myclass[idx]</span></code>  &lt;u&gt;[]操作&lt;/u&gt;</dt><dd><p>支持的话, 自动支持切片操作，变成可迭代。</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">__len__(self)</span></code> ➡️  <code class="docutils literal notranslate"><span class="pre">len(myclass)</span></code></dt><dd><p>如果是 python 内置类型，CPython 就会抄近路，实际直接返回 PyObject 里的  <code class="docutils literal notranslate"><span class="pre">ob_size</span></code>  属性.会比调用这个方法更快。</p>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">__missing__</span></code>  映射找不到键</dt><dd><div class="line-block">
<div class="line">所有的映射类型在处理找不到键时，都会牵扯 <code class="docutils literal notranslate"><span class="pre">.__missing__</span></code>  方法。 <code class="docutils literal notranslate"><span class="pre">.__missing__</span></code> 会调用  <code class="docutils literal notranslate"><span class="pre">default_factory</span></code>  里存的可调用对象产生默认值，给  <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>  返回。</div>
<div class="line">基类 dict 没有定义，但是它知道，所以如果某个类继承了 dict，又是实现了  <code class="docutils literal notranslate"><span class="pre">__missing__</span></code>  ，那么在  <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>  找不到键时，python 会自动调用它，而不是抛出  KeyError.</div>
</div>
<div class="admonition-missing-getitem-get-k-contains admonition warning">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">__missing__</span></code>  只会被  <code class="docutils literal notranslate"><span class="pre">__getitem__</span></code>  调用，对  <code class="docutils literal notranslate"><span class="pre">.get(k)</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">__contains__</span></code>  没有影响。所以”</p>
</div>
</dd>
</dl>
</li>
</ul>
<section id="example">
<h4 id="example">Example<a class="headerlink" href="#example" title="Link to this heading">¶</a></h4>
<div class="admonition- admonition hint">
<p class="admonition-title">一叠纸牌</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">FrenchDeck</span><span class="p">():</span>
<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">a</span><span class="p">:</span><span class="nb">int</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_cards</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">a</span><span class="p">))</span>
<span class="hll"><span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">idx</span><span class="p">):</span>
</span>    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cards</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="admonition- admonition hint">
<p class="admonition-title">二维向量</p>
<p>为生成字节序列，将 typecode 转成字节序列，然后迭代实例得到数组，再将数组转成字节序列。</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">sqrt</span>
<span class="k">class</span> <span class="nc">Vector</span><span class="p">():</span>
    <span class="n">typecode</span> <span class="o">=</span> <span class="s1">'d'</span>  <span class="c1"># 类属性，在 Vector 实例 &amp; 字节序列之间转换时使用</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  <span class="c1"># 格式转换 为统一 也为尽早捕捉错误参数</span>
</span>    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># 只有实现可迭代，才能类里的属性拆包 *self</span>
<span class="hll">        <span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">))</span>
</span>    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="hll">        <span class="n">class_name</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span>
</span>        <span class="k">return</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">class_name</span><span class="si">}</span><span class="s1">(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="si">}</span><span class="s1">)'</span>
<span class="hll">    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span>        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
    <span class="k">def</span> <span class="fm">__bytes__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">bytes</span><span class="p">([</span><span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">typecode</span><span class="p">)])</span> <span class="o">+</span> <span class="nb">bytes</span><span class="p">(</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">typecode</span><span class="p">,</span> <span class="bp">self</span><span class="p">)))</span>
    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>  <span class="c1"># 为了快速比较所有分量</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">sqrt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># 换bool 是因为直接的话可能就会返回真的元素那一个值，而不是TF</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
    <span class="k">def</span> <span class="fm">__format__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmt_spec</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">fmt_spec</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>
        <span class="k">return</span> <span class="s1">'(</span><span class="si">{0}</span><span class="s1">, </span><span class="si">{1}</span><span class="s1">)'</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span>
<span class="go">Vector(3.0, 4.0)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>
<span class="go">(3.0, 4.0)</span>
<span class="go">abs(v1)=5.0</span>
<span class="go">bool(v1)=True</span>
<span class="go">abs(v2)=0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bool</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<span class="go">False  # 如果不是重写了bool 实例就会默认为真</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">format</span><span class="p">(</span><span class="n">v1</span><span class="p">)</span>  <span class="c1"># default</span>
<span class="go">'(3.0, 4.0)'  # default</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">format</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="s1">'.3f'</span><span class="p">)</span>
<span class="go">'(3.000, 4.000)'  # 小数点后三位的小数</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">format</span><span class="p">(</span><span class="n">v1</span><span class="p">,</span> <span class="s1">'0.1%'</span><span class="p">)</span>
<span class="go">'(300.0%, 400.0%)'  # 小数点后一位的百分数</span>
</pre></div>
</div>
</div>
<div class="admonition-general admonition hint">
<p class="admonition-title">general 向量</p>
<div class="line-block">
<div class="line">序列类型：不限元素个数，接受可迭代对象</div>
<div class="line">同时用  <code class="docutils literal notranslate"><span class="pre">array</span></code>  存，检查类型</div>
<div class="line">受保护类型</div>
<div class="line">个数太多用  <code class="docutils literal notranslate"><span class="pre">...</span></code>  表示</div>
</div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">array</span> <span class="kn">import</span> <span class="n">array</span>
<span class="kn">import</span> <span class="nn">reprlib</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">numbers</span>
<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">itertools</span>

<span class="k">class</span> <span class="nc">Vector</span><span class="p">():</span>
    <span class="n">type_code</span> <span class="o">=</span> <span class="s1">'d'</span>  <span class="c1"># 什么类型数组</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">components</span><span class="p">):</span>  <span class="c1"># 接受可迭代对象</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_components</span> <span class="o">=</span> <span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_code</span><span class="p">,</span> <span class="n">components</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">)</span>  <span class="c1"># 委托给 array 的实现</span>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="bp">cls</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  <span class="c1"># for init</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="nb">slice</span><span class="p">):</span>  <span class="c1"># 切片</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>  <span class="c1"># 构造序列类型</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">):</span>  <span class="c1"># 单索引</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> indices must be integers'</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">components</span> <span class="o">=</span> <span class="n">reprlib</span><span class="o">.</span><span class="n">repr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">)</span>  <span class="c1"># return str</span>
        <span class="n">components</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span><span class="n">components</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'['</span><span class="p">)</span> <span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># 删去构造细节 array</span>
        <span class="c1"># reprlib.repr(array('d', [1.0, 2.0, 3.0, 4.0, 5.0, 6.0]))</span>
        <span class="c1"># &gt;&gt;&gt; "array('d', [1.0, 2.0, 3.0, 4.0, 5.0, ...])"</span>
        <span class="c1"># 同样的结果有两种方法：1 直接传 array 生成 str + find 2 变成 list 再传，不需要 find</span>
        <span class="c1"># 选第一种是为了减少 生成数组时的复制成本。</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">'Vector(</span><span class="si">{</span><span class="n">components</span><span class="si">}</span><span class="s1">)'</span>  <span class="c1"># 只显示 类型 &amp; 数值</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__bytes__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="nb">bytes</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type_code</span><span class="p">))</span> <span class="o">+</span> <span class="nb">bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">hashes</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">hash</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_components</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">xor</span><span class="p">,</span> <span class="n">hashes</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">all</span> <span class="p">(</span><span class="n">a</span><span class="o">==</span><span class="n">b</span> <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__neg__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">Vector</span><span class="p">(</span><span class="o">-</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__pos__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># return Vector(+x for x in self)  # Wrong</span>
        <span class="k">return</span> <span class="n">Vector</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="n">paris</span> <span class="o">=</span> <span class="n">itertools</span><span class="o">.</span><span class="n">zip_longest</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">,</span> <span class="n">fillvalue</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">Vector</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="n">pairs</span><span class="p">))</span>

    <span class="k">def</span> <span class="fm">__radd__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span> <span class="o">+</span> <span class="n">other</span>  <span class="c1"># 委托给 add 因为数值相加不讲求顺序</span>

    <span class="k">def</span> <span class="fm">__bool__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">all</span> <span class="p">(</span><span class="bp">self</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">])</span>
<span class="go">v=Vector([1.0, 2.0, 3.0, 4.0, 5.0, ...])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v2</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">bool</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">==</span> <span class="n">v2</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Vector</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v</span><span class="p">[</span><span class="s1">'a'</span><span class="p">]</span>
<span class="go">TypeError: Vector indices must be integers</span>
</pre></div>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">__missing__</span></code></div>
<div class="line">当字典里存放的键有英文 &amp; 数字时，为了保持一致性，在存入时希望将所有的键都转成 str。但是在查询的时候，为了方便查询，用数字做键也可以。 <code class="docutils literal notranslate"><span class="pre">d[13]=d['13']</span></code> ，但是存的时候是 str，注定不会找到，所以在  <code class="docutils literal notranslate"><span class="pre">__missing__</span></code>  里进行再转 str 再查询。</div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">UserDict</span>
<span class="k">class</span> <span class="nc">StrKeyDict</span><span class="p">(</span><span class="n">UserDict</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__missing__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>
</pre></div>
</div>
</section>
<section id="init">
<h4 id="init">init<a class="headerlink" href="#init" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">__init__(self,</span> <span class="pre">*args,</span> <span class="pre">**kwargs)</span></code>  ➡️  <code class="docutils literal notranslate"><span class="pre">myclass</span> <span class="pre">=</span> <span class="pre">MyClass(params)</span></code></div>
<div class="line">根据类 <strong>创建新实例</strong> 时，Python都会自动运行它。</div>
<div class="line">不用显式地包含return语句，但Python自动返回一个表示  <code class="docutils literal notranslate"><span class="pre">NewClass</span></code>  的实例</div>
</div>
<div class="admonition- admonition note">
<p class="admonition-title">序列类型的构造最好接受可迭代的对象参数</p>
</div>
<p>创建子类时，父类必须包含在当前文件中，且位于子类前面。子类必须在括号内指定父类的名称</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">super()</span></code>  是一个特殊函数，帮助 Python 将父类和子类关联起来。这行代码让 Python 调用  <code class="docutils literal notranslate"><span class="pre">NewClass</span></code>  的父类的方法 <code class="docutils literal notranslate"><span class="pre">__init__()</span></code> ，让  <code class="docutils literal notranslate"><span class="pre">NewClass</span></code>  实例包含父类的所有属性</p>
<blockquote>
<div><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">SuperClass</span><span class="p">():</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attr1</span> <span class="o">=</span> <span class="n">attr1</span>


<span class="k">def</span> <span class="nf">NewClass</span><span class="p">(</span><span class="n">SuperClass</span><span class="p">):</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">attr1</span><span class="p">,</span> <span class="n">attr2</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">attr1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">attr2</span> <span class="o">=</span> <span class="n">attr2</span>
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
<section id="id47">
<h5 id="id47">私有属性<a class="headerlink" href="#id47" title="Link to this heading">¶</a></h5>
<ol class="arabic simple">
<li><dl class="simple">
<dt>遵循 python 的设定  <code class="docutils literal notranslate"><span class="pre">__</span></code> 两个前导线(尾巴没有或最多一个)标记属性为 <strong>私有的</strong>。</dt><dd><p><span class="defi">名称改写，name mangling</span> 。为了避免意外访问(但是如果用户知道了私有属性也不能防止用户修改。) python 会自动把这种的属性名存入实例的  <code class="docutils literal notranslate"><span class="pre">__dict__</span></code>  属性中，而且会在前面加上”一个下划线+类名“  <code class="docutils literal notranslate"><span class="pre">_MyClass</span></code>  变成  <code class="docutils literal notranslate"><span class="pre">_MyClass__private</span></code> 。</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>遵循私下约定俗成的设定  <code class="docutils literal notranslate"><span class="pre">_</span></code> 一个前导线。标记为 <strong>受保护的</strong></dt><dd><p>python 不会对这种的属性进行特殊处理。</p>
</dd>
</dl>
</li>
</ol>
<div class="admonition- admonition warning">
<p class="admonition-title">其实不能实现真正的私有和不可变。</p>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Vector</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__x</span> <span class="o">=</span> <span class="n">x</span>  <span class="c1"># 两个下划线标记为 私有属性</span>
<span class="hll">        <span class="bp">self</span><span class="o">.</span><span class="n">__y</span> <span class="o">=</span> <span class="n">y</span>
</span>
    <span class="nd">@property</span>  <span class="c1"># 把读值方法标记为特性</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># 读值方法名称 x(self) =&gt; 公开属性 self.x</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__x</span>

<span class="hll">    <span class="nd">@property</span>
</span>    <span class="k">def</span> <span class="nf">yy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># 读值方法名称 yy(self) =&gt; 公开属性 self.yy</span>
<span class="hll">        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__y</span>
</span></pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span><span class="o">.</span><span class="vm">__dict__</span>
<span class="go">{'_Vector__x': 1, '_Vector__y': 1}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">v1</span><span class="o">.</span><span class="n">_Vector__x</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># 知道之后故意修改</span>
<span class="go">v1 = (2, 1)</span>
</pre></div>
</div>
</section>
</section>
<section id="call">
<h4 id="call">call<a class="headerlink" href="#call" title="Link to this heading">¶</a></h4>
<div class="admonition-call admonition note">
<p class="admonition-title">对象也可以成为函数类对象。实现  <code class="docutils literal notranslate"><span class="pre">__call__</span></code></p>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">NormClass</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>

<span class="k">class</span> <span class="nc">FuncClass</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="hll">    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span>        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">norm</span><span class="p">,</span> <span class="n">func</span> <span class="o">=</span> <span class="n">NormClass</span><span class="p">(),</span> <span class="n">FuncClass</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="go">norm.a = norm.b =1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">callable</span><span class="p">(</span><span class="n">nor</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">callable</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">func</span><span class="p">()</span>
<span class="go">func.a =2</span>
</pre></div>
</div>
</section>
<section id="getitem">
<h4 id="getitem">getitem<a class="headerlink" href="#getitem" title="Link to this heading">¶</a></h4>
<p><span class="defi">切片 slice</span> 。</p>
<p>如果切片传入不合格：一般返回  <code class="docutils literal notranslate"><span class="pre">msg</span> <span class="pre">=</span> <span class="pre">f'{cls.__name__}</span> <span class="pre">indices</span> <span class="pre">must</span> <span class="pre">be</span> <span class="pre">integers'</span></code></p>
<div class="admonition- admonition warning">
<p class="admonition-title">如果单个索引，就会返回一个元素， <strong>元素类型</strong> 。</p>
<div class="line-block">
<div class="line">一般切片之后，返回一个子序列， <strong>序列的类型</strong>”</div>
<div class="line">如果有底层序列类型，可以委托，但不能单纯委托给具有序列协议的属性，需要 额外处理一下</div>
<div class="line">如果没有底层的序列类型，可以用  <code class="docutils literal notranslate"><span class="pre">slice</span></code>  进行操作。（参见向量类型）</div>
</div>
</div>
<div class="admonition- admonition note">
<p class="admonition-title">切片原理</p>
<div class="line-block">
<div class="line">单个切片返回  <code class="docutils literal notranslate"><span class="pre">silce(start,</span> <span class="pre">stop,</span> <span class="pre">step)</span></code> ; 多个切片(有  <code class="docutils literal notranslate"><span class="pre">,</span></code>  )返回  <code class="docutils literal notranslate"><span class="pre">tuple(slice)</span></code></div>
<div class="line"><span class="defi">slice</span> 。内置类。有个属性  <code class="docutils literal notranslate"><span class="pre">.indices(len)-&gt;(start,</span> <span class="pre">stop,</span> <span class="pre">stride)</span></code>  给定长度 len 的序列，计算 S 表示的扩展切片的起始 &amp; 结尾 &amp; 步伐，使其不超出列表序列长度&amp;转换负数。</div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Seq</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__getitem__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">index</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">Seq</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="hll"><span class="go">s[1] =1 单索引就是想要的索引</span>
</span><span class="hll"><span class="go">s[:]=slice(None, None, None)</span>
</span><span class="hll"><span class="go">s[1:4:2]=slice(1, 4, 2)</span>
</span><span class="go">s[1:4, 9]=(slice(1, 4, None), 9)</span>
<span class="go">s[1:4, 5:7]=(slice(1, 4, None), slice(5, 7, None))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">slice</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">indices</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go">(2, 5, 1)</span>
</pre></div>
</div>
</div>
<p><span class="defi">动态存取</span> 。</p>
<p>如果序列里有太多分量，为了方便访问，通过单字母访问前几个分量。</p>
<p>属性查找失败后，解释器会调用</p>
</section>
<section id="setitem">
<h4 id="setitem">setitem<a class="headerlink" href="#setitem" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">__setitem__(self,</span> <span class="pre">idx,</span> <span class="pre">new):</span></code>  ➡️  <code class="docutils literal notranslate"><span class="pre">myclass[idx]=new</span></code>  &lt;u&gt;[]修改&lt;/u&gt;</div>
<div class="line">在不破坏类的封装性的同时，对序列类进行修改。</div>
</div>
<p>随机打乱 shuffle 需要调转序列中元素的位置，即**可变协议**，需要 <code class="docutils literal notranslate"><span class="pre">__setitem__</span></code></p>
</section>
<section id="iterableobject">
<h4 id="iterableobject">IterableObject 可迭代对象<a class="headerlink" href="#iterableobject" title="Link to this heading">¶</a></h4>
<div class="line-block">
<div class="line">如果我们可以从中获取迭代器，则该对象称为 iterable 的。</div>
<div class="line">只要对象是可迭代的, 就可以执行:defi:<cite>分解操作</cite></div>
</div>
<p><strong>IterableObject</strong> 必须实现两个特殊meth:</p>
<ol class="arabic">
<li><p>支持协议（二选一满足即可）
- 迭代协议，iteration protocol， <code class="docutils literal notranslate"><span class="pre">__iter__(self)</span></code>   并返回 <code class="docutils literal notranslate"><span class="pre">self</span></code>
- 序列协议，sequence protocol  <code class="docutils literal notranslate"><span class="pre">__getitem__()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">__next</span> <span class="pre">__(self)</span></code> , 逐个访问容器中的元素。</p>
<div class="admonition-stopiteration admonition danger">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">StopIteration</span></code>  异常</p>
<p>超出范围</p>
</div>
</li>
</ol>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Users</span><span class="p">:</span>
<span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>

<span class="hll"><span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="w">    </span><span class="sd">"""</span>
<span class="sd">    #@summary: 初始化一个迭代器对象</span>
<span class="sd">    #@call: iter(users)</span>
<span class="sd">    通常只会返回self，它持有当前实例</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="bp">self</span>

<span class="hll"><span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span class="w">    </span><span class="sd">"""</span>
<span class="sd">    #@summary: 逐个访问容器中的元素.</span>
<span class="sd">    #@call: next(Iterator)</span>
<span class="sd">    # for循环调用该方法，不断访问下一个，当没有的时候会 StopIteration Error</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">):</span>
    <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">index</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">value</span>
    <span class="k">else</span><span class="p">:</span>
    <span class="k">raise</span> <span class="ne">StopIteration</span>
    <span class="o">...</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">users</span> <span class="o">=</span> <span class="n">Users</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">users_iterator</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">users</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">user</span> <span class="ow">in</span> <span class="n">users_iterator</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="o">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">users_iterator</span><span class="p">)):</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">user</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">users_iterator</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition- admonition warning">
<p class="admonition-title">可迭代对象的赋值</p>
<p>不需要或者不定量的时候,  <code class="docutils literal notranslate"><span class="pre">*variables</span></code> 可在开头也可在结尾</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="o">*</span><span class="n">dontneed</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">lst</span>
<span class="go">dontneed=[1, 2], a=3, b=4</span>
</pre></div>
</div>
</div>
</section>
<section id="id48">
<h4 id="id48">字符串表现形式<a class="headerlink" href="#id48" title="Link to this heading">¶</a></h4>
<p><span class="defi">字符串表现形式</span> 。把一个对象用字符串的形式&lt;u&gt;表达出来&lt;/u&gt;。返回的应该是&lt;u&gt;字符串&lt;/u&gt;。</p>
<ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">__repr__(self)</span></code>  ↔️ &lt;kbd&gt;控制台&lt;/kbd&gt; <code class="docutils literal notranslate"><span class="pre">myclass</span></code>   |  <code class="docutils literal notranslate"><span class="pre">repr(myclass)</span></code></dt><dd><p>便于 <strong>开发者</strong> 理解。返回的字符串应该准确、无歧义、并且尽可能表达出如何用这个代码创建出这个被打印的对象。方便调试和记录日志</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">__str__(self)</span></code>  ↔️  <code class="docutils literal notranslate"><span class="pre">print(myclass)</span></code>  |  <code class="docutils literal notranslate"><span class="pre">str(myclass)</span></code></dt><dd><p>便于 <strong>用户</strong> 理解。</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">__bytes__(self)</span></code>  ↔️  <code class="docutils literal notranslate"><span class="pre">bytes()</span></code></dt><dd><p>获取对象的 <strong>字节序列</strong> 表现形式。</p>
</dd>
</dl>
</li>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">__format__(self,</span> <span class="pre">format_spec)</span></code>  ↔️  <code class="docutils literal notranslate"><span class="pre">format(obj,</span> <span class="pre">format_spec)</span></code>  |  <code class="docutils literal notranslate"><span class="pre">str.format()</span></code></dt><dd><div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">format_spec</span></code>  格式说明符号  <code class="docutils literal notranslate"><span class="pre">'.4f'</span></code></div>
<div class="line">使用 <strong>特殊的格式</strong> 显示对象的字符串表现形式。</div>
<div class="line">如果没有定义 <code class="docutils literal notranslate"><span class="pre">__format__</span></code> ,  <code class="docutils literal notranslate"><span class="pre">format()</span></code>  会找 <code class="docutils literal notranslate"><span class="pre">__str__</span></code> ，但不能传入 format_spec，否则就会  <code class="docutils literal notranslate"><span class="pre">TypeError</span></code></div>
</div>
</dd>
</dl>
</li>
</ul>
<div class="admonition-repr-str-repr admonition note">
<p class="admonition-title">如果非要二者选其一来实现， <code class="docutils literal notranslate"><span class="pre">__repr__</span></code>  是更好的选择。因为当没有  <code class="docutils literal notranslate"><span class="pre">__str__</span></code>  时， 解释器会找  <code class="docutils literal notranslate"><span class="pre">__repr__</span></code> “</p>
</div>
<div class="admonition-defi-format-spec admonition note">
<p class="admonition-title"><span class="defi">格式规范微语言 format_spec</span> 。指导格式的字符串。</p>
<div class="line-block">
<div class="line">int ： <code class="docutils literal notranslate"><span class="pre">bedoxXn</span></code>  ; float： <code class="docutils literal notranslate"><span class="pre">eEfFgGcn</span></code> ； str： <code class="docutils literal notranslate"><span class="pre">s</span></code></div>
<div class="line">自定义格式代码尽量避免使用已有的，而不至于使别的读者困惑。</div>
</div>
<div class="admonition-notes admonition hint">
<p class="admonition-title">notes</p>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">'b'</span></code>  二进制 int &amp;  <code class="docutils literal notranslate"><span class="pre">'x'</span></code>  十六进制 int</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">'f'</span></code>  小数形式 float  <code class="docutils literal notranslate"><span class="pre">'.4f'</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">'%'</span></code>  百分数形式 float</div>
</div>
</div>
</div>
<div class="admonition- admonition note">
<p class="admonition-title">关于显示上</p>
<ul>
<li><dl>
<dt>如果分量太多，考虑用  <code class="docutils literal notranslate"><span class="pre">...</span></code>  表示截断部分，而不需要展开很多的数据占据视窗，同时提醒不止展现这几行.</dt><dd><p><code class="docutils literal notranslate"><span class="pre">reprlib.repr(data)</span></code>  超过6个元素，用省略号代替。用于生成大型结构或递归结构的 <strong>安全表现形式</strong>，限制字符串输出长度。</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">reprlib</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reprlib</span><span class="o">.</span><span class="n">repr</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">])</span>
<span class="go">'[1, 2, 3, 4, 5, 6, ...]'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reprlib</span><span class="o">.</span><span class="n">repr</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="go">'[1, 2, 3]'</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>重点是在对象，而不是构造细节。在显示上可以简化，只出现内容。</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Vector(1,</span> <span class="pre">2)</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">Vector(array('d',</span> <span class="pre">[1,</span> <span class="pre">2]))</span></code>  array 是实现细节，不需要展示以免复杂。</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="admonition- admonition hint">
<p class="admonition-title">二维向量</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Vector</span><span class="p">():</span>
    <span class="o">...</span>
    <span class="k">def</span> <span class="fm">__abs__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">""" 模 """</span>
    <span class="k">def</span> <span class="nf">__angle__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">""" 角度 """</span>
    <span class="k">def</span> <span class="fm">__format__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fmt_spec</span><span class="o">=</span><span class="s1">''</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">fmt_spc</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">'p'</span><span class="p">):</span>  <span class="c1"># 极坐标</span>
            <span class="n">fmt_spec</span> <span class="o">=</span> <span class="n">fmt_spec</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">angle</span><span class="p">())</span>
            <span class="n">outer_fmt</span> <span class="o">=</span> <span class="s1">'&lt;</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">&gt;'</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># 直角坐标</span>
            <span class="n">coords</span> <span class="o">=</span> <span class="bp">self</span>
            <span class="n">outer_fmt</span> <span class="o">=</span> <span class="s1">'(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)'</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="nb">format</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">fmt_spec</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">coords</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">outer_fmt</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">v</span> <span class="o">=</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">format</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">'.3ep'</span><span class="p">)</span>
<span class="go">'&lt;1.414e+00, 7.854e-01&gt;'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">format</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="s1">'.5fp'</span><span class="p">)</span>
<span class="go">'&lt;1.41421, 0.78540&gt;'</span>
</pre></div>
</div>
</div>
</section>
<section id="id49">
<h4 id="id49">重载运算符<a class="headerlink" href="#id49" title="Link to this heading">¶</a></h4>
<p>重载运算符是为了让自定义对象使用 中缀运算符  <code class="docutils literal notranslate"><span class="pre">+</span> <span class="pre">|</span></code>  &amp; 一元运算符  <code class="docutils literal notranslate"><span class="pre">-</span> <span class="pre">~</span></code></p>
<div class="admonition- admonition note">
<p class="admonition-title">中缀运算符的基本原则是 <strong>创建并返回类型合适的一个新的对象，而不改变操作对象本身</strong> 。只有增量赋值可能修改第一个操作对象</p>
<div class="line-block">
<div class="line">不能重载内置类型的运算符</div>
<div class="line">不能新建运算符，只能重载。</div>
<div class="line">不能重载  <code class="docutils literal notranslate"><span class="pre">is</span> <span class="pre">and</span> <span class="pre">or</span> <span class="pre">not</span></code></div>
<div class="line">当序列进行按元素运算，要处理序列 <strong>长度不一的情况</strong>。（迭代多个可迭代对象 <code class="docutils literal notranslate"><span class="pre">itertools.zip_longest(..,</span> <span class="pre">fillvalue=None)</span></code> ）</div>
</div>
</div>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>magic</p></th>
<th class="head"><p>运算符</p></th>
<th class="head"><p>meaning</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__add__(self,</span> <span class="pre">other)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a+b</span></code></p></td>
<td><p>相加 序列一般 <strong>拼接</strong></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__mul__(self,</span> <span class="pre">other)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">a*b</span></code></p></td>
<td><p>标量积相乘 序列一般 <strong>复制</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__neg__(self)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">-a</span></code></p></td>
<td><p>一元取反</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">__pos__(self)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">+a</span></code></p></td>
<td><p>一元取正 通常  <code class="docutils literal notranslate"><span class="pre">x==+x</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">__invert__(self)</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">~a</span></code></p></td>
<td><p>对整数按位取反</p></td>
</tr>
</tbody>
</table>
<div class="admonition-i admonition note">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">i</span></code>  就地运算，增量赋值可能修改第一个操作对象</p>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">r</span></code>  反向运算，右位</dt><dd><p><code class="docutils literal notranslate"><span class="pre">__radd___</span></code>  是  <code class="docutils literal notranslate"><span class="pre">__add__</span></code>  的 反射 reflected | 反向 reversed</p>
<div class="admonition-add-a-b-a-b-iadd-a-b-a-b-radd-a-b-b-a admonition hint">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">__add__(a,b)</span> <span class="pre">=</span> <span class="pre">a+b</span></code>  左位 &amp;  <code class="docutils literal notranslate"><span class="pre">__iadd__(a,b)=</span> <span class="pre">a+=b</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">__radd__(a,b)</span> <span class="pre">=</span> <span class="pre">b+a</span></code>  右位</p>
</div>
</dd>
</dl>
</div>
<p>特殊的分配机制。</p>
<img alt="../_images/operate_1.jpeg" src="../_images/operate_1.jpeg"/>
<p>算  <code class="docutils literal notranslate"><span class="pre">a+b</span></code> ，a左b右。先找 a 有没有左加b(1.有没有左加；2.能不能左加b)，不能的话再找b有没有右加a(1.有没有右加；2.能不能右加a)</p>
<div class="admonition-notes admonition note">
<p class="admonition-title">notes</p>
<p><code class="docutils literal notranslate"><span class="pre">x==+x</span></code>  的特殊情况:当精度不一样的时候会  <code class="docutils literal notranslate"><span class="pre">False</span></code></p>
</div>
</section>
<section id="hash">
<h4 id="hash">hash<a class="headerlink" href="#hash" title="Link to this heading">¶</a></h4>
<div class="admonition-notes admonition note">
<p class="admonition-title">notes</p>
<p><span class="defi">可散列类型 hashable</span> 。如果一个对象是可散列的，那么在这个对象 <strong>生命周期</strong> 中，它的散列值是不变的，而且这个对象需要实现  <code class="docutils literal notranslate"><span class="pre">.__hash__()</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">.__eq__()</span></code>  。因为 <code class="docutils literal notranslate"><span class="pre">hash()</span></code>  方法可以作用于对象上，并且如果两个可散列的对象是相等，那么散列值一定是一样。</p>
</div>
<div class="line-block">
<div class="line"><strong>目的</strong>：</div>
<div class="line">对象不可修改。将自定义类里的  <code class="docutils literal notranslate"><span class="pre">__init__</span></code>  里的元素设为&lt;u&gt;只读模式&lt;/u&gt;</div>
<div class="line">散列值唯一。推荐使用位运算符异或  <code class="docutils literal notranslate"><span class="pre">^</span></code>  混合个分量的散列值</div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">__</span></code></p></li>
</ol>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Vector</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__x</span> <span class="o">=</span> <span class="n">x</span>  <span class="c1"># 两个下划线标记为 私有属性</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__y</span> <span class="o">=</span> <span class="n">y</span>

    <span class="nd">@property</span>  <span class="c1"># 把读值方法标记为特性</span>
    <span class="k">def</span> <span class="nf">x</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># 读值方法名称 x(self) =&gt; 公开属性 self.x</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__x</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">yy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># 读值方法名称 yy(self) =&gt; 公开属性 self.yy</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__y</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yy</span><span class="p">))</span>

<span class="hll">    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># 异或 '^' 混合个分量的散列值</span>
</span>        <span class="k">return</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">^</span> <span class="nb">hash</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">yy</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">==</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">'(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">yy</span><span class="si">}</span><span class="s1">)'</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">set</span><span class="p">([</span><span class="n">Vector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">Vector</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)])</span>
<span class="go">{(1, 1), (1, 2)}</span>
</pre></div>
</div>
</section>
<section id="id50">
<h4 id="id50">一些优化<a class="headerlink" href="#id50" title="Link to this heading">¶</a></h4>
<div class="admonition-numpy admonition note">
<p class="admonition-title">如果数百万个数值，使用 numpy</p>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">__slots__</span></code>  节省空间，建议储存数百万（而不是几千）使用，而且内存严重不足时。</div>
<div class="line">为提高访问速度，python 在实例中将属性存进 <strong>dict</strong>，但消耗大量内存。使用  <code class="docutils literal notranslate"><span class="pre">__slots__</span></code> ，python 在实例中将属性存进 <strong>tuple</strong>， 节省内存。（有点像 namedtuple，告诉 python 这个类中所有的实例属性都在这里）</div>
</div>
<div class="admonition-slots-slots admonition warning">
<p class="admonition-title">【副作用】在类中定义了  <code class="docutils literal notranslate"><span class="pre">__slots__</span></code>  外，实例中不允许  <code class="docutils literal notranslate"><span class="pre">__slots__</span></code>  存储名称以外的属性。</p>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Vector</span><span class="p">():</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">'x'</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">)</span>  <span class="c1"># 由字符串组成的可迭代对象，各个元素表示属性</span>
    <span class="c1"># __slots__ = ('__x', '__y')</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="o">...</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="id51">
<h2 id="id51">重写<a class="headerlink" href="#id51" title="Link to this heading">¶</a></h2>
<p>对于父类的方法，只要它不符合子类模拟的实物的行为，都可对其进行重写。为此，可在子类中定义一个这样的方法，即它与要重写的父类方法同名。这样，Python将不会考虑这个父类方法，而只关注你在子类中定义的相应方法</p>
</section>
<section id="re">
<h2 id="re">Re<a class="headerlink" href="#re" title="Link to this heading">¶</a></h2>
<ul>
<li><dl>
<dt><code class="docutils literal notranslate"><span class="pre">flags=0</span></code>  用于控制正则表达式的匹配方式，如：是否区分大小写，多行匹配等等</dt><dd><ul class="simple">
<li><p>re.I 忽略大小写</p></li>
<li><p>re.X 为了增加可读性，忽略规则表达式中的空白和注释，并允许使用 ’#’ 来引导一个注释。这样可以让你把规则写得更美观些。</p></li>
</ul>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>symbol</p></th>
<th class="head"><p>meaning</p></th>
<th class="head"><p>special usage</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">\D</span></code></p></td>
<td><p>任何非十进制数字的字符</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">re.sub(r'\D',</span> <span class="pre">'',</span> <span class="pre">string)</span></code>  只保留十进制数字</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">[0-9-]+</span></code></p></td>
<td><p>0-9 还有 <code class="docutils literal notranslate"><span class="pre">-</span></code> 号,  <code class="docutils literal notranslate"><span class="pre">+</span></code> ：不止一个</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">re.match('[0-9-]+',</span> <span class="pre">string)</span></code>  提取的仅包含数字和-的电话号码</p></td>
</tr>
</tbody>
</table>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">re.match(pattern,</span> <span class="pre">string,</span> <span class="pre">flags=0)</span></code></dt><dd><ul class="simple">
<li><p>从字符串的**起始位置**匹配一个模式</p></li>
<li><dl class="simple">
<dt>成功  <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">&lt;re.Match</span> <span class="pre">object;</span> <span class="pre">span=(0,</span> <span class="pre">end_idx),</span> <span class="pre">match=pattern&gt;</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;re.Match</span> <span class="pre">object&gt;.group()</span></code>  返回正则匹配的字符串</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;re.Match</span> <span class="pre">object&gt;.start()</span></code> ,  <code class="docutils literal notranslate"><span class="pre">&lt;re.Match</span> <span class="pre">object&gt;.end()</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&lt;re.Match</span> <span class="pre">object&gt;.span()</span></code> : (start, end)</p></li>
<li><p>不是起始位置匹配成功  <code class="docutils literal notranslate"><span class="pre">return</span> <span class="pre">None</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">re.sub(pattern,</span> <span class="pre">repl,</span> <span class="pre">string,</span> <span class="pre">count=0,</span> <span class="pre">flags=0)</span></code></dt><dd><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">count=0</span></code> : 模式匹配后替换的最大次数，默认 0 表示替换所有的匹配。</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="id52">
<h2 id="id52">用户交互<a class="headerlink" href="#id52" title="Link to this heading">¶</a></h2>
<section id="input">
<h3 id="input">Input<a class="headerlink" href="#input" title="Link to this heading">¶</a></h3>
<div class="admonition-input admonition danger">
<p class="admonition-title">input 接收后字符串性质</p>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">'plz input a number:'</span><span class="p">)</span>
<span class="go">plz input a number: 9</span>
<span class="go">a = '9'</span>
</pre></div>
</div>
<section id="id53">
<h4 id="id53">读照片<a class="headerlink" href="#id53" title="Link to this heading">¶</a></h4>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">image_path</span><span class="p">)</span> <span class="c1"># PIL.....</span>
</pre></div>
</div>
</section>
</section>
<section id="output">
<h3 id="output">output  格式化输出<a class="headerlink" href="#output" title="Link to this heading">¶</a></h3>
<ul>
<li><p>print</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">end</span> <span class="pre">=</span> <span class="pre">'\n'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sep</span> <span class="pre">=</span> <span class="pre">''</span></code></p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">"aaaa"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">''</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">"bbbb"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">'&amp;'</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">"cccc"</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">'@'</span><span class="p">)</span>
<span class="go">aaaabbbb&amp;cccc@</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">'a'</span><span class="p">,</span> <span class="s1">'b'</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">'__'</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="s1">'@'</span><span class="p">)</span>
<span class="go">a__b@</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>str.format</p></li>
<li><dl class="simple">
<dt>f-string</dt><dd><p>Python3.6 新增了一种 f-字符串格式化，也可以写成print(f”训练数据集的长度为:{train_data_size}”)</p>
</dd>
</dl>
</li>
</ul>
</section>
</section>
<section id="id54">
<h2 id="id54">读写文件<a class="headerlink" href="#id54" title="Link to this heading">¶</a></h2>
<section id="id55">
<h3 id="id55">文件路径<a class="headerlink" href="#id55" title="Link to this heading">¶</a></h3>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="n">files_lst</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="s1">'dirctory_path'</span><span class="p">)</span>
</pre></div>
</div>
<p>文件内容分类</p>
<p>文件操作分类</p>
<table>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">r</span></code> 只读</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">w</span></code> 只写</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">a</span></code> 只追加写</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">+</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>文件不存在</p></td>
<td><p>❌</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>指针</p></td>
<td><p>开头</p></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="admonition- admonition danger">
<p class="admonition-title">留意指针</p>
<p>写完再读就会读不出东西</p>
</div>
</section>
<section id="txt">
<h3 id="txt">txt<a class="headerlink" href="#txt" title="Link to this heading">¶</a></h3>
<p>read(), readline(), readlines()</p>
<table>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">read(limit)</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">readline()</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">readlines()</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td></td>
<td><p>limit:int 限制读的内存字节</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">readline()</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">readlines()</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>读取</p></td>
<td><p>全部</p></td>
<td><p>逐行</p></td>
<td><p>全部</p></td>
</tr>
<tr class="row-even"><td><p>返回</p></td>
<td><p>str</p></td>
<td><p>str</p></td>
<td><p>list</p></td>
</tr>
<tr class="row-odd"><td><p>每一行分离</p></td>
<td><p>❌</p></td>
<td><p>✔</p></td>
<td><p>✔</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>notes</p></td>
<td><p>全部读取的需要考虑内存</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">readlines()</span></code> 比 <code class="docutils literal notranslate"><span class="pre">readline()</span></code> 快</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<div class="literal-block-wrapper docutils container" id="id61">
<div class="code-block-caption"><span class="caption-text">1.txt</span><a class="headerlink" href="#id61" title="Link to this code">¶</a></div>
<div class="highlight-None notranslate"><div class="highlight"><pre><span></span>aaa
bbb
这是个空行
</pre></div>
</div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'1.txt'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">res</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>  <span class="c1"># 读全部</span>
<span class="go">'aaa\nbbb\n\n'</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'1.txt'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="n">line</span> <span class="o">=</span>  <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>  <span class="c1"># 第一行</span>
<span class="gp">&gt;&gt;&gt; </span>   <span class="k">while</span> <span class="n">line</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">line</span> <span class="o">!=</span> <span class="s1">''</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">line</span> <span class="o">=</span>  <span class="n">f</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>  <span class="c1"># 逐行读取</span>
<span class="go">['aaa\n', 'bbb\n', '\n']</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'1.txt'</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">res</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="go">['aaa\n', 'bbb\n', '\n']</span>
</pre></div>
</div>
</section>
<section id="json">
<h3 id="json">json<a class="headerlink" href="#json" title="Link to this heading">¶</a></h3>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">json_path</span><span class="p">,</span> <span class="s1">'r'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data_dict</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">FileNotFoundError</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">json_path</span><span class="si">}</span><span class="s1"> doesnt exist.'</span><span class="p">)</span>
    <span class="k">return</span> <span class="s1">''</span>

<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'./built-in.json'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">'utf-8'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id56">
<h3 id="id56">快速序列<a class="headerlink" href="#id56" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">pickle</span></code></dt><dd><p>快速序列化数字类型。可以处理几乎所有的类型。</p>
</dd>
</dl>
</li>
</ul>
</section>
</section>
<section id="id57">
<h2 id="id57">测试<a class="headerlink" href="#id57" title="Link to this heading">¶</a></h2>
<section id="id58">
<h3 id="id58">时间<a class="headerlink" href="#id58" title="Link to this heading">¶</a></h3>
<p>简单感觉时间可用time，但是对优化来说，得看quota，看哪部分占比比较明显，如果是那些外调的函数比较明显的话，那也木有办法。</p>
<div class="admonition-load admonition warning">
<p class="admonition-title">加载模型尽量在外部一次加载，load是比较慢的，不要每次调每次都加载。</p>
</div>
<section id="time">
<h4 id="time">time<a class="headerlink" href="#time" title="Link to this heading">¶</a></h4>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">main</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span><span class="o">-</span><span class="n">start</span><span class="p">)</span>  <span class="c1"># 秒</span>
</pre></div>
</div>
</section>
<section id="cprofile-pstats">
<h4 id="cprofile-pstats"><code class="docutils literal notranslate"><span class="pre">cProfile</span></code>  +  <code class="docutils literal notranslate"><span class="pre">pstats</span></code><a class="headerlink" href="#cprofile-pstats" title="Link to this heading">¶</a></h4>
<table>
<thead>
<tr class="row-odd"><th class="head"><p><code class="docutils literal notranslate"><span class="pre">cProfile</span></code>  结果列</p></th>
<th class="head"><p>意思</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ncalls</p></td>
<td><p>调用次数</p></td>
</tr>
<tr class="row-odd"><td><p>tottime</p></td>
<td><p>在指定函数中消耗的总时间&lt;u&gt;（不包括调用子函数的时间）&lt;/u&gt;</p></td>
</tr>
<tr class="row-even"><td><p>percall</p></td>
<td><p>= tottime / ncalls</p></td>
</tr>
<tr class="row-odd"><td><p>cumtime</p></td>
<td><p>指定的函数&lt;u&gt;及其所有子函数&lt;/u&gt;（从调用到退出）消耗的总时间。</p></td>
</tr>
<tr class="row-even"><td><p>percall</p></td>
<td><p>= cumtime / ncalls, 函数运行一次的平均时间</p></td>
</tr>
<tr class="row-odd"><td><p>filename</p></td>
<td><p>函数名</p></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr class="row-odd"><th class="head"><p><code class="docutils literal notranslate"><span class="pre">pstats</span></code>  函数</p></th>
<th class="head"><p>意思</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>strip_dirs()</p></td>
<td><p>移除了所有模块名称中的多余路径</p></td>
</tr>
<tr class="row-odd"><td><p>sort_stats(key)</p></td>
<td><p>对key列 <span class="defi">降序</span> 排序</p></td>
</tr>
<tr class="row-even"><td><p>print_stats(n)</p></td>
<td><p>打印统计数据 , default n = all</p></td>
</tr>
<tr class="row-odd"><td><p>print_callers(n)</p></td>
<td><p>每个被列出的函数的调用方列表 , default n = all</p></td>
</tr>
</tbody>
</table>
<ol class="arabic">
<li><p>step1</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id62">
<div class="code-block-caption"><span class="caption-text">main.py</span><a class="headerlink" href="#id62" title="Link to this code">¶</a></div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
    <span class="k">pass</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">rang</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div></blockquote>
</li>
<li><p>&lt;kbd&gt;python -m cProfile -o output_file main.py&lt;/kbd&gt;</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-o</span></code>  将结果写入文件</p></li>
</ul>
</li>
<li><p>step3</p>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id63">
<div class="code-block-caption"><span class="caption-text">analysis.py</span><a class="headerlink" href="#id63" title="Link to this code">¶</a></div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pstats</span>
<span class="kn">from</span> <span class="nn">pstats</span> <span class="kn">import</span> <span class="n">SortKey</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">pstats</span><span class="o">.</span><span class="n">Stats</span><span class="p">(</span><span class="s1">'./output_file'</span><span class="p">)</span>

<span class="c1"># 按一个函数中的累计时间对性能分析数据进行排序,打印多的30行</span>
<span class="n">p</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="n">SortKey</span><span class="o">.</span><span class="n">CUMULATIVE</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
<span class="c1"># 每个函数耗费的时间进行排序，然后打印前十个函数的统计数据</span>
<span class="n">p</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="n">SortKey</span><span class="o">.</span><span class="n">TIME</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># 以时间为主键，并以累计时间为次键进行排序，然后打印10条</span>
<span class="n">p</span><span class="o">.</span><span class="n">sort_stats</span><span class="p">(</span><span class="n">SortKey</span><span class="o">.</span><span class="n">TIME</span><span class="p">,</span> <span class="n">SortKey</span><span class="o">.</span><span class="n">CUMULATIVE</span><span class="p">)</span><span class="o">.</span><span class="n">print_stats</span><span class="p">(</span><span class="mf">.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div></blockquote>
</li>
</ol>
</section>
</section>
</section>
<section id="error">
<h2 id="error">Error<a class="headerlink" href="#error" title="Link to this heading">¶</a></h2>
<div class="mermaid">
            flowchart LR
try --No_error--&gt; else --&gt; finally
try --except有的error--&gt; except --&gt; finally
try --except没有的error --&gt;A{报错} --&gt; finally
        </div><div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">numb</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">OverflowError</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'</span><span class="si">{</span><span class="n">a</span><span class="si">}</span><span class="s1"> is not valid'</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="k">finally</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"It is over."</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">numb</span><span class="p">(</span><span class="mf">2.1</span><span class="p">)</span>
<span class="go">2</span>
<span class="go">It is over.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">numb</span><span class="p">(</span><span class="s1">'a'</span><span class="p">)</span>
<span class="go">a is not valid</span>
<span class="go">It is over.</span>
</pre></div>
</div>
<div class="admonition-notimplementederror admonition danger">
<p class="admonition-title">NotImplementedError 未实现父类接口重写</p>
<div class="line-block">
<div class="line">在继承的时候，父类有可能留下接口需要子类去重写，但子类并没有重写.</div>
<div class="line"><span class="defi">Sol</span> : 重写方法</div>
</div>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Parent</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">talk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">rasie</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">"没有重写talk方法"</span><span class="p">)</span>  <span class="c1"># 实现原理</span>

<span class="k">class</span> <span class="nc">Children</span><span class="p">(</span><span class="n">Parent</span><span class="p">):</span>
    <span class="k">pass</span>

<span class="k">class</span> <span class="nc">TrueChildren</span><span class="p">(</span><span class="n">Parent</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">talk</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"aaaaa"</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">Children</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="o">.</span><span class="n">talk</span><span class="p">()</span>
<span class="go">NotImplementedError: 没有重写talk方法</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">TrueChildren</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">talk</span><span class="p">()</span>
<span class="go">aaaaa</span>
</pre></div>
</div>
</div>
<section id="id59">
<h3 id="id59">字符串相关<a class="headerlink" href="#id59" title="Link to this heading">¶</a></h3>
<p><span class="defi">UnicodeEncodeError</span> 。选定的编码方式不能编码这个字符。
<span class="defi">UnicodeDecodeError</span> 。选定的解码方式不能解码这个字符。</p>
<div class="admonition- admonition danger">
<p class="admonition-title">文本存取乱码问题</p>
<ul class="simple">
<li><p>存乱了，编码格式应该设置成支持文本内字符串的格式。日文就不要用 &lt;kbd&gt;gbk&lt;/kbd&gt;</p></li>
<li><p>取乱了，编码格式应该对应该文件存入硬盘的格式</p></li>
</ul>
</div>
<div class="line-block">
<div class="line"><code class="docutils literal notranslate"><span class="pre">string.encode(encoding,</span> <span class="pre">errors='strict')</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">string.decode(encoding,</span> <span class="pre">errors='strict')</span></code></div>
<div class="line">✏️  指定 errors 参数</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">='strict'</span></code>  抛出 Error</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">='ignore'</span></code>  忽略跳过字符</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">='replace'</span></code>  替换成官方指定符号，表示未知字符</p></li>
</ul>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">'啊'</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">'shift-jis'</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'replace'</span><span class="p">)</span>
<span class="go">b'?'</span>
<span class="gp">&gt;&gt;&gt; </span><span class="sa">b</span><span class="s1">'</span><span class="se">\xe9</span><span class="s1">'</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">'utf-8'</span><span class="p">,</span> <span class="n">errors</span><span class="o">=</span><span class="s1">'replace'</span><span class="p">)</span>
<span class="go">'�'</span>
</pre></div>
</div>
<p><span class="defi">SyntaxError</span> 。使用预期以之外的编码记载模块。</p>
<p>✏️ 在文件顶部添加 coding 注释</p>
<div class="highlight-py notranslate"><div class="highlight"><pre><span></span><span class="c1"># coding: gbk</span>
<span class="o">...</span>
</pre></div>
</div>
<p>[ValueError: invalid literal for int() with base 10问题处理]: <a class="reference external" href="https://www.cnblogs.com/chaojiyingxiong/p/10189357.html">https://www.cnblogs.com/chaojiyingxiong/p/10189357.html</a>
[CodingConvention]: <a class="reference external" href="https://visualgit.readthedocs.io/en/latest/pages/naming_convention.html#modules">https://visualgit.readthedocs.io/en/latest/pages/naming_convention.html#modules</a>
[python3-cookbook]: <a class="reference external" href="https://python3-cookbook.readthedocs.io/zh_CN/latest/c01/p03_keep_last_n_items.html">https://python3-cookbook.readthedocs.io/zh_CN/latest/c01/p03_keep_last_n_items.html</a>
[Python 中的下划线命名规则]: <a class="reference external" href="https://zhuanlan.zhihu.com/p/42228723">https://zhuanlan.zhihu.com/p/42228723</a>
[python迭代器详解]: <a class="reference external" href="https://blog.csdn.net/weixin_43796670/article/details/129699669">https://blog.csdn.net/weixin_43796670/article/details/129699669</a>
[Python 二进制，十进制，十六进制转换]: <a class="reference external" href="https://blog.csdn.net/u012063703/article/details/42609833">https://blog.csdn.net/u012063703/article/details/42609833</a>
[Python3 - 6种方法拼接合并列表list]: <a class="reference external" href="https://mediumcn.com/python3/how-to-concatenate-a-list">https://mediumcn.com/python3/how-to-concatenate-a-list</a>
[Python中的zip()：从多个列表中获取元素]: <a class="reference external" href="https://note.nkmk.me/en/python-zip-usage-for/">https://note.nkmk.me/en/python-zip-usage-for/</a>
[python中，(x for y in z for x in y)这个结构怎么理解？]: <a class="reference external" href="https://blog.csdn.net/weixin_42427638/article/details/85261284">https://blog.csdn.net/weixin_42427638/article/details/85261284</a>
[Python’s map(): Processing Iterables Without a Loop]: <a class="reference external" href="https://realpython.com/python-map-function/">https://realpython.com/python-map-function/</a>
[提升python执行效率的若干方法]: <a class="reference external" href="https://mdnice.com/writing/f4237ac1c4b6432c8a36138495886fc4">https://mdnice.com/writing/f4237ac1c4b6432c8a36138495886fc4</a>
[Python中修改字符串的四种方法]: <a class="reference external" href="https://zhuanlan.zhihu.com/p/119420131">https://zhuanlan.zhihu.com/p/119420131</a>
[heapq –堆队列算法]: <a class="reference external" href="https://docs.python.org/zh-cn/3/library/heapq.html">https://docs.python.org/zh-cn/3/library/heapq.html</a>
[collections — 容器数据类型]:<a class="reference external" href="https://docs.python.org/zh-cn/3/library/collections.html?highlight=deque">https://docs.python.org/zh-cn/3/library/collections.html?highlight=deque</a>
[Python稀疏矩阵详解]: <a class="reference external" href="https://zhuanlan.zhihu.com/p/456904535">https://zhuanlan.zhihu.com/p/456904535</a>
[python之排序操作及heapq模块]: <a class="reference external" href="https://segmentfault.com/a/1190000017383322">https://segmentfault.com/a/1190000017383322</a>
[小整数池]: <a class="reference external" href="https://zhuanlan.zhihu.com/p/371758783">https://zhuanlan.zhihu.com/p/371758783</a>
[Python 全局变量]: <a class="reference external" href="https://www.freecodecamp.org/chinese/news/python-global-variables-examples/">https://www.freecodecamp.org/chinese/news/python-global-variables-examples/</a></p>
</section>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="index.html" title="Python"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> Python </span>
              </div>
            </a>
          
          
            <a href="enhanced.html" title="Enhanced Python"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> Enhanced Python </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2024, coconut.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>