<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Git &#8212; HomePage</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=83e35b93" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/katex-math.css?v=91adb8b6" />
    <link rel="stylesheet" type="text/css" href="../_static/css/rtd_sphinx_search.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/def.css?v=5a9d86bd" />
    <script src="../_static/documentation_options.js?v=7d86a446"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=9f22d18c"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/rtd_search_config.js"></script>
    <script src="../_static/js/rtd_sphinx_search.min.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="(Apache 基金会的) Hadoop" href="hadoop.html" />
    <link rel="prev" title="杂" href="index.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue data-md-color-accent=cyan>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#utils/git" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="HomePage"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">&#xe869</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Cocobook</span>
          <span class="md-header-nav__topic"> Git </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/Coconut3223/io/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    io
  </div>
</a>
          </div>
        </div>
      
      
    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">HomePage</a></li>
            
            <li class="md-tabs__item"><a href="../AI/index.html" class="md-tabs__link">AI</a></li>
            
            <li class="md-tabs__item"><a href="../python/index.html" class="md-tabs__link">Python</a></li>
            
            <li class="md-tabs__item"><a href="../NLP/index.html" class="md-tabs__link">NLP</a></li>
            
            <li class="md-tabs__item"><a href="../SQL/index.html" class="md-tabs__link">SQL</a></li>
            
            <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Utils</a></li>
            
            <li class="md-tabs__item"><a href="../frontend/index.html" class="md-tabs__link">Frontend</a></li>
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">杂</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="HomePage" class="md-nav__button md-logo">
      
        <i class="md-icon">&#xe869</i>
      
    </a>
    <a href="../index.html"
       title="HomePage">Cocobook</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/Coconut3223/io/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    io
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Content</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../AI/index.html" class="md-nav__link">AI</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../AI/ML/index.html" class="md-nav__link">ML</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../AI/DL/index.html" class="md-nav__link">DL</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../CV/index.html" class="md-nav__link">CV</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../NLP/index.html" class="md-nav__link">NLP</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../python/index.html" class="md-nav__link">python</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../SQL/index.html" class="md-nav__link">SQL</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="index.html" class="md-nav__link">utils</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="index.html#id2" class="md-nav__link">好用的网站</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="index.html#id4" class="md-nav__link">目录</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../frontend/index.html" class="md-nav__link">frontend</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#utils-git--page-root" class="md-nav__link">Git</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#background" class="md-nav__link">Background</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#software-contiguration-management-scm" class="md-nav__link">软件配置管理, Software Contiguration Management,SCM</a>
        </li>
        <li class="md-nav__item"><a href="#git-client-tool" class="md-nav__link">git client tool</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id2" class="md-nav__link">配置</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#git-config" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">config</span></code> 配置</a>
        </li>
        <li class="md-nav__item"><a href="#ssh" class="md-nav__link">SSH: 公钥私钥</a>
        </li>
        <li class="md-nav__item"><a href="#terminal" class="md-nav__link">terminal 右侧显示分支名称</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id3" class="md-nav__link">工作流程原理</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id4" class="md-nav__link">四大区域</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#details" class="md-nav__link">details</a>
        </li>
        <li class="md-nav__item"><a href="#git-command" class="md-nav__link">git command</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id5" class="md-nav__link">初始化</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#git-init-for-an-existed-folder" class="md-nav__link">git init for an existed folder</a>
        </li>
        <li class="md-nav__item"><a href="#gui-init" class="md-nav__link">GUI init</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id6" class="md-nav__link">添加远程连接</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id7" class="md-nav__link">日常操作</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id8" class="md-nav__link">提交代码</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id9" class="md-nav__link">基本流程</a>
        </li>
        <li class="md-nav__item"><a href="#id10" class="md-nav__link">一些过程中可能用到的查看指令</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#gitignore" class="md-nav__link">.gitignore</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id11" class="md-nav__link">定义</a>
        </li>
        <li class="md-nav__item"><a href="#id12" class="md-nav__link">忽略已经被提交的</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id13" class="md-nav__link">分支操作</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#adevabdevb" class="md-nav__link">项目A的deva分支复制到项目B的devb分支</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id15" class="md-nav__link">合并操作</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id16" class="md-nav__link">合并冲突</a>
        </li>
        <li class="md-nav__item"><a href="#id17" class="md-nav__link">暂存代码保护现场</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id18" class="md-nav__link">五、git 高级操作</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id19" class="md-nav__link">5.1 git 撤销操作</a>
        </li>
        <li class="md-nav__item"><a href="#git-commit" class="md-nav__link">5.2 git 找回丢失文件(commit了)</a>
        </li>
        <li class="md-nav__item"><a href="#id20" class="md-nav__link">5.3 git 找回丢失文件(未commit,但添加暂存区了)</a>
        </li>
        <li class="md-nav__item"><a href="#id21" class="md-nav__link">5.4 终极大招</a>
        </li>
        <li class="md-nav__item"><a href="#id22" class="md-nav__link">5.5 git 迁移(保留 commit)</a>
        </li>
        <li class="md-nav__item"><a href="#clone" class="md-nav__link">5.5.1 clone 原来的项目</a>
        </li>
        <li class="md-nav__item"><a href="#id23" class="md-nav__link">5.5.2 推送到新的gitlab</a>
        </li>
        <li class="md-nav__item"><a href="#id24" class="md-nav__link">5.5.3 本地代码更换gitlab地址</a>
        </li>
        <li class="md-nav__item"><a href="#git-rebase" class="md-nav__link">5.6 git rebase</a>
        </li>
        <li class="md-nav__item"><a href="#merge" class="md-nav__link">5.6.1 merge 时只有一个分支变更</a>
        </li>
        <li class="md-nav__item"><a href="#id25" class="md-nav__link">5.6.2 merge 时两个分支有变更</a>
        </li>
        <li class="md-nav__item"><a href="#rebase" class="md-nav__link">5.6.3 rebase 时只有一个分支变更</a>
        </li>
        <li class="md-nav__item"><a href="#id26" class="md-nav__link">5.6.4 rebase 时两个分支有变更</a>
        </li>
        <li class="md-nav__item"><a href="#id27" class="md-nav__link">5.6.5 rebase 总结</a>
        </li>
        <li class="md-nav__item"><a href="#id28" class="md-nav__link">5.6.6 rebase 的命令行操作</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#squash" class="md-nav__link">squash</a>
        </li>
        <li class="md-nav__item"><a href="#fixup" class="md-nav__link">fixup</a>
        </li>
        <li class="md-nav__item"><a href="#edit" class="md-nav__link">edit</a>
        </li>
        <li class="md-nav__item"><a href="#reword" class="md-nav__link">reword</a>
        </li>
        <li class="md-nav__item"><a href="#drop" class="md-nav__link">drop</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#cherry-pick" class="md-nav__link">5.7 cherry-pick</a>
        </li>
        <li class="md-nav__item"><a href="#merge-request" class="md-nav__link">Merge Request</a>
        </li>
        <li class="md-nav__item"><a href="#id30" class="md-nav__link">六、参与开源项目</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id31" class="md-nav__link">Git版本管理及使用规范</a>
        </li>
        <li class="md-nav__item"><a href="#todo" class="md-nav__link">TODO</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="git">
<h1 id="utils-git--page-root">Git<a class="headerlink" href="#utils-git--page-root" title="Link to this heading">¶</a></h1>
<p>configure and initialize a repository, begin and stop tracking files, and stage and commit changes.</p>
<p><a class="reference external" href="https://www.cnblogs.com/springbarley/archive/2012/11/03/2752984.html">git 常用命令(含删除文件)</a></p>
<section id="background">
<h2 id="background">Background<a class="headerlink" href="#background" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><dl class="simple">
<dt>合作模式</dt><dd><ul>
<li><dl class="simple">
<dt>Collocated Contributor Repositories: (Fork and Pull)</dt><dd><ul>
<li><p>team members (Developers) pull the latest code from a central shared repository to theirown private repository.</p></li>
<li><p>make their changes locally, 然后  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">&lt;local_main&gt;:&lt;remote_subbranch&gt;</span></code>  来 share changes，但是没有权限去 push 到  <code class="docutils literal notranslate"><span class="pre">remote_main</span></code> ，</p></li>
<li><p>project maintainers 就可以 accepted and pulled， <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span> <span class="pre">&lt;subbranch&gt;</span></code> 到 project main.</p></li>
<li><p>Repos are on a centralized host.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Single Repository, Shared Maintenance: (Shared Repo)</dt><dd><ul>
<li><p>每一个 team member 都是 project maintainer，可以直接 make changes  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">&lt;local_main&gt;:&lt;remote_main&gt;</span></code> 。</p></li>
<li><p>Relies on policies to restrict access to the main project branch</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<section id="software-contiguration-management-scm">
<h3 id="software-contiguration-management-scm">软件配置管理, Software Contiguration Management,SCM<a class="headerlink" href="#software-contiguration-management-scm" title="Link to this heading">¶</a></h3>
<p>通过执行版本控制、变更控制的规程，以及使用合适的配置管理软件，来保证所有配置项的完整性和可跟踪性。配置管理是对工作成果(源码文件、需求文档、设计文档，开发文档)的一种有效保护。</p>
<ul class="simple">
<li><p><strong>集中版本控制系统</strong></p></li>
</ul>
<p>是放在中央服务器上，每次只能由一个人去锁定服务器文件的去用</p>
<ul class="simple">
<li><p>doc-level锁，</p></li>
<li><dl class="simple">
<dt>row-level锁，后者就是需要提前分配好行数，然后进行比对合并，提高了多人协作水平。如果是同样对一行，那也没辙，那也只能是锁住不给别人用），在锁定期间其他人是不能进行修改的，只能查看。</dt><dd><p>一旦服务器发生故障或者损坏，就会丢失</p>
</dd>
</dl>
</li>
</ul>
</section>
<section id="git-client-tool">
<h3 id="git-client-tool">git client tool<a class="headerlink" href="#git-client-tool" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>Git Bash</dt><dd><ul>
<li><p><a class="reference external" href="https://git-scm.com/download/mac">Download for macOS</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span> <span class="pre">git</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">--version</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Github Desktop 【</p></li>
<li><p>sourcetree</p></li>
</ul>
</section>
</section>
<section id="id2">
<h2 id="id2">配置<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h2>
<section id="git-config">
<h3 id="git-config"><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">config</span></code> 配置<a class="headerlink" href="#git-config" title="Link to this heading">¶</a></h3>
<p>没有  <code class="docutils literal notranslate"><span class="pre">--global</span></code>  只对当前仓库生效 而不是针对 local 所有仓库</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column sd-col-5 sd-col-xs-5 sd-col-sm-5 sd-col-md-5 sd-col-lg-5 docutils">
<div class="literal-block-wrapper docutils container" id="id33">
<div class="code-block-caption"><span class="caption-text">查看</span><a class="headerlink" href="#id33" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>--list
user.name<span class="o">=</span>
user.email<span class="o">=</span>
...
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id34">
<div class="code-block-caption"><span class="caption-text">修改 git 配置</span><a class="headerlink" href="#id34" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>-e<span class="w"> </span><span class="c1"># edit .config</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-col sd-d-flex-column sd-col-7 sd-col-xs-7 sd-col-sm-7 sd-col-md-7 sd-col-lg-7 docutils">
<div class="literal-block-wrapper docutils container" id="id35">
<div class="code-block-caption"><span class="caption-text">设置提交代码时的用户信息</span><a class="headerlink" href="#id35" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.name<span class="w"> </span><span class="s2">"yourUserName"</span>
$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>--gloabl<span class="w"> </span>user.email<span class="w"> </span><span class="s2">"yourEmail"</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column sd-col-7 sd-col-xs-7 sd-col-sm-7 sd-col-md-7 sd-col-lg-7 docutils">
<div class="literal-block-wrapper docutils container" id="id36">
<div class="code-block-caption"><span class="caption-text">启动换行符检查</span><a class="headerlink" href="#id36" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>core.autocrlf<span class="w"> </span><span class="nb">true</span><span class="w"> </span><span class="c1"># for windows</span>
$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>core.autocrlf<span class="w"> </span>input<span class="w"> </span><span class="c1"># for unix</span>
</pre></div>
</div>
</div>
<p>目的：</p>
<ul class="simple">
<li><p>Windows系统上的签出文件中保留 <code class="docutils literal notranslate"><span class="pre">CRLF</span></code></p></li>
<li><p>在Mac和Linux系统上，包括仓库中保留 <code class="docutils literal notranslate"><span class="pre">LF</span></code></p></li>
</ul>
<div class="line-block">
<div class="line">For windows: Git可以在你提交时自动地把行结束符CRLF转换成LF，而在签出代码时把LF转换成CRLF。</div>
<div class="line">For unix: 在提交时把CRLF转换成LF，签出时不转换, 对一个不小心被引入以CRLF为行结束符的文件</div>
</div>
<p><a class="reference external" href="https://blog.csdn.net/feng88724/article/details/11600375">[git] warning: LF will be replaced by CRLF | fatal: CRLF would be replaced by LF</a></p>
</div>
<div class="sd-col sd-d-flex-column sd-col-5 sd-col-xs-5 sd-col-sm-5 sd-col-md-5 sd-col-lg-5 docutils">
<div class="admonition-crlf-lf admonition note">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">CRLF</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">LF</span></code></p>
<ul class="simple">
<li><p>Carriage Return 回车 <code class="docutils literal notranslate"><span class="pre">\r</span></code></p></li>
<li><p>Line Feed 换行 <code class="docutils literal notranslate"><span class="pre">\n</span></code></p></li>
</ul>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>结束一行</p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">CRLF</span></code></p></th>
<th class="head"><p><code class="docutils literal notranslate"><span class="pre">LF</span></code></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>code</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\r\n</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">\n</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>platform</p></td>
<td><p>Windows</p></td>
<td><p>Mac &amp; Linux</p></td>
</tr>
</tbody>
</table>
<p>不一样的 虽然这是小问题，但它会极大地扰乱跨平台协作。</p>
</div>
</div>
</div>
</div>
</section>
<section id="ssh">
<h3 id="ssh">SSH: 公钥私钥<a class="headerlink" href="#ssh" title="Link to this heading">¶</a></h3>
<p>通过 HTTP &amp; SSH 去做克隆和提交代码，由于 HTTP 需要每次提交的时候输入邮箱号和密码，所以常用电脑上配置 SSH ，只要配置好了以后，下次提交的时候就方便了。</p>
<p>大多数 Git 服务器都会选择使用 SSH 公钥来进行授权。系统中的每个用户都必须提供一个公钥用于授权，没有的话就要生成一个。</p>
<p>首先你要确认一下本机是否已经有一个公钥。</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column docutils">
<p>在 <code class="docutils literal notranslate"><span class="pre">/c/Users/…/.ssh</span></code></p>
<div class="literal-block-wrapper docutils container" id="id37">
<div class="code-block-caption"><span class="caption-text">确认是否有公钥</span><a class="headerlink" href="#id37" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>~/.ssh
$<span class="w"> </span>ls
id_rsa<span class="w">      </span>id_rsa.pub<span class="w">  </span><span class="c1"># 私钥 &amp; 公钥</span>
</pre></div>
</div>
</div>
</div>
<div class="sd-col sd-d-flex-column docutils">
<div class="literal-block-wrapper docutils container" id="id38">
<div class="code-block-caption"><span class="caption-text">创建</span><a class="headerlink" href="#id38" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ssh-keygen<span class="w"> </span>-t<span class="w"> </span>rsa<span class="w"> </span>-C<span class="w"> </span><span class="s2">"account@domain.com"</span>
Creates<span class="w"> </span>a<span class="w"> </span>new<span class="w"> </span>ssh<span class="w"> </span>key<span class="w"> </span>using<span class="w"> </span>the<span class="w"> </span>provided<span class="w"> </span>email
<span class="c1"># Generating public/private rsa key pair.</span>
Enter<span class="w"> </span>file<span class="w"> </span><span class="k">in</span><span class="w"> </span>which<span class="w"> </span>to<span class="w"> </span>save<span class="w"> </span>the<span class="w"> </span>key<span class="w"> </span><span class="o">(</span>/home/you/.ssh/id_rsa<span class="o">)</span>:
Enter<span class="w"> </span>passphrase<span class="w"> </span><span class="o">(</span>empty<span class="w"> </span><span class="k">for</span><span class="w"> </span>no<span class="w"> </span>passphrase<span class="o">)</span>
<span class="c1"># 使用ssh传输文件的时候，你就要输入这个密码</span>
Enter<span class="w"> </span>same<span class="w"> </span>passphrase<span class="w"> </span>again:
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column docutils">
<p>For github</p>
<p><code class="docutils literal notranslate"><span class="pre">Setting</span></code> =&gt; <code class="docutils literal notranslate"><span class="pre">SSH</span> <span class="pre">&amp;</span> <span class="pre">GPG</span> <span class="pre">keys</span></code> =&gt; <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">SSH</span> <span class="pre">key</span></code></p>
<p>用记事本打开 <code class="docutils literal notranslate"><span class="pre">id_rsa.pub</span></code> 文件，全选其中的内容粘贴到网页的Key中</p>
<div class="literal-block-wrapper docutils container" id="id39">
<div class="code-block-caption"><span class="caption-text">测试 SSH key</span><a class="headerlink" href="#id39" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>ssh<span class="w"> </span>-T<span class="w"> </span>git@github.com
<span class="c1">#!!! git@github.com 不是邮箱</span>
</pre></div>
</div>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://blog.csdn.net/qq_36667170/article/details/79094257">Git教程 SSH keys配置</a></p></li>
</ul>
</div>
<div class="sd-col sd-d-flex-column docutils">
<p><strong>FOR gitlab</strong></p>
<ol class="arabic">
<li><dl>
<dt>确认是否可以 ssh 来做</dt><dd><figure class="align-default" id="id40">
<a class="reference internal image-reference" href="../_images/ssh_gitlab_1.png"><img alt="../_images/ssh_gitlab_1.png" src="../_images/ssh_gitlab_1.png" style="width: 240.0px; height: 163.5px;"/>
</a>
<figcaption>
<p><span class="caption-text">只允许 HTTPS</span><a class="headerlink" href="#id40" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</dd>
</dl>
</li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">Setting</span></code> =&gt; <code class="docutils literal notranslate"><span class="pre">SSH</span> <span class="pre">keys</span></code> =&gt; <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">SSH</span> <span class="pre">key</span></code></p>
<p>用记事本打开 <code class="docutils literal notranslate"><span class="pre">id_rsa.pub</span></code> 文件，全选其中的内容粘贴到网页的Key中</p>
<div class="admonition-ok-access-denied admonition danger">
<p class="admonition-title">如果一切都ok， 还是不行： access denied</p>
<div class="literal-block-wrapper docutils container" id="id41">
<div class="code-block-caption"><span class="caption-text">查看</span><a class="headerlink" href="#id41" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ssh<span class="w"> </span>-vT<span class="w"> </span>git@&lt;domain&gt;
<span class="c1"># ssh -vT git@gitlab.com</span>
</pre></div>
</div>
</div>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ssh:</span> <span class="pre">connect</span> <span class="pre">to</span> <span class="pre">host</span> <span class="pre">gitlab.xxx</span> <span class="pre">port</span> <span class="pre">22:</span> <span class="pre">Connection</span> <span class="pre">timed</span> <span class="pre">out</span></code>  不允许 ssh 连接</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">debug1:</span> <span class="pre">Host</span> <span class="pre">'gitlab.com'</span> <span class="pre">is</span> <span class="pre">known</span> <span class="pre">and</span> <span class="pre">matches</span> <span class="pre">the</span> <span class="pre">ED25519</span> <span class="pre">host</span> <span class="pre">key.</span></code> 要用 ED25519 来生成公私钥</p></li>
</ol>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://www.jianshu.com/p/95991a646f72">GitLab使用教程，看这一篇就够了</a></p></li>
<li><p><a class="reference external" href="https://www.cnblogs.com/shuen/p/15035196.html">gitlab设置ssh代码提交报错误 Permission denied 的解决方案</a></p></li>
<li><p><a class="reference external" href="https://blog.csdn.net/Luckly_smile/article/details/120188609">公司Gitlab，没有域名，设置多SSH（公司和Gitee）</a></p></li>
</ul>
</div>
</div>
</div>
</section>
<section id="terminal">
<h3 id="terminal">terminal 右侧显示分支名称<a class="headerlink" href="#terminal" title="Link to this heading">¶</a></h3>
<div class="literal-block-wrapper docutils container" id="id42">
<div class="code-block-caption"><span class="caption-text">把如下代码添加至你的  <code class="docutils literal notranslate"><span class="pre">~/.zshrc</span></code>  文件中，就可以在 <strong>右侧显示分支名称</strong></span><a class="headerlink" href="#id42" title="Link to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>autoload -Uz vcs_info
precmd_vcs_info() { vcs_info }
precmd_functions+=( precmd_vcs_info )
setopt prompt_subst
RPROMPT=\$vcs_info_msg_0_
# PROMPT=\$vcs_info_msg_0_'%# '
zstyle ':vcs_info:git:*' formats '%b'
</pre></div>
</div>
</div>
<p><a class="reference external" href="https://git-scm.com/book/zh/v2/附录-A%3A-在其它环境中使用-Git-Zsh-中的-Git">在其它环境中使用 Git - Zsh 中的 Git</a></p>
</section>
</section>
<section id="id3">
<h2 id="id3">工作流程原理<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h2>
<section id="id4">
<h3 id="id4">四大区域<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>3个本地区域</dt><dd><ul>
<li><dl class="simple">
<dt>工作区, <strong>Working Directory</strong></dt><dd><ul>
<li><p>用户工作的地方，放代码文件的地方。</p></li>
<li><p>需要往 repository 里放文件，就要先在工作区里放文件。Git 会自动检测这里的文件变化情况。</p></li>
<li><p>当 repository 里有很多 branches，工作区会自动是所选 branch 的工作地方。</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>暂存区, <strong>Staging Area</strong> :</dt><dd><ul>
<li><p>存放临时的改动, working directory 里有修改的文件需要先  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">file_name</span></code>  提交到 staging area，然后再 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-m</span> <span class="pre">&lt;message&gt;</span></code>  放到 local repository 里，然后就会产生一个版本号文件。</p></li>
<li><p>事实上它只是一个文件, 保存即将提交的文件列表信息。</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Git 目录， <strong>.git directory, Respository</strong></dt><dd><ul>
<li><p>安全存放数据的位置, 这里面有提交到 <strong>所有版本</strong> 的数据。通过这个实现万一远程挂了，怎么在 local 端继续操作</p></li>
<li><p>HEAD file 指向最新放入仓库的版本</p></li>
<li><p>heads dir 里是每个分支指向的最新版本</p></li>
<li><p>objects dir 里是所有版本的修改情况</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>1个远程区域</dt><dd><ul>
<li><dl class="simple">
<dt>远程库，Remote</dt><dd><p>托管代码的服务器，从 local repository 推送文件到远程库需要  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code> , 从远程库拉取文件来更新 repository 需要  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code></p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
</section>
<section id="details">
<h2 id="details">details<a class="headerlink" href="#details" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><dl class="simple">
<dt>版本号</dt><dd><ul>
<li><p>SHA-1 加密， 用来 merge 时避免 conflict</p></li>
<li><p>共40位，前两位2定位  <code class="docutils literal notranslate"><span class="pre">objects</span></code>  里的 dir name，后38位定位 file name</p></li>
<li><dl class="simple">
<dt>查看版本号文件不能直接手动打开，需要用 <strong>git bash</strong> 打开</dt><dd><ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cat-file</span> <span class="pre">-p</span> <span class="pre">&lt;version&gt;</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">-p</span></code>  友好地查看</p></li>
<li><p>但是不知道为什么会error  <code class="docutils literal notranslate"><span class="pre">Not</span> <span class="pre">a</span> <span class="pre">valid</span> <span class="pre">object</span> <span class="pre">name</span> <span class="pre">636a7d6c4e21df81163ad4616e301e86ca000f</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p>内容是当前提前信息的</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<figure class="align-default" id="id43">
<img alt="../_images/git_1.png" src="../_images/git_1.png"/>
<figcaption>
<p><span class="caption-text">红色部分由refs提供, 其余部分全部由objects提供, commit对象（黄色）指向保存文件结构的tree对象（蓝色），后者再指向各个文件对象（灰色） 图/Pro Git on git-scm.com</span><a class="headerlink" href="#id43" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="git-command">
<h2 id="git-command">git command<a class="headerlink" href="#git-command" title="Link to this heading">¶</a></h2>
<section id="id5">
<h3 id="id5">初始化<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column sd-col-4 sd-col-xs-4 sd-col-sm-4 sd-col-md-4 sd-col-lg-4 docutils">
<div class="literal-block-wrapper docutils container" id="id44">
<div class="code-block-caption"><span class="caption-text">本地新建一个 local init</span><a class="headerlink" href="#id44" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mkdir<span class="w"> </span>local_init
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>local_init
<span class="hll">$<span class="w"> </span>git<span class="w"> </span>init
</span>$<span class="w"> </span>ls
</pre></div>
</div>
</div>
</div>
<div class="sd-col sd-d-flex-column sd-col-8 sd-col-xs-8 sd-col-sm-8 sd-col-md-8 sd-col-lg-8 docutils">
<figure class="align-default" id="id45">
<a class="reference internal image-reference" href="../_images/local_git_init_1.png"><img alt="../_images/local_git_init_1.png" src="../_images/local_git_init_1.png" style="width: 474.59999999999997px; height: 181.79999999999998px;"/>
</a>
<figcaption>
<p><span class="caption-text">此时就会出现一个 .git 的隐藏 directory，这就是 local repository。
以后所有的 git 操作历史提交记录信息全都在此, 只要这个文件夹还存在, 就可以记住我们所有的 git 操作。</span><a class="headerlink" href="#id45" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div>
</div>
</div>
<p>在 local init 新建的 repository 是没有任何的提交文件，所以也没有 default 的 branch 文件。</p>
<ul class="simple">
<li><p>heads  directory 里没有文件，哪怕 HEAD 里指向 main 或者master。</p></li>
<li><p>objects directory 里没有文件，因为没有版本。</p></li>
<li><p>所以用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">branch</span> <span class="pre">-m</span> <span class="pre">branch1</span></code>  也没有用，因为head里依旧没有文件</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/local_git_init_2.png"><img alt="../_images/local_git_init_2.png" src="../_images/local_git_init_2.png" style="width: 549.6px; height: 277.2px;"/>
</a>
<a class="reference internal image-reference" href="../_images/local_git_init_3.png"><img alt="../_images/local_git_init_3.png" src="../_images/local_git_init_3.png" style="width: 454.2px; height: 195.0px;"/>
</a>
<a class="reference internal image-reference" href="../_images/local_git_init_4.png"><img alt="../_images/local_git_init_4.png" src="../_images/local_git_init_4.png" style="width: 318.0px; height: 340.2px;"/>
</a>
<section id="git-init-for-an-existed-folder">
<h4 id="git-init-for-an-existed-folder">git init for an existed folder<a class="headerlink" href="#git-init-for-an-existed-folder" title="Link to this heading">¶</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>existing_folder
git<span class="w"> </span>init
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w">  </span>main
git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>origin<span class="w"> </span>git@gitlab.com:path/to/project.git
<span class="c1"># 就正常地联系上了</span>
</pre></div>
</div>
<p><a class="reference external" href="https://wiki.koansoftware.com/index.php/Error_Initialize_GIT_git_init_--initial-branch%3Dmain">Error Initialize GIT git init –initial-branch=main</a></p>
</section>
<section id="gui-init">
<h4 id="gui-init">GUI init<a class="headerlink" href="#gui-init" title="Link to this heading">¶</a></h4>
<a class="reference internal image-reference" href="../_images/gui_create_1.png"><img alt="../_images/gui_create_1.png" src="../_images/gui_create_1.png" style="width: 378.0px; height: 347.4px;"/>
</a>
<p>除了 local init 里的东西，还会自动 initial commit</p>
<ul class="simple">
<li><p>生成  <code class="docutils literal notranslate"><span class="pre">.git</span></code> ,  <code class="docutils literal notranslate"><span class="pre">.gitattribute</span></code></p></li>
<li><p>可以自选要不要带上  <code class="docutils literal notranslate"><span class="pre">readme.md</span></code></p></li>
<li><p>heads  directory 里有文件，是 default branch (main 或者 master，自己设)，里面指向的就是 initial commit 的版本文件</p></li>
<li><p>objects directory 有文件，包括 initial commit 这个版本文件</p></li>
<li><p>所以用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">branch</span> <span class="pre">-m</span> <span class="pre">branch1</span></code>  就有用，而且可以选择branch。</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/gui_create_2.png"><img alt="../_images/gui_create_2.png" src="../_images/gui_create_2.png" style="width: 575.4px; height: 225.6px;"/>
</a>
</section>
</section>
<section id="id6">
<h3 id="id6">添加远程连接<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column sd-col-4 sd-col-xs-4 sd-col-sm-4 sd-col-md-4 sd-col-lg-4 docutils">
<p>场景：</p>
<ul class="simple">
<li><p>本地 init 建库了，没有跟远程分支挂钩</p></li>
<li><p>想推给别的仓库别的分支</p></li>
</ul>
<p><a class="reference external" href="https://www.cnblogs.com/Amerys/p/14669572.html">git推送代码报错：fatal: The current branch master has no upstream branch. To push the current branch and set the remote as upstream</a></p>
</div>
<div class="sd-col sd-d-flex-column sd-col-8 sd-col-xs-8 sd-col-sm-8 sd-col-md-8 sd-col-lg-8 docutils">
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="hll">$<span class="w"> </span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>origin<span class="w"> </span><span class="o">[</span>远程分支link<span class="o">]</span>
</span><span class="c1"># git remote add origin https://username@xxx.com/xxx.git</span>
<span class="hll">$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>--set-upstream<span class="w"> </span>origin<span class="w"> </span>master
</span><span class="c1"># origin = 远程git仓库, 可以换成仓库链接</span>
<span class="c1"># git push --set-upstream https://username@xxx.com/xxx.git master</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="admonition-git-pull-origin-git-pull-upstream admonition note">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">origin</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span> <span class="pre">upstream</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">origin</span></code> 指的是源仓库，一般为git clone的仓库，如xxx/fastjson，是克隆后默认提交和拉取的仓库地址。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">upstream</span></code> 意指上游仓库，一般是fork 出的上游仓库</p></li>
</ul>
</div>
</section>
</section>
<section id="id7">
<h2 id="id7">日常操作<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h2>
<section id="id8">
<h3 id="id8">提交代码<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<section id="id9">
<h4 id="id9">基本流程<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h4>
<ol class="arabic">
<li><dl>
<dt>working dir -&gt; staging area</dt><dd><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. 该命令可以将文件添加到暂存区</span>
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span><span class="o">[</span>file1<span class="o">]</span><span class="w"> </span><span class="o">[</span>file2<span class="o">]</span><span class="w"> </span>...

<span class="c1"># 2. 添加指定目录到暂存区</span>
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span><span class="o">[</span>dir<span class="o">]</span>

<span class="c1"># 3. 添加当前目录下所有文件进入暂存区</span>
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>.

<span class="c1"># 4. 添加当前目录下特定格式进入暂存区.</span>
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>*.py
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>staging area -&gt; local repository</dt><dd><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-m</span> <span class="pre">&lt;message&gt;</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>local respository -&gt; remote</dt><dd><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">origin</span> <span class="pre">&lt;local_branch&gt;</span> <span class="pre">:</span> <span class="pre">&lt;remote_branch&gt;</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">origin</span></code>  :</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">local_branch</span></code>  working dir 的 branch</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remote_branch</span></code>  你要 push 的那个 repository 的那个 branch</p></li>
</ul>
</dd>
</dl>
</li>
</ol>
</section>
<section id="id10">
<h4 id="id10">一些过程中可能用到的查看指令<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h4>
<ul class="simple">
<li><dl class="simple">
<dt>查看在你上次提交之后是否有对文件进行再次修改</dt><dd><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code></p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">nothing</span> <span class="pre">to</span> <span class="pre">commit</span></code>  目前「沒有東西可以提交」</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Untracked</span> <span class="pre">files</span></code>  所有文件都是当前没有被加入过branch的文件，也没有被  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>  放进 staging area</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Changes</span> <span class="pre">not</span> <span class="pre">staged</span> <span class="pre">for</span> <span class="pre">commit</span></code>  改过，没有被  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>  放进 staging area</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Changes</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">committed</span></code>  改过，已经放进 staging area。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Unmerged</span> <span class="pre">paths</span></code>  冲突的文件。在文件中把冲突都保留下来了，并需要自己手动处理。</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>比较文件在 <strong>暂存区和工作区</strong> 的差异，已经写入暂存区和已经被修改但尚未写入暂存区文件的区别</dt><dd><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code></p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>查看暂存区的文件</dt><dd><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">ls-files</span></code></p>
<ul>
<li><dl class="simple">
<dt>可选参数:</dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">-d</span></code> : 显示删除的文件</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-m</span></code> : 显示被修改过的文件</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-o</span></code> : 显示没有被 git 跟踪过的文件</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>查看 <strong>暂存区</strong> 文件中的内容</dt><dd><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cat-file</span> <span class="pre">-p</span></code></p>
<ul>
<li><p>如果 error， 可以看看  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">ls-files</span></code>  在不在暂存区里</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>给版本文件打标签</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/tag-1.png"><img alt="../_images/tag-1.png" src="../_images/tag-1.png" style="width: 265.2px; height: 373.8px;"/>
</a>
</section>
</section>
<section id="gitignore">
<h3 id="gitignore">.gitignore<a class="headerlink" href="#gitignore" title="Link to this heading">¶</a></h3>
<p>忽略Git中不想提交的文件</p>
<section id="id11">
<h4 id="id11">定义<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h4>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column docutils">
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">/</span></code> 结束的模式匹配文件夹以及在该文件夹路径下的内容</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">/</span></code> 开头表示仅限根目录，如果没有就是递归搜索下全部的</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">**</span></code> 匹配任意中间目录</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">!</span></code> <strong>不忽略</strong> 匹配到的文件或目录</p></li>
</ul>
<div class="admonition-git-ignore admonition danger">
<p class="admonition-title">git 对于 .ignore 配置文件是按行从上到下进行规则匹配的，意味着如果前面的规则匹配的范围更大，则后面的规则将不会生效；</p>
<p>如果文件的 <strong>父目录</strong> 已经被前面的规则排除掉了，那么对这个文件用”!”规则是不起作用的</p>
<div class="literal-block-wrapper docutils container" id="id46">
<div class="code-block-caption"><span class="caption-text">.gitignore</span><a class="headerlink" href="#id46" title="Link to this code">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># Wrong</span>
<span class="l l-Scalar l-Scalar-Plain">folder/</span><span class="w">  </span><span class="c1"># 父目录已经被忽略</span>
<span class="kt">!folder/a.txt</span>

<span class="c1"># True</span>
<span class="l l-Scalar l-Scalar-Plain">folder/*</span><span class="w">  </span><span class="c1"># 只是排除父目录下文件</span>
<span class="kt">!folder/a.txt</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="sd-col sd-d-flex-column docutils">
<div class="literal-block-wrapper docutils container" id="id47">
<div class="code-block-caption"><span class="caption-text">.gitignore</span><a class="headerlink" href="#id47" title="Link to this code">¶</a></div>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="c1"># 忽略Git中不想提交的文件</span>
<span class="l l-Scalar l-Scalar-Plain">logs/</span><span class="w">  </span><span class="c1"># 所有的 logs 文件夹 &amp; 该路径下的内容</span>
<span class="l l-Scalar l-Scalar-Plain">/logs/</span><span class="w"> </span><span class="c1"># 根目录下 logs 文件夹 &amp; 该路径下的内容</span>

<span class="l l-Scalar l-Scalar-Plain">/data/**/*.wav</span><span class="w"> </span><span class="c1"># 根目录下 data 下所有 wav file</span>
<span class="l l-Scalar l-Scalar-Plain">data/**/*.wav</span><span class="w"> </span><span class="c1"># 所有的 data 下所有 wav file</span>

<span class="err">*</span><span class="l l-Scalar l-Scalar-Plain">.pyc</span><span class="w">  </span><span class="c1"># 所有的 pyc</span>
<span class="l l-Scalar l-Scalar-Plain">/*.pyc</span><span class="w">  </span><span class="c1"># 根目录下所有的 pyc</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="id12">
<h4 id="id12">忽略已经被提交的<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h4>
<div class="admonition-gitignore admonition danger">
<p class="admonition-title">如果某些文件已经被纳入了版本管理中，就算是在 .gitignore 中已经声明了忽略路径也是不起作用的，</p>
<p><code class="docutils literal notranslate"><span class="pre">.gitignore</span></code> 只能起效于 Untracked Files</p>
<ol class="arabic simple">
<li><p>原来没有被 <strong>track</strong> 的文件</p></li>
<li><p>不在暂存区中才可以，<code class="docutils literal notranslate"><span class="pre">.gitignore</span></code> 文件只是忽略没有被 staged(cached) 文件 =&gt; unstage</p></li>
</ol>
<p><strong>Solutions：</strong></p>
<ol class="arabic simple">
<li><dl class="simple">
<dt>先把本地缓存删除但文件还保留在本地 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rm</span> <span class="pre">-r</span> <span class="pre">--cached</span> <span class="pre">folder/file</span></code></dt><dd><p><code class="docutils literal notranslate"><span class="pre">--cached</span></code> 本地缓存删除但文件还保留在本地
加上 -f <strong>删除本地文件</strong></p>
</dd>
</dl>
</li>
<li><p>添加 <code class="docutils literal notranslate"><span class="pre">.gitignore</span></code></p></li>
<li><p>git的提交</p></li>
</ol>
</div>
<p><a class="reference external" href="https://www.cnblogs.com/kevingrace/p/5690241.html">Git忽略提交规则 - .gitignore配置运维总结</a></p>
</section>
</section>
<section id="id13">
<h3 id="id13">分支操作<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h3>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column docutils">
<p>查看分支  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">branch</span> <span class="pre">-a</span></code></p>
<div class="literal-block-wrapper docutils container" id="id48">
<div class="code-block-caption"><span class="caption-text">创建新分支</span><a class="headerlink" href="#id48" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>branch<span class="w"> </span>issue1<span class="w"> </span><span class="c1"># new issue1 but no checkout</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>issue1<span class="w">  </span><span class="c1"># new &amp; checkout</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>issue1<span class="w"> </span>master<span class="w"> </span><span class="c1"># 根据指定new &amp;ck</span>
$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>feature1<span class="w"> </span><span class="c1"># new remote = push</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id49">
<div class="code-block-caption"><span class="caption-text">删除分支</span><a class="headerlink" href="#id49" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 删 local_branch</span>
$<span class="w"> </span>git<span class="w"> </span>branch<span class="w"> </span>-d<span class="w"> </span>dev<span class="w">  </span><span class="c1"># 只能删参与了合并的分支</span>
$<span class="w"> </span>git<span class="w"> </span>branch<span class="w"> </span>-D<span class="w"> </span>dev<span class="w">  </span><span class="c1"># 强制删除</span>

<span class="c1"># 删 remote_branch</span>
$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>-d<span class="w"> </span>dev

<span class="c1"># 删本地的（远程分支已被删）的分支</span>
$<span class="w"> </span>git<span class="w"> </span>remote<span class="w"> </span>prune<span class="w"> </span>origin
</pre></div>
</div>
</div>
</div>
<div class="sd-col sd-d-flex-column docutils">
<div class="literal-block-wrapper docutils container" id="id50">
<div class="code-block-caption"><span class="caption-text">切换分支 | 版本号</span><a class="headerlink" href="#id50" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 分支</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>dev<span class="w">  </span><span class="c1"># 切换分支</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>-<span class="w">  </span><span class="c1"># ck 上一个分支</span>

<span class="c1"># commit version</span>
$<span class="w"> </span>git<span class="w"> </span>log<span class="w"> </span><span class="c1"># 查看版本号</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>&lt;SHA&gt;
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id51">
<div class="code-block-caption"><span class="caption-text">重命名 rename</span><a class="headerlink" href="#id51" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 共有的</span>
$<span class="w"> </span>git<span class="w"> </span>branch<span class="w"> </span>-m<span class="w"> </span>dev<span class="w"> </span>newdev

<span class="c1"># 如果已经推送到远程的话,还要</span>
$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>--delete<span class="w"> </span>origin<span class="w"> </span>dev<span class="w"> </span><span class="c1"># DELETE</span>
$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>newdev
$<span class="w"> </span>git<span class="w"> </span>branch<span class="w"> </span>--set-upstream-to<span class="w"> </span>origin/newdev
</pre></div>
</div>
</div>
</div>
</div>
</div>
<section id="adevabdevb">
<h4 id="adevabdevb">项目A的deva分支复制到项目B的devb分支<a class="headerlink" href="#adevabdevb" title="Link to this heading">¶</a></h4>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>master<span class="w"> </span><span class="o">[</span>https://B.git<span class="o">]</span><span class="w">  </span><span class="c1"># clone B 到本地</span>
$<span class="w"> </span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>upstream<span class="w"> </span><span class="o">[</span>https://A.git<span class="o">]</span><span class="w">  </span><span class="c1"># 加 A 到本地的remote中</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>devb<span class="w">  </span><span class="c1"># new B devb</span>
$<span class="w"> </span>git<span class="w"> </span>pull<span class="w"> </span>upstream<span class="w"> </span>deva<span class="w">  </span><span class="c1"># pull A deva</span>
$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>devb<span class="w">  </span><span class="c1"># push B devb</span>
</pre></div>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://www.freecodecamp.org/chinese/news/git-switch-branch/">Git 切换分支</a></p></li>
<li><p><a class="reference external" href="https://blog.csdn.net/weixin_47978760/article/details/129947996">git常规操作 | 将A项目的某一分支迁移到B项目上</a></p></li>
</ul>
</section>
</section>
<section id="id15">
<h3 id="id15">合并操作<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>先切换到要合并的主分支  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">master</span></code></p></li>
<li><dl class="simple">
<dt>选择要合并的另外一个 branch</dt><dd><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span> <span class="pre">&lt;another_branch&gt;</span></code></p>
</dd>
</dl>
</li>
</ol>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column docutils">
<a class="reference internal image-reference" href="../_images/merge_1.png"><img alt="../_images/merge_1.png" src="../_images/merge_1.png" style="width: 274.8px; height: 279.0px;"/>
</a>
</div>
<div class="sd-col sd-d-flex-column docutils">
<a class="reference internal image-reference" href="../_images/merge_2.png"><img alt="../_images/merge_2.png" src="../_images/merge_2.png" style="width: 271.2px; height: 279.0px;"/>
</a>
</div>
</div>
</div>
<section id="id16">
<h4 id="id16">合并冲突<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h4>
<p>合并代码出现冲突提示。 这个时候不可以进行任何分支切换和commit操作，需要按照提示将冲突解决。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 冲突提示</span>
Auto-merging<span class="w"> </span>README.md
CONFLICT<span class="w"> </span><span class="o">(</span>content<span class="o">)</span>:<span class="w"> </span>Merge<span class="w"> </span>conflict<span class="w"> </span><span class="k">in</span><span class="w"> </span>README.md
Automatic<span class="w"> </span>merge<span class="w"> </span>failed<span class="p">;</span><span class="w"> </span>fix<span class="w"> </span>conflicts<span class="w"> </span>and<span class="w"> </span><span class="k">then</span><span class="w"> </span>commit<span class="w"> </span>the<span class="w"> </span>result.
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/merge_2.png"><img alt="../_images/merge_2.png" src="../_images/merge_2.png" style="width: 271.2px; height: 279.0px;"/>
</a>
<a class="reference internal image-reference" href="../_images/merge_3.png"><img alt="../_images/merge_3.png" src="../_images/merge_3.png" style="width: 429.59999999999997px; height: 171.0px;"/>
</a>
<a class="reference internal image-reference" href="../_images/merge_4.png"><img alt="../_images/merge_4.png" src="../_images/merge_4.png" style="width: 551.4px; height: 242.39999999999998px;"/>
</a>
<ol class="arabic">
<li><dl>
<dt>查看冲突文件内容</dt><dd><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ vim README.md
1111
2222
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
3333
=======
3344
&gt;&gt;&gt;&gt;&gt;&gt;&gt; feature/hotfix-002
</pre></div>
</div>
<ul class="simple">
<li><p>从  <code class="docutils literal notranslate"><span class="pre">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span> <span class="pre">HEAD</span></code>  开始, 到  <code class="docutils literal notranslate"><span class="pre">=======</span></code>  都是主分支已经存在的内容。</p></li>
<li><p>从  <code class="docutils literal notranslate"><span class="pre">=======</span></code>  开始, 到  <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> <span class="pre">branch</span></code>  都是 merge 过来的分支的内容。</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>解决冲突，视情况保留(删除)记录</dt><dd><ol class="arabic simple">
<li><p>冲突解决完成之后, 再次提交代码 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code></p></li>
</ol>
</dd>
</dl>
</li>
</ol>
</section>
<section id="id17">
<h4 id="id17">暂存代码保护现场<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h4>
<div class="admonition- admonition danger">
<p class="admonition-title">在签出前请清理存储库工作树</p>
</div>
<div class="admonition-master-dev-bug-git-stash admonition hint">
<p class="admonition-title">项目经理提了一个新的需求, 开发就需要从 master 分支迁出一个新的分支进行功能开发(例如迁出新分支为dev), 如果在开发过程中生产上有紧急 bug 需要修复, 就可以用到  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span></code>  了。</p>
<p>这种情况一般是出现在你正在完成一个功能，但是忽然线上发现了一个Bug，必须马上开一个新的分支来修复bug，但是现在的功能没写完不打算提交(commit)，现在怎么办？？</p>
</div>
<div class="admonition-local-repository-commit admonition note">
<p class="admonition-title">为什么要暂存，而不用直接在自己的 local repository commit</p>
<p>commit 需要写 message。一般 message 都是写 “完成xx功能，修改xx功能”， 如果这样写但是其实做到一半就会有歧义。如果不这样写，交代自己的工作进度，也行。但是一旦 push 的话就会把该 branch 的所有 commit 都 push 到 shared repository。那么 messages 都 public 了。</p>
</div>
<div class="literal-block-wrapper docutils container" id="id52">
<div class="code-block-caption"><span class="caption-text">code_flow</span><a class="headerlink" href="#id52" title="Link to this code">¶</a></div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>stash<span class="w"> </span>（把当前未提交的修改暂存起来，让仓库还原到最后一次提交的状态。）
$<span class="w"> </span>git<span class="w"> </span>pull<span class="w"> </span>（拉取远程仓库的代码，让你现在的代码和远程仓库一致）
$<span class="w"> </span>git<span class="w"> </span>stash<span class="w"> </span>pop<span class="w"> </span>（恢复第一步储存起来的代码，也就是恢复当前未提交的修改）
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span></code>  可以将现在的 <strong>工作区</strong> 全部的修改、新增、删除等操作，全部保存起来。</p>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span></code>  的常用命令:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">save</span> <span class="pre">'save</span> <span class="pre">message'</span></code> : 执行存储时, 添加备注, 方便查找, 当然只执行  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span></code>  也是可以的, 但查找时不方便。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">list</span></code> : 查看 stash 了哪些存储。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">show</span></code> : 显示做了哪些改动, 默认 show 第一个存储, 如果要显示其他的存储, 后面加  <code class="docutils literal notranslate"><span class="pre">stash@{$num}</span></code> , 比如第二个:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">show</span> <span class="pre">stash@{1}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stast</span> <span class="pre">show</span> <span class="pre">-p</span></code> : 显示第一个存储的改动, 如果想显示其他存储, 则:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">show</span> <span class="pre">stash@{$num}</span> <span class="pre">-p</span></code> , 比如第二个:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">show</span> <span class="pre">stash@{1}</span> <span class="pre">-p</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">apply</span></code> : 应用某个存储, 但不会把存储从存储列表中删除, 默认使用第一个存储, 即  <code class="docutils literal notranslate"><span class="pre">stash@{0}</span></code> , 如果要是用其他, 则:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">apply</span> <span class="pre">stash@{$num}</span></code> , 比如第二个:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">apply</span> <span class="pre">stash@{1}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">pop</span></code> : 恢复之前缓存的工作目录, 将缓存列表中对应的 stash 删除, 并将对应修改应用到当前的工作目录下, 默认为第一个 stash, 即  <code class="docutils literal notranslate"><span class="pre">stash@{0}</span></code> , 如果要应用并删除其他 stash, 则:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">pop</span> <span class="pre">stash@{$num}</span></code> , 比如应用并删除第二个:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">pop</span> <span class="pre">stash@{1}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">drop</span> <span class="pre">stash@{num}</span></code> : 丢弃  <code class="docutils literal notranslate"><span class="pre">stash@{num}</span></code>  存储, 从列表中删除这个存储</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">clear</span></code> : 删除所有缓存的 stash</p></li>
</ol>
<p>开始模拟现场</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># git 初始化
$ cd .. &amp;&amp; rm -rf git-study &amp;&amp; mkdir git-study &amp;&amp; cd git-study &amp;&amp; git init
$ echo 'file1 init' &gt; file1.txt
$ echo 'file2 init' &gt; file2.txt
$ git add .
$ git commit -m 'change: add file1 &amp; file2'
[master (root-commit) 525c358] change: add file1 &amp; file2
2 files changed, 2 insertions(+)
create mode 100644 file1.txt
create mode 100644 file2.txt

# 然后从 master 分支创建两个新的 feature 分支
$ git branch feature1
$ git branch feature2

# checkout feature1, 修改 file1.txt, 并在 feature1 上创建两次提交
$ git checkout feature1
$ echo 'add file1.txt code 1' &gt;&gt; file1.txt
$ git add file1.txt
$ git commit -m 'change file1 no.1'
$ echo 'add file2.txt code 2' &gt;&gt; file1.txt
$ git add file1.txt
$ git commit -m 'change file1 no.2'
# 目前 feature1 上的改动内容
$ cat file1.txt
file1 init
add file1.txt code 1
add file2.txt code 2
$ cat file2.txt
file2 init

# checkout feature2, 修改 file2.tx
$ git checkout feature2
$ echo 'add file2.txt code 1' &gt;&gt; file2.txt
$ git add file2.txt
$ git commit -m 'change file2 no.1'
# 目前 feature2 上的改动内容
$ cat file1.txt
file1 init
$ cat file2.txt
file2 init
add file2.txt code 1

# 假设不小心将 feature2 合并到了 feature1, 并在 feature1 继续进行了代码开发并提交
$ git checkout feature1
$ git merge feature2
$ echo 'add file1.txt no.3 &amp; code end' &gt;&gt; file1.txt
$ git add file1.txt
$ git commit -m 'change file1 no.3'
# 此时 feature1 上所有文件的内容
$ cat file1.txt
file1 init
add file1.txt code 1
add file2.txt code 2
add file1.txt no.3 &amp; code end
$ cat file2.txt
file2 init
add file2.txt code 1

# 此时我们发现了不小心 merge 进来的 feature2, 而且在这基础上我们还有新的 commit, 如果我们想将 merge 剔除, 可以做如下操作
# 先查看需要还原 commit 的版本号
$ git log --oneline
8a1454f (HEAD -&gt; feature1) change file1 no.3
422a454 Merge branch 'feature2' into feature1
4978e2c (feature2) change file2 no.1
ee4a50e change file1 no.2
dc397c1 change file1 no.1
525c358 (master) change: add file1 &amp; file2
# 其中, 422a454 就是误合并的 commitid
# 目前我们需要做的就是撤销已提交的 commit, 回滚到 feature2 误合并到 feature1 分支的 commit 版本。
$ git reset --mixed 422a454
Unstaged changes after reset:
M  file1.txt
$ git log --oneline
422a454 (HEAD -&gt; feature1) Merge branch 'feature2' into feature1
4978e2c (feature2) change file2 no.1
ee4a50e change file1 no.2
dc397c1 change file1 no.1
525c358 (master) change: add file1 &amp; file2
$ git diff file1.txt
diff --git a/file1.txt b/file1.txt
index 4a1ca46..6954af7 100644
--- a/file1.txt
+++ b/file1.txt
@@ -1,3 +1,4 @@
file1 init
add file1.txt code 1
add file2.txt code 2
+add file1.txt no.3 &amp; code end   # 可以看见, feature1 最后一次提交已经是未暂存状态了
# 此时, 我们就可以使用 git stash, 将撤销的代码存储起来,
$ git stash save 'save file1.txt reset code'
Saved working directory and index state On feature1: save file1.txt reset code
# 查看 stash 列表
$ git stash list
stash@{0}: On feature1: save file1.txt reset code
# 查看 status, 可以看见在工作空间已经没有了
$ git status
On branch feature1
nothing to commit, working tree clean

# 然后再撤销 merge 相关的信息
$ git reset --hard HEAD~
# 再查看此时本地的文件内容
$ cat file1.txt
file1 init
add file1.txt code 1
add file2.txt code 2
$ cat file2.txt
file2 init

# 接下来恢复 feature1 上被撤销的代码
$ git stash list
stash@{0}: On feature1: save file1.txt reset code
$ git stash apply stash{0}
On branch feature1
Changes not staged for commit:
(use "git add &lt;file&gt;..." to update what will be committed)
(use "git restore &lt;file&gt;..." to discard changes in working directory)
modified:   file1.txt

no changes added to commit (use "git add" and/or "git commit -a")
# 此时代码就恢复回来了
$ cat file1.txt
file1 init
add file1.txt code 1
add file2.txt code 2
add file1.txt no.3 &amp; code end
</pre></div>
</div>
<p>说明: git stash会贮存及不会贮存的文件范围</p>
<ul class="simple">
<li><dl class="simple">
<dt>会贮存:</dt><dd><ul>
<li><p>添加到暂存区的修改（staged changes）</p></li>
<li><p>git跟踪的但并未添加到暂存区的修改（unstaged changes）</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>不会贮存:</dt><dd><ul>
<li><p>在工作目录中新的文件（untracked files）</p></li>
<li><p>被忽略的文件（ignored files）</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>当然, 如果仅仅需要 删除某个 commit, 其实有更好的方法</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 假设, 当前已经到了 git commit -m 'change file1 no.3', 当前 log</span>
$<span class="w"> </span>git<span class="w"> </span>log
commit<span class="w"> </span>3e6be928866581f1779bb0f0e84d29d068d698e8<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature1<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kino@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">23</span>:30:31<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800

<span class="w">    </span>change<span class="w"> </span>file1<span class="w"> </span>no.3

commit<span class="w"> </span>ef733ffec4e80ed851f353f2d8b2dba46b831bb6
Merge:<span class="w"> </span>5e96765<span class="w"> </span>7d9cebd
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kino@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">23</span>:30:29<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800

<span class="w">    </span>Merge<span class="w"> </span>branch<span class="w"> </span><span class="s1">'feature2'</span><span class="w"> </span>into<span class="w"> </span>feature1
...

<span class="c1"># 我们可以直接 git revert 指定的 commit, 例如 上面 merge 的 commit id 是 ef733ffec4e80ed851f353f2d8b2dba46b831bb6</span>
$<span class="w"> </span>git<span class="w"> </span>revert<span class="w"> </span>-i<span class="w"> </span>ef733ffec4e80ed851f353f2d8b2dba46b831bb6<span class="w"> </span>-m<span class="w"> </span><span class="m">1</span>
<span class="c1"># 注意, 已经要加上 -m 1, 否则会报如下错:</span>
<span class="c1">#   error: commit ef733ffec4e80ed851f353f2d8b2dba46b831bb6 is a merge but no -m option was given.</span>
<span class="c1">#   fatal: revert failed</span>
<span class="c1"># 在这里解释下 -m 1 的含义:</span>
<span class="c1">#   从上面的 git log 可以看见 "Merge: 5e96765 7d9cebd" 的信息, 这代表着, 本次 merge 是使用当前分支的 5e96765(commit) 和 feature2 分支的 7d9cebd(commit) 合并而来, 我们可以做一下验证:</span>
<span class="c1">#     # 首先 cat-file 5e96765</span>
<span class="c1">#     $ git cat-file -p 5e96765</span>
<span class="c1">#     tree fa6ff2fd55be9834b45f0be9d347b1670594ed17</span>
<span class="c1">#     parent d27c172b6e876938eb39094801ca5e436a30b3c3</span>
<span class="c1">#     author kino &lt;kino@gmail.com&gt; 1669303829 +0800</span>
<span class="c1">#     committer kino &lt;kino@gmail.com&gt; 1669303829 +0800</span>
<span class="c1">#     change file1 no.2</span>
<span class="c1">#    # 然后取 tree 的 id 继续查看, 可以看到, 这个 tree 记录该 commit 的两个文件</span>
<span class="c1">#    $ git cat-file -p fa6ff2fd55be9834b45f0be9d347b1670594ed17</span>
<span class="c1">#    100644 blob 4a1ca461271ec4e0041822373470703dca5d0626  file1.txt</span>
<span class="c1">#    100644 blob 18ffc0add953f06f00be32437b9f79e09af27d32  file2.txt</span>
<span class="c1">#    # 然后取 file2.txt 的 id 继续查看, 可以看到, 这个 tree 记录 该 file2.txt 的内容为: file2 init</span>
<span class="c1">#    $ git cat-file -p 18ffc0add953f06f00be32437b9f79e09af27d32</span>
<span class="c1">#    file2 init</span>
<span class="c1">#    # 然后我们再 cat-file 7d9cebd</span>
<span class="c1">#    tree 1b5c42acd113046ec223223affe7b3ef579a293b</span>
<span class="c1">#    parent 9acd7882175075c0f3e2f44dfa0d91f3d0a673d1</span>
<span class="c1">#    author kino &lt;kino@gmail.com&gt; 1669303829 +0800</span>
<span class="c1">#    committer kino &lt;kino@gmail.com&gt; 1669303829 +0800</span>
<span class="c1">#    change file2 no.1</span>
<span class="c1">#    # 然后取 tree 的 id 继续查看, 可以看到, 这个 tree 记录该 commit 的两个文件</span>
<span class="c1">#    git cat-file -p 1b5c42acd113046ec223223affe7b3ef579a293b</span>
<span class="c1">#    100644 blob 0c481f7fe4602d041634c353e31846bf1b638c37  file1.txt</span>
<span class="c1">#    100644 blob c6b0b29e598db81ef8e54ec955df78cfac4ae316  file2.txt</span>
<span class="c1">#    # 然后取 file2.txt 的 id 继续查看, 可以看到, 这个 tree 记录 该 file2.txt 的内容</span>
<span class="c1">#    git cat-file -p c6b0b29e598db81ef8e54ec955df78cfac4ae316</span>
<span class="c1">#    file2 init</span>
<span class="c1">#    add file2.txt code 1</span>
<span class="c1"># 由此我们可以得出结论, 5e96765 就是 feature1 在 Merge 之前的状态, 而 7d9cebd 就是 feature2 在 Merge 之前的状态。</span>
<span class="c1"># 因为 一个 Merge 记录了两个分支的 commit 信息, 所以, 在 revert merge 的时候,需要明确的支出, 要revert 到哪个commit, 因为我们是想取消 feature2 里面的内容, 所以就是 -m 1</span>

<span class="c1"># ok, 回到正题, git revert 之后, 我们再查看 log</span>
$<span class="w"> </span>git<span class="w"> </span>log<span class="w"> </span>--oneline
b4dde93<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature1<span class="o">)</span><span class="w"> </span>Revert<span class="w"> </span><span class="s2">"Merge branch 'feature2' into feature1"</span>
3e6be92<span class="w"> </span>change<span class="w"> </span>file1<span class="w"> </span>no.3
ef733ff<span class="w"> </span>Merge<span class="w"> </span>branch<span class="w"> </span><span class="s1">'feature2'</span><span class="w"> </span>into<span class="w"> </span>feature1
5e96765<span class="w"> </span>change<span class="w"> </span>file1<span class="w"> </span>no.2
7d9cebd<span class="w"> </span><span class="o">(</span>feature2<span class="o">)</span><span class="w"> </span>change<span class="w"> </span>file2<span class="w"> </span>no.1
d27c172<span class="w"> </span>change<span class="w"> </span>file1<span class="w"> </span>no.1
9acd788<span class="w"> </span><span class="o">(</span>master<span class="o">)</span><span class="w"> </span>change:<span class="w"> </span>add<span class="w"> </span>file1<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>file2
<span class="c1"># 然后查看 file2.txt</span>
$<span class="w"> </span>cat<span class="w"> </span>file2.txt
file2<span class="w"> </span>init
</pre></div>
</div>
</section>
</section>
</section>
<section id="id18">
<h2 id="id18">五、git 高级操作<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h2>
<section id="id19">
<h3 id="id19">5.1 git 撤销操作<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h3>
<p><strong>disk:</strong></p>
<p><strong>暂存区:</strong></p>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>command</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>查看修改</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>查看状态</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code>  -&gt;  <code class="docutils literal notranslate"><span class="pre">Changes</span> <span class="pre">not</span> <span class="pre">staged</span> <span class="pre">for</span> <span class="pre">comit</span></code></p></td>
</tr>
<tr class="row-even"><td><p>撤销文件修改</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">&lt;change_file&gt;</span>  <span class="pre">or</span> <span class="pre">git</span> <span class="pre">restore</span> <span class="pre">&lt;change_file&gt;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>提交暂存区</p></td>
<td><p>git add &lt;change_file&gt;</p></td>
</tr>
</tbody>
</table>
<p><strong>local:</strong></p>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>command</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>撤销commit(保留磁盘上的修改和暂存区记录)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--soft</span> <span class="pre">HEAD~1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>撤销commit(清除暂存区记录, 只保留磁盘上的修改)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">HEAD~1``===</span> <span class="pre">``git</span> <span class="pre">reset</span> <span class="pre">--mixed</span> <span class="pre">HEAS~1</span></code></p></td>
</tr>
<tr class="row-even"><td><p>撤销commit(清除暂存区记录, 清除磁盘上的修改)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span> <span class="pre">HEAD~1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>生成新的 <code class="docutils literal notranslate"><span class="pre">commitId</span></code> ,将上一个 <code class="docutils literal notranslate"><span class="pre">commit+</span></code> 的内容变成 <code class="docutils literal notranslate"><span class="pre">commit-</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span> <span class="pre">HEAD</span></code></p></td>
</tr>
<tr class="row-even"><td><p>提交远端git</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span></code> :</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span></code> : 只能回到之前某一个commit的状态。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span></code> :撤销中间任意一个commit。 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span> <span class="pre">70a0;(git</span> <span class="pre">revert</span> <span class="pre">HEAD~1)</span></code></p></li>
</ol>
<p>如果操作项目的分支是公共分支，只能通过  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span></code>  生成一个新的 commitId，从这个结果上撤销我们之前的修改。</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span> <span class="pre">HEAD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code></p></li>
</ol>
<p>如果操作项目的分支是个人分支，可以通过 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span></code> 撤销我们之前的修改</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span> <span class="pre">HEAD~1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">-f</span></code></p></li>
</ol>
</section>
<section id="git-commit">
<h3 id="git-commit">5.2 git 找回丢失文件(commit了)<a class="headerlink" href="#git-commit" title="Link to this heading">¶</a></h3>
<p>恢复因为执行  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span> <span class="pre">COMMITID</span></code>  丢失的文件</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 重新创建一个项目</span>
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>..<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>git-study<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>git-study<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>git-study<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>git<span class="w"> </span>init
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'master message 1'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>master_1.txt
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>master_1.txt
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">'first commit'</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'master message 2'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>master_2.txt
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>master_2.txt
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">'No.2 commit'</span>

<span class="c1"># 在这两次commit的基础上, reset 到第一次(first commit)上</span>
$<span class="w"> </span>git<span class="w"> </span>log<span class="w">   </span><span class="c1"># 获取第一次commitid</span>
$<span class="w"> </span>git<span class="w"> </span>reset<span class="w"> </span>--hard<span class="w"> </span>4a9bcb880db85a1ca77807dea9b3adce29dc4fda
<span class="c1"># 再次查看 log 信息, 此时可以看见只有一次commit了, 第二次 commit(No.2 commit) 已经丢失</span>
$<span class="w"> </span>git<span class="w"> </span>log<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span>
</pre></div>
</div>
<p>git 提供了  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reflog</span></code>  用来记录你的每一次改变目录树的命令，使用好他就可以很方便的恢复你的提交：</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>4a9bcb8<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>master<span class="o">)</span><span class="w"> </span>HEAD@<span class="o">{</span><span class="m">0</span><span class="o">}</span>:<span class="w"> </span>reset:<span class="w"> </span>moving<span class="w"> </span>to<span class="w"> </span>4a9bcb880db85a1ca77807dea9b3adce29dc4fda
80258ce<span class="w"> </span>HEAD@<span class="o">{</span><span class="m">1</span><span class="o">}</span>:<span class="w"> </span>commit:<span class="w"> </span>No.2<span class="w"> </span>commit
4a9bcb8<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>master<span class="o">)</span><span class="w"> </span>HEAD@<span class="o">{</span><span class="m">2</span><span class="o">}</span>:<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>initial<span class="o">)</span>:<span class="w"> </span>first<span class="w"> </span>commit
</pre></div>
</div>
<p>可以看到最上面一条记录是将 HEAD 重新指向第一次的commit了, 同时也有显示第二次 commit 的 commitid, 有了这个 commitid, 就可以回滚了。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>reset<span class="w"> </span>--hard<span class="w"> </span>80258ce
HEAD<span class="w"> </span>is<span class="w"> </span>now<span class="w"> </span>at<span class="w"> </span>80258ce<span class="w"> </span>No.2<span class="w"> </span>commit
$<span class="w"> </span>git<span class="w"> </span>log
commit<span class="w"> </span>80258ce0146f373d15a1991d61af4061687782bc<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kino@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:26:10<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800

<span class="w">    </span>No.2<span class="w"> </span>commit

commit<span class="w"> </span>4a9bcb880db85a1ca77807dea9b3adce29dc4fda
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kino@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:25:06<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800

<span class="w">    </span>first<span class="w"> </span>commit
</pre></div>
</div>
<p>可以看到, commit 已被找回.</p>
<p>但是通常情况下, 可能会出现在  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span></code>  之后, 还有新的 commit, 如果直接  <code class="docutils literal notranslate"><span class="pre">reset</span></code>  恢复的 commit, 肯定会造成新的 commit 又丢失, 所以如果我们只是想恢复这个一个 commit, 可以使用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">commitid</span></code>  来单独将这个 commitid 恢复到当前分支或者用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span></code>  来做合并</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>cherry-pick<span class="w"> </span>04b0396
<span class="o">[</span>master<span class="w"> </span>fbf401a<span class="o">]</span><span class="w"> </span>No.2<span class="w"> </span>commit
Date:<span class="w"> </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:38:14<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800
<span class="m">1</span><span class="w"> </span>file<span class="w"> </span>changed,<span class="w"> </span><span class="m">1</span><span class="w"> </span>insertion<span class="o">(</span>+<span class="o">)</span>
create<span class="w"> </span>mode<span class="w"> </span><span class="m">100644</span><span class="w"> </span>master_2.txt

$<span class="w"> </span>git<span class="w"> </span>log
commit<span class="w"> </span>fbf401a96bd9831c18ed02e9ee852cef8111ccb1<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kino@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:38:14<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800

<span class="w">    </span>No.2<span class="w"> </span>commit

commit<span class="w"> </span>1b5bfdb36ad01fb86d94b76654347f5de5475f37
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kino@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:38:05<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800

<span class="w">    </span>first<span class="w"> </span>commit
</pre></div>
</div>
</section>
<section id="id20">
<h3 id="id20">5.3 git 找回丢失文件(未commit,但添加暂存区了)<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h3>
<p>如果只  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>  了没有  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code> (如果连  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code> 都没有, 那只能找磁盘数据恢复的方式了), 这就不是仅仅一个  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reflog</span></code>  就能找回的了。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>..<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>git-study<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>git-study<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>git-study<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>git<span class="w"> </span>init
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'master message 1'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>master_1.txt
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>master_1.txt
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">'first commit'</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'master message 2'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>master_2.txt
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>master_2.txt
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">'No.2 commit'</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'master message 3'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>master_3.txt
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>.

<span class="c1"># 查看 log</span>
$<span class="w"> </span>git<span class="w"> </span>log<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span>
<span class="c1"># 取最新的一次 commit id</span>
$<span class="w"> </span>git<span class="w"> </span>reset<span class="w"> </span>--hard<span class="w"> </span>ee614a48f753479a111723ae7ad926e0750ffa6c
<span class="c1"># 查看 status</span>
$<span class="w"> </span>git<span class="w"> </span>status
On<span class="w"> </span>branch<span class="w"> </span>master
nothing<span class="w"> </span>to<span class="w"> </span>commit,<span class="w"> </span>working<span class="w"> </span>tree<span class="w"> </span>clean
<span class="c1"># 查看本地文件</span>
total<span class="w"> </span><span class="m">16</span>
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>kino<span class="w">  </span>staff<span class="w">    </span>17B<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:43<span class="w"> </span>master_1.txt
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>kino<span class="w">  </span>staff<span class="w">    </span>17B<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:43<span class="w"> </span>master_2.txt
<span class="c1"># 可以看见文件已经丢了</span>
</pre></div>
</div>
<p>git 提供了  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">fsck</span> <span class="pre">--lost-found</span></code>  命令, 他会通过一些神奇的方式把历史操作过的文件以某种算法算出来加到.git/lost-found文件夹里，输出的记录就像下面这个样子。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>❯<span class="w"> </span>git<span class="w"> </span>fsck<span class="w"> </span>--lost-found
Checking<span class="w"> </span>object<span class="w"> </span>directories:<span class="w"> </span><span class="m">100</span>%<span class="w"> </span><span class="o">(</span><span class="m">256</span>/256<span class="o">)</span>,<span class="w"> </span><span class="k">done</span>.
dangling<span class="w"> </span>blob<span class="w"> </span>adbd4c8bf64367fb685336a67f02c5716dc47d73
</pre></div>
</div>
<p>这里返回的第一行带有  <code class="docutils literal notranslate"><span class="pre">blob</span></code>  的信息，我们可以用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">show</span></code> 来查看里面的内容</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>show<span class="w"> </span>adbd4c8bf64367fb685336a67f02c5716dc47d73
master<span class="w"> </span>message<span class="w"> </span><span class="m">3</span>

<span class="c1"># 比如可以将内容追加到新文件中</span>
$<span class="w"> </span>git<span class="w"> </span>show<span class="w"> </span>adbd4c8bf64367fb685336a67f02c5716dc47d73<span class="w"> </span>&gt;<span class="w"> </span>master_3.txt
</pre></div>
</div>
<p>小记: 如果你的提交记录多的话,  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">fsck</span> <span class="pre">--lost-found</span></code>  可以看见很多内容, 如下</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>fsck<span class="w"> </span>--lost-found
Checking<span class="w"> </span>object<span class="w"> </span>directories:<span class="w"> </span><span class="m">100</span>%<span class="w"> </span><span class="o">(</span><span class="m">256</span>/256<span class="o">)</span>,<span class="w"> </span><span class="k">done</span>.
Checking<span class="w"> </span>objects:<span class="w"> </span><span class="m">100</span>%<span class="w"> </span><span class="o">(</span><span class="m">35559</span>/35559<span class="o">)</span>,<span class="w"> </span><span class="k">done</span>.
dangling<span class="w"> </span>blob<span class="w"> </span>601e8abff177a0b2f8a31944654c0cdf0dd1f197
dangling<span class="w"> </span>tree<span class="w"> </span>6c247c35ae51aa86736f745802bb59b97b6598ee
dangling<span class="w"> </span>blob<span class="w"> </span>7a379e6f07391f3bca1fbcc076fcde8f719ffb69
dangling<span class="w"> </span>blob<span class="w"> </span>c66fa02bf74853789b63615a80998b3fbd3d8823
dangling<span class="w"> </span>blob<span class="w"> </span>4996ec43a907f8f6312c3bf137e2f76c7f4c9c9c
dangling<span class="w"> </span>commit<span class="w"> </span>69a110054ca792e6b1060d20ec24ddc9710ada4d
dangling<span class="w"> </span>blob<span class="w"> </span>87ed1263b56d0a98cd163440f872f135a34b61da
dangling<span class="w"> </span>blob<span class="w"> </span>aff0bc224d142929e3f82b8855dd1e97d8b3635b
dangling<span class="w"> </span>blob<span class="w"> </span>eef114f8614a15a11ccfbb7cf5e34302072176e1
dangling<span class="w"> </span>blob<span class="w"> </span>b50db5dad43e13fde45141039f684be48e293739
dangling<span class="w"> </span>blob<span class="w"> </span>820f0136b61394e482fd18e28a7ba81fbb31f688
dangling<span class="w"> </span>blob<span class="w"> </span>2d26cd809139b86218d3460c85baed90d018f007
dangling<span class="w"> </span>blob<span class="w"> </span>603ca9d770947939d8da7ff3aef3775bb27c427e
dangling<span class="w"> </span>blob<span class="w"> </span>e54821ed942c6582d01f60b6715e16301cdcfc4d
dangling<span class="w"> </span>blob<span class="w"> </span>e06be73bb272c7837ab38226c1c1bb13f845574e
dangling<span class="w"> </span>blob<span class="w"> </span>399aede4e687465bf7c895251bef685b0de089b6
dangling<span class="w"> </span>blob<span class="w"> </span>5ea2239d63a9a119a54a52fde6ebf208a940832a
dangling<span class="w"> </span>blob<span class="w"> </span>35ab95c7faf42b7dbbf4e0992527c719ffd4acbd
dangling<span class="w"> </span>blob<span class="w"> </span>9bb609de693b78eb1dc0e3dca7a9d684effd3f4a
dangling<span class="w"> </span>blob<span class="w"> </span>aac499592477199b2630791aecde2db8a608dfa9
dangling<span class="w"> </span>commit<span class="w"> </span>10c581dcdf08ea1bed594a359e09698afd4f794e
dangling<span class="w"> </span>blob<span class="w"> </span>06eb7790a9f71bf796749940102030c6e9503022
</pre></div>
</div>
<p>可以看到这里有 <code class="docutils literal notranslate"><span class="pre">blob</span></code> 、 <code class="docutils literal notranslate"><span class="pre">commit</span></code> 、 <code class="docutils literal notranslate"><span class="pre">tree</span></code> 类型的数据，其实还有 <code class="docutils literal notranslate"><span class="pre">tag</span></code> 等类型的, 这里需要了解下 git 的底层存储</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">commit</span></code>  数据结构在每次提交之后都会生成一个, 当我们进行  <code class="docutils literal notranslate"><span class="pre">commit</span></code>  之后, 首先会创建一个  <code class="docutils literal notranslate"><span class="pre">commit</span></code>  组件, 之后创建一个  <code class="docutils literal notranslate"><span class="pre">tree</span></code>  组件, 把所有的文件信息都存在里面, 每个  <code class="docutils literal notranslate"><span class="pre">blob</span></code>  都代表一个文件, 都可以在  <code class="docutils literal notranslate"><span class="pre">tree</span></code>  里面找到。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">blob</span></code>  组件并不会对文件信息进行存储, 而是只对文件的内容进行记录, 文件信息存储在  <code class="docutils literal notranslate"><span class="pre">tree</span></code>  里.</p></li>
</ul>
</section>
<section id="id21">
<h3 id="id21">5.4 终极大招<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h3>
<p>如果 5.3 并没有找到你想要的内容, 那只能再去看看最近修改的文件了</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>find<span class="w"> </span>.git/objects<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>ls<span class="w"> </span>-lt<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>3q
-r--r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>kino<span class="w">  </span>staff<span class="w">   </span><span class="m">33</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:43<span class="w"> </span>.git/objects/ad/bd4c8bf64367fb685336a67f02c5716dc47d73
-r--r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>kino<span class="w">  </span>staff<span class="w">   </span><span class="m">33</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:43<span class="w"> </span>.git/objects/cc/6e4eeea4f70e784fade7a18bdba6c28f7642e8
-r--r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>kino<span class="w">  </span>staff<span class="w">   </span><span class="m">33</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:43<span class="w"> </span>.git/objects/24/b6cb352efeff7a2b24b99e8ff814ab1fc2a2fd
</pre></div>
</div>
<p>使用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cat-file</span> <span class="pre">-t</span> <span class="pre">commitid</span></code>  可以看见是什么类型的</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>cat-file<span class="w"> </span>-t<span class="w"> </span>adbd4c8bf64367fb685336a67f02c5716dc47d73
blob

$<span class="w"> </span>git<span class="w"> </span>cat-file<span class="w"> </span>-t<span class="w"> </span>cc6e4eeea4f70e784fade7a18bdba6c28f7642e8
blob

$<span class="w"> </span>git<span class="w"> </span>cat-file<span class="w"> </span>-t<span class="w"> </span>24b6cb352efeff7a2b24b99e8ff814ab1fc2a2fd
blob
</pre></div>
</div>
<p>再使用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cat-file</span> <span class="pre">-p</span> <span class="pre">commitid</span></code>  查看内容</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>cat-file<span class="w"> </span>-p<span class="w"> </span>adbd4c8bf64367fb685336a67f02c5716dc47d73
master<span class="w"> </span>message<span class="w"> </span><span class="m">3</span>

$<span class="w"> </span>git<span class="w"> </span>cat-file<span class="w"> </span>-p<span class="w"> </span>cc6e4eeea4f70e784fade7a18bdba6c28f7642e8
master<span class="w"> </span>message<span class="w"> </span><span class="m">2</span>

$<span class="w"> </span>git<span class="w"> </span>cat-file<span class="w"> </span>-p<span class="w"> </span>24b6cb352efeff7a2b24b99e8ff814ab1fc2a2fd
master<span class="w"> </span>message<span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
</section>
<section id="id22">
<h3 id="id22">5.5 git 迁移(保留 commit)<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h3>
</section>
<section id="clone">
<h3 id="clone">5.5.1 clone 原来的项目<a class="headerlink" href="#clone" title="Link to this heading">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>--bare<span class="w"> </span>git://github.com/username/project.git
</pre></div>
</div>
</section>
<section id="id23">
<h3 id="id23">5.5.2 推送到新的gitlab<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>project
git<span class="w"> </span>push<span class="w"> </span>--mirror<span class="w"> </span>git@example.com/username/newproject.git
</pre></div>
</div>
<p>会提示没有权限, 在gitlab中把项目的权限保护关掉就好了</p>
</section>
<section id="id24">
<h3 id="id24">5.5.3 本地代码更换gitlab地址<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>remote<span class="w"> </span>set-url<span class="w"> </span>origin<span class="w"> </span>git@example.com/username/newproject.git
</pre></div>
</div>
</section>
<section id="git-rebase">
<h3 id="git-rebase">5.6 git rebase<a class="headerlink" href="#git-rebase" title="Link to this heading">¶</a></h3>
<p>准备4个场景:</p>
<ul class="simple">
<li><p>merge 时只有一个分支变更</p></li>
<li><p>merge 时两个分支有变更</p></li>
<li><p>rebase 时只有一个分支变更</p></li>
<li><p>rebase 时两个分支有变更</p></li>
</ul>
</section>
<section id="merge">
<h3 id="merge">5.6.1 merge 时只有一个分支变更<a class="headerlink" href="#merge" title="Link to this heading">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-rf<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>first-project
git<span class="w"> </span>init
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c0"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"init"</span>

<span class="c1"># 创建一个分支</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature

<span class="c1"># 在 master 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>main
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c1"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c1 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c2"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c2 commit"</span>

<span class="c1"># feature 合并 master 新增记录</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature
git<span class="w"> </span>merge<span class="w"> </span>main

<span class="c1"># 查看日志, 可以看见 feature 分支上已经有了 master 的两个提交了</span>
git<span class="w"> </span>log<span class="w"> </span>--graph<span class="w"> </span>--pretty<span class="o">=</span>oneline<span class="w"> </span>--abbrev-commit
*<span class="w"> </span>c001f6f<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature,<span class="w"> </span>main<span class="o">)</span><span class="w"> </span>c2<span class="w"> </span>commit
*<span class="w"> </span>a4d98be<span class="w"> </span>c1<span class="w"> </span>commit
*<span class="w"> </span>7171bfa<span class="w"> </span>init

cat<span class="w"> </span>README.md
c0
c1
c2
</pre></div>
</div>
</section>
<section id="id25">
<h3 id="id25">5.6.2 merge 时两个分支有变更<a class="headerlink" href="#id25" title="Link to this heading">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-rf<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>first-project
git<span class="w"> </span>init
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c0"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"init"</span>

<span class="c1"># 创建两个分支</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature1
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature2

<span class="c1"># 在 feature1 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature1
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c1"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c1 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c2"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c2 commit"</span>

<span class="c1"># 在 feature2 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature2
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c3"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c3 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c4"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c4 commit"</span>

<span class="c1"># 在 feature1 上添加一个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature1
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c5"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c5 commit"</span>

<span class="c1"># 查看两个分支的commit时间</span>
git<span class="w"> </span>log<span class="w"> </span>feature1
commit<span class="w"> </span>a16e20a00329b0a60cbf8f541ff999e065a907b0<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature1<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:13<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c5<span class="w"> </span>commit

commit<span class="w"> </span>bddb67864d6a8e5923618564304090a869dedf68
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:02<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>4a0978f9892241abd481251ed96f5a7b92199011
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:16:58<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>cde011b84e70d5dfbd966b91f5d9ab0aeefff25a<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:16:49<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

git<span class="w"> </span>log<span class="w"> </span>feature2
commit<span class="w"> </span>02f337014fa6acbdcbcf79d4ecd6668cdd37d6cb<span class="w"> </span><span class="o">(</span>feature2<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:09<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c4<span class="w"> </span>commit

commit<span class="w"> </span>e4567ef53ad207ea88cc042140183f8e047a5b69
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:06<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit

commit<span class="w"> </span>cde011b84e70d5dfbd966b91f5d9ab0aeefff25a<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:16:49<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

<span class="c1"># 可以看见, feature2 上的两个 commit 时间晚于 feature1 的 c2/c3 commit, 但是又早于 feature1 上的 c5 commit</span>
<span class="c1"># 现在将 feature1 合并到 feature2</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature2
git<span class="w"> </span>merge<span class="w"> </span>feature1
<span class="c1"># 冲突提示</span>
Already<span class="w"> </span>on<span class="w"> </span><span class="s1">'feature2'</span>
Auto-merging<span class="w"> </span>README.md
CONFLICT<span class="w"> </span><span class="o">(</span>content<span class="o">)</span>:<span class="w"> </span>Merge<span class="w"> </span>conflict<span class="w"> </span><span class="k">in</span><span class="w"> </span>README.md
Automatic<span class="w"> </span>merge<span class="w"> </span>failed<span class="p">;</span><span class="w"> </span>fix<span class="w"> </span>conflicts<span class="w"> </span>and<span class="w"> </span><span class="k">then</span><span class="w"> </span>commit<span class="w"> </span>the<span class="w"> </span>result.
<span class="c1"># 解决冲突</span>
vim<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit

<span class="c1"># 再次查看feature2的提交记录, 发现多出来了一个 commit:faaa86d914cce98ab6dd6159ff76a4fe351f809e</span>
<span class="c1"># 并且时间顺序是按两个分支的时间排好序的(合并后时间有序未被打乱)</span>
commit<span class="w"> </span>6f9869531606418e4c40fabb9cfaabfa1425545a<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature2<span class="o">)</span>
Merge:<span class="w"> </span>02f3370<span class="w"> </span>a16e20a
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:20:13<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>Merge<span class="w"> </span>branch<span class="w"> </span><span class="s1">'feature1'</span><span class="w"> </span>into<span class="w"> </span>feature2

commit<span class="w"> </span>a16e20a00329b0a60cbf8f541ff999e065a907b0<span class="w"> </span><span class="o">(</span>feature1<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:13<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c5<span class="w"> </span>commit

commit<span class="w"> </span>02f337014fa6acbdcbcf79d4ecd6668cdd37d6cb
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:09<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c4<span class="w"> </span>commit

commit<span class="w"> </span>e4567ef53ad207ea88cc042140183f8e047a5b69
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:06<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit

commit<span class="w"> </span>bddb67864d6a8e5923618564304090a869dedf68
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:02<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>4a0978f9892241abd481251ed96f5a7b92199011
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:16:58<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>cde011b84e70d5dfbd966b91f5d9ab0aeefff25a<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:16:49<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init
</pre></div>
</div>
</section>
<section id="rebase">
<h3 id="rebase">5.6.3 rebase 时只有一个分支变更<a class="headerlink" href="#rebase" title="Link to this heading">¶</a></h3>
<p>rebase 分支未作出commit</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-rf<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>first-project
git<span class="w"> </span>init
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c0"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"init"</span>

<span class="c1"># 创建一个分支</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature

<span class="c1"># 在 master 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>master
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c1"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c1 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c2"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c2 commit"</span>

<span class="c1"># feature 合并 master 新增记录</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature
git<span class="w"> </span>rebase<span class="w"> </span>master

<span class="c1"># 查看日志, 可以看见 feature 分支上已经有了 master 的两个提交了, 并且指针feature和master同时指向HEAD</span>
git<span class="w"> </span>log<span class="w"> </span>--graph<span class="w"> </span>--pretty<span class="o">=</span>oneline<span class="w"> </span>--abbrev-commit
*<span class="w"> </span>715cf72<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature,<span class="w"> </span>master<span class="o">)</span><span class="w"> </span>c2<span class="w"> </span>commit
*<span class="w"> </span>5f626b8<span class="w"> </span>c1<span class="w"> </span>commit
*<span class="w"> </span>6a2e050<span class="w"> </span>init
</pre></div>
</div>
</section>
<section id="id26">
<h3 id="id26">5.6.4 rebase 时两个分支有变更<a class="headerlink" href="#id26" title="Link to this heading">¶</a></h3>
<p>rebase 分支作出commit</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-rf<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>first-project
git<span class="w"> </span>init
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c0"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"init"</span>

<span class="c1"># 创建一个分支</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature
<span class="c1"># 在 feature 上添加一个 commit</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c3"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c3 commit"</span>

<span class="c1"># 在 master 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>master
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c1"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c1 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c2"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c2 commit"</span>

<span class="c1"># 查看 feature 分支的log</span>
git<span class="w"> </span>log<span class="w"> </span>feature
commit<span class="w"> </span>d97013d9428e61d4d97ebe6a67b5c27d1b98c7cb<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:26:59<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit

commit<span class="w"> </span>fb9a4a69bbb4d187f0f3a94dbf0cb2938f114e62
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:26:55<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

<span class="c1"># 查看 master 分支的log</span>
git<span class="w"> </span>log<span class="w"> </span>master
commit<span class="w"> </span>0ec71a9b42831756babb31aba75d56e0e73a6c68<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:27:10<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>fdf2a2ec1967c0f29e60d65fa285f627e2cd6767
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:27:07<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>fb9a4a69bbb4d187f0f3a94dbf0cb2938f114e62
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:26:55<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

<span class="c1"># 可以看见 feature 分支上的 c3 commit 时间早于 master 分支的 c1/c2 commit</span>
<span class="c1"># feature 合并 master 新增记录</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature
git<span class="w"> </span>rebase<span class="w"> </span>master
<span class="c1"># 提示有冲突, 解决冲突</span>
vim<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>rebase<span class="w"> </span>--continue
<span class="c1"># 再次查看 feature 分支的 log, 发现 c3 commit 时间早于 master 分支的 c1/c2 commit, 但是排在了最后面(没按时间排序)</span>
<span class="c1"># 并且, c3 commit 的 commit id 已经变了.</span>
<span class="c1"># rebase 原理: 一次 rebase 中, 会拿到 当前分支最新的 commit、被 rebase 分支最新的 commit、以及它们最近的一个父commit,</span>
<span class="c1">#     然后将当前分支 从父commit到当前最新commit 移动到被 rebase 分支最新代码之后(此时被移动过来的commit是属于被重新commit了, 和原来的已经不一样了)</span>
<span class="c1">#     最后将当前分支的指针移动到最近的地方.</span>
commit<span class="w"> </span>e5fd30e03a32d1a902895dfa8ec51e50ba02bd41<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:26:59<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit

commit<span class="w"> </span>0ec71a9b42831756babb31aba75d56e0e73a6c68<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:27:10<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>fdf2a2ec1967c0f29e60d65fa285f627e2cd6767
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:27:07<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>fb9a4a69bbb4d187f0f3a94dbf0cb2938f114e62
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:26:55<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

<span class="c1"># 查看 feature 的log, 也能得出上面说的原理</span>
*<span class="w"> </span>e5fd30e<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature<span class="o">)</span><span class="w"> </span>c3<span class="w"> </span>commit
*<span class="w"> </span>0ec71a9<span class="w"> </span><span class="o">(</span>master<span class="o">)</span><span class="w"> </span>c2<span class="w"> </span>commit
*<span class="w"> </span>fdf2a2e<span class="w"> </span>c1<span class="w"> </span>commit
*<span class="w"> </span>fb9a4a6<span class="w"> </span>init
</pre></div>
</div>
</section>
<section id="id27">
<h3 id="id27">5.6.5 rebase 总结<a class="headerlink" href="#id27" title="Link to this heading">¶</a></h3>
<p>rebase 的时候, 找到 <strong>当前分支</strong> 和 <strong>被rebase分支</strong> 的父commit, 然后找到当前分支在父commit之后所有的commit记录, 把这些 commit 记录移动到被 rebase 分支上去, 这些 commit 记录已经不是原来的 commit 了(因为 commit id 已经改变了)。或者通俗来说: rebase 就是被rebase分支插入到当前分支之前, 例如: 从 master checkout 一个 feature 用作开发, 开发一段时间之后, 有人给 master 提交代码了(如fixbug), 那么我们应该 rebase master 到当前分支, 当 master 最新的代码放到 feature 最前面.</p>
<p>根据上面说的, rebase 是将 被rebase 分支的commit 放到最前面, 所以在后续开发中, 如果 feature 分支需要回退版本, 那么这将很好追溯代码; 如果我们使用 merge 将master 提交的代码合并到 feature 分支, 那回退版本就可以能把别人提交的代码也删掉了.</p>
<p>同样的, 因为 rebase 会让当前分支的 commit 重新生成, 这会改变分支的历史, 在 push 到远程分支的时候, 会提示你的代码和远程分支不一致, 这就需要强制 push 了( <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">--force-with-lease</span> <span class="pre">origin</span> <span class="pre">mybranch</span></code> ), 所以, <strong>千万不要在公共分支上使用 rebase, 历史被打乱是一件很严重的事情!!!</strong></p>
<ol class="arabic simple">
<li><p>在公共分支上不要使用 rebase, 应该用 merge;</p></li>
<li><p>功能分支上, 可以选择 rebase(不介意时间顺序, 把自己的 commit 顶到最后).</p></li>
</ol>
</section>
<section id="id28">
<h3 id="id28">5.6.6 rebase 的命令行操作<a class="headerlink" href="#id28" title="Link to this heading">¶</a></h3>
<p>开启命令行操作</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>your_commit_id
</pre></div>
</div>
<div class="admonition-example admonition hint">
<p class="admonition-title">example</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>HEAD~3
</pre></div>
</div>
</div>
<p>之后会提示很多信息</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1">### 可以选择的操作</span>
<span class="c1"># Commands:</span>
<span class="c1">### p: 选择一个提交并且应用它: pick 111111e c1 first-commit -&gt; 改变分支的 commit 信息为 first-commit,其commit id 是 111111e</span>
<span class="c1"># p, pick &lt;commit&gt; = use commit</span>
<span class="c1"># r, reword &lt;commit&gt; = use commit, but edit the commit message</span>
<span class="c1"># e, edit &lt;commit&gt; = use commit, but stop for amending</span>
<span class="c1"># s, squash &lt;commit&gt; = use commit, but meld into previous commit</span>
<span class="c1"># f, fixup [-C | -c] &lt;commit&gt; = like "squash" but keep only the previous</span>
<span class="c1">#                    commit's log message, unless -C is used, in which case</span>
<span class="c1">#                    keep only this commit's message; -c is same as -C but</span>
<span class="c1">#                    opens the editor</span>
<span class="c1"># x, exec &lt;command&gt; = run command (the rest of the line) using shell</span>
<span class="c1"># b, break = stop here (continue rebase later with 'git rebase --continue')</span>
<span class="c1"># d, drop &lt;commit&gt; = remove commit</span>
<span class="c1"># l, label &lt;label&gt; = label current HEAD with a name</span>
<span class="c1"># t, reset &lt;label&gt; = reset HEAD to a label</span>
<span class="c1"># m, merge [-C &lt;commit&gt; | -c &lt;commit&gt;] &lt;label&gt; [# &lt;oneline&gt;]</span>
<span class="c1"># .       create a merge commit using the original merge commit's</span>
<span class="c1"># .       message (or the oneline, if no original merge commit was</span>
<span class="c1"># .       specified); use -c &lt;commit&gt; to reword the commit message</span>
<span class="c1">#</span>
<span class="c1"># These lines can be re-ordered; they are executed from top to bottom.</span>
<span class="c1">#</span>
<span class="c1"># If you remove a line here THAT COMMIT WILL BE LOST.</span>
<span class="c1">#</span>
<span class="c1"># However, if you remove everything, the rebase will be aborted.</span>
<span class="c1">#</span>
</pre></div>
</div>
<p>假设现在有如下 commit 记录</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>..
rm<span class="w"> </span>-rf<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>first-project
git<span class="w"> </span>init
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c0"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"init"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c1"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c1 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c2"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c2 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c3"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c3 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c4"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c4 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c5"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c5 commit"</span>

git<span class="w"> </span>log
commit<span class="w"> </span>84a6eefbec1d95b74f75b2f4ce290291bf70ac7d<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:16:51<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c5<span class="w"> </span>commit

commit<span class="w"> </span>f7dfd4a23515f8b4c5f35df7f10a0436887de8b9
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:16:50<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c4<span class="w"> </span>commit

commit<span class="w"> </span>9cbec48fce6bf102dc9160a2c60fb04d8038de14
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:16:50<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit

commit<span class="w"> </span>1d316c48f7879387bee619f68de1c1d635d01350
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:16:50<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>3e477718c5c4a00bc708e4e413e79104651e784b
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:16:50<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>e8e267817444fb8601ddd76ac98af570cfb546eb
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:16:50<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init
</pre></div>
</div>
<section id="squash">
<h4 id="squash">squash<a class="headerlink" href="#squash" title="Link to this heading">¶</a></h4>
<p>我想要将 c4 commit 和 c3 commit 合并成一个commit</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>e8e267817444fb8601ddd76ac98af570cfb546eb
pick<span class="w"> </span>3e47771<span class="w"> </span>c1<span class="w"> </span>commit
pick<span class="w"> </span>1d316c4<span class="w"> </span>c2<span class="w"> </span>commit
pick<span class="w"> </span>9cbec48<span class="w"> </span>c3<span class="w"> </span>commit
squash<span class="w"> </span>f7dfd4a<span class="w"> </span>c4<span class="w"> </span>commit
pick<span class="w"> </span>84a6eef<span class="w"> </span>c5<span class="w"> </span>commit

<span class="c1"># 修改合并的commit信息</span>

<span class="c1"># 查看 log</span>
commit<span class="w"> </span>779c9bf0f7503a0b7020a447666c7ef3c241b884<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:19:01<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c5<span class="w"> </span>commit

commit<span class="w"> </span>0e4b3536cb998f3ffab91746954366915d9eb360
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:19:01<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit
<span class="w">    </span>c4<span class="w"> </span>commit

commit<span class="w"> </span>348af55dbbb9472ca132ff6ad0aa159efe9d6fca
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:19:01<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>282990a0baf322e25c49c0245fecb9ff4bd0bab6
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:19:01<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>0ac0f9228c9be4b02632e01849036d8eeee73378
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:19:01<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

<span class="c1"># 查看 0e4b353 变更了哪些东西, 可以看见, 本次 commit, 修改了 README.md 文件, 添加了 c3/c4 两行代码</span>
commit<span class="w"> </span>0e4b3536cb998f3ffab91746954366915d9eb360
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:19:01<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit
<span class="w">    </span>c4<span class="w"> </span>commit

diff<span class="w"> </span>--git<span class="w"> </span>a/README.md<span class="w"> </span>b/README.md
index<span class="w"> </span>c3f2bc9..d226868<span class="w"> </span><span class="m">100644</span>
---<span class="w"> </span>a/README.md
+++<span class="w"> </span>b/README.md
@@<span class="w"> </span>-1,3<span class="w"> </span>+1,5<span class="w"> </span>@@
c0
c1
c2
+c3
+c4
</pre></div>
</div>
</section>
<section id="fixup">
<h4 id="fixup">fixup<a class="headerlink" href="#fixup" title="Link to this heading">¶</a></h4>
<p>也可以使用 fixup 代替 squash, fixup 不会保留合并的的提交信息, 可以使用此操作将一个小的提交合并到之前的提交中</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>0ac0f9228c9be4b02632e01849036d8eeee73378
pick<span class="w"> </span>fdf2a2e<span class="w"> </span>c1<span class="w"> </span>commit
pick<span class="w"> </span>0ec71a9<span class="w"> </span>c2<span class="w"> </span>commit
pick<span class="w"> </span>e5fd30e<span class="w"> </span>c3<span class="w"> </span>commit
fixup<span class="w"> </span>69799d0<span class="w"> </span>c4<span class="w"> </span>commit
pick<span class="w"> </span>cb1017b<span class="w"> </span>c5<span class="w"> </span>commit
</pre></div>
</div>
</section>
<section id="edit">
<h4 id="edit">edit<a class="headerlink" href="#edit" title="Link to this heading">¶</a></h4>
<p>当然还可以修改 commit 信息</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>0ac0f9228c9be4b02632e01849036d8eeee73378
pick<span class="w"> </span>fdf2a2e<span class="w"> </span>c1<span class="w"> </span>commit
pick<span class="w"> </span>0ec71a9<span class="w"> </span>c2<span class="w"> </span>commit
pick<span class="w"> </span>e5fd30e<span class="w"> </span>c3<span class="w"> </span>commit
edit<span class="w"> </span>69799d0<span class="w"> </span>c4<span class="w"> </span>commit
pick<span class="w"> </span>cb1017b<span class="w"> </span>c5<span class="w"> </span>commit

<span class="c1"># 执行以下命令开始操作(可以执行多次)</span>
git<span class="w"> </span>commit<span class="w"> </span>--amend
<span class="c1"># 填写 commit 信息</span>
<span class="c1"># 修改到满意之后, 执行以下命令生效</span>
git<span class="w"> </span>rebase<span class="w"> </span>--continue
</pre></div>
</div>
</section>
<section id="reword">
<h4 id="reword">reword<a class="headerlink" href="#reword" title="Link to this heading">¶</a></h4>
<p>修改 commit 信息也可以直接使用 reword, 这将直接开始修改</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>0ac0f9228c9be4b02632e01849036d8eeee73378
pick<span class="w"> </span>fdf2a2e<span class="w"> </span>c1<span class="w"> </span>commit
pick<span class="w"> </span>0ec71a9<span class="w"> </span>c2<span class="w"> </span>commit
pick<span class="w"> </span>e5fd30e<span class="w"> </span>c3<span class="w"> </span>commit
reword<span class="w"> </span>69799d0<span class="w"> </span>c4<span class="w"> </span>commit
pick<span class="w"> </span>cb1017b<span class="w"> </span>c5<span class="w"> </span>commit
</pre></div>
</div>
</section>
<section id="drop">
<h4 id="drop">drop<a class="headerlink" href="#drop" title="Link to this heading">¶</a></h4>
<p>除此之外, 还可以删除某个 commit</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>0ac0f9228c9be4b02632e01849036d8eeee73378
pick<span class="w"> </span>fdf2a2e<span class="w"> </span>c1<span class="w"> </span>commit
pick<span class="w"> </span>0ec71a9<span class="w"> </span>c2<span class="w"> </span>commit
pick<span class="w"> </span>e5fd30e<span class="w"> </span>c3<span class="w"> </span>commit
drop<span class="w"> </span>69799d0<span class="w"> </span>c4<span class="w"> </span>commit
pick<span class="w"> </span>cb1017b<span class="w"> </span>c5<span class="w"> </span>commit
</pre></div>
</div>
</section>
</section>
<section id="cherry-pick">
<h3 id="cherry-pick">5.7 cherry-pick<a class="headerlink" href="#cherry-pick" title="Link to this heading">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span></code>  命令用于将指定的提交（commit）应用于当前分支。这个命令可以方便地将其他分支或者提交的修改应用到当前分支中，而无需将整个分支合并。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-rf<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>first-project
git<span class="w"> </span>init
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c0"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"init"</span>

<span class="c1"># 创建两个分支</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature1
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature2

<span class="c1"># 在 feature1 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature1
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c1"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c1 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c2"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c2 commit"</span>

<span class="c1"># 在 feature2 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature2
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c3"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c3 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c4"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c4 commit"</span>

git<span class="w"> </span>log<span class="w"> </span>feature1
commit<span class="w"> </span>762ae4b983da0bff873877779cd74e1aa8d10f88<span class="w"> </span><span class="o">(</span>feature1<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">01</span>:07:24<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>32fd3337cdf54589d9e6c46626886cd3c8936fa1
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">01</span>:07:24<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>526925ca652065f75129e49f25090d58d33ce31f<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">01</span>:07:24<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

git<span class="w"> </span>log<span class="w"> </span>feature2
commit<span class="w"> </span>f956ab14791d3d3718a57ddd8f062178f808cf44<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature2<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">01</span>:07:24<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c4<span class="w"> </span>commit

commit<span class="w"> </span>b0666c02180c1bddf60190e14bb9391379b54598
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">01</span>:07:24<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit

commit<span class="w"> </span>526925ca652065f75129e49f25090d58d33ce31f<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">01</span>:07:24<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init
</pre></div>
</div>
<p>现在讲 feature1 分支上的 762ae4b983da0bff873877779cd74e1aa8d10f88 应用到 feature2 上</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>checkout<span class="w"> </span>feature2
git<span class="w"> </span>cherry-pick<span class="w"> </span>762ae4b983da0bff873877779cd74e1aa8d10f88
</pre></div>
</div>
<p>如果有冲突, 需要解决冲突后, 使用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>  添加到暂存区, 然后使用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">--continue</span></code>  继续 cherry-pick 操作, 直到完成.</p>
<div class="admonition-git-cherry-pick admonition danger">
<p class="admonition-title">使用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span></code>  命令将提交应用到当前分支时，也可能会引入新的问题，因此在使用该命令时需要谨慎</p>
</div>
</section>
<section id="merge-request">
<h3 id="merge-request">Merge Request<a class="headerlink" href="#merge-request" title="Link to this heading">¶</a></h3>
<p><span class="defi">Merge Request</span> 分支合并请求，<span class="defi">Reviewer</span> 一般是项目、团队的负责人或者其他成员 来进行 <span class="defi">Code Review</span> 代码复审/审查/检视。</p>
<div class="admonition- admonition note">
<p class="admonition-title">前情提要</p>
<div class="line-block">
<div class="line">master 分支为起点创建一个 dev 分支作为 <strong>开发分支</strong>.</div>
<div class="line">在实际开发中，我们往往会新建一个特性分支，该分支专门为你服务，并且它专门用于处理某个bug，或者开发某个新的功能。即当有个新功能需要开发或者有bug以及优化重构部分代码时，我们就应该单独拿出一个新分支来专门处理这些事情。</div>
</div>
</div>
<ol class="arabic simple">
<li><p><strong>PULL</strong> <code class="docutils literal notranslate"><span class="pre">origin</span> <span class="pre">dev</span></code> into <code class="docutils literal notranslate"><span class="pre">local</span> <span class="pre">dev</span></code> =》 <code class="docutils literal notranslate"><span class="pre">origin</span> <span class="pre">dev</span></code> == <code class="docutils literal notranslate"><span class="pre">local</span> <span class="pre">dev</span></code> 。一定要 pull</p></li>
<li><p><strong>NEW</strong> <code class="docutils literal notranslate"><span class="pre">local</span> <span class="pre">feature</span></code> branch locally based on <code class="docutils literal notranslate"><span class="pre">dev</span></code></p></li>
<li><p><strong>PUBLISH &amp; PUSH</strong> <code class="docutils literal notranslate"><span class="pre">local</span> <span class="pre">feature</span></code> to <code class="docutils literal notranslate"><span class="pre">origin</span> <span class="pre">feature</span></code></p></li>
<li><p><strong>New merge request</strong> 选中源分支、目标分支。还能看到提交记录和文件改动信息。</p></li>
</ol>
<p>Merge done</p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column docutils">
<ol class="arabic simple">
<li><p><strong>CHECKOUT</strong> <code class="docutils literal notranslate"><span class="pre">local</span> <span class="pre">dev</span></code></p></li>
<li><p><strong>DEL</strong> <code class="docutils literal notranslate"><span class="pre">local</span> <span class="pre">feature</span></code> branch</p></li>
<li><p><strong>DEL</strong> <code class="docutils literal notranslate"><span class="pre">origin</span> <span class="pre">feature</span></code> branch</p></li>
</ol>
</div>
<div class="sd-col sd-d-flex-column docutils">
<div class="line-block">
<div class="line"><strong>推荐在每次完成后删除</strong></div>
<div class="line">因为我们创建这个分支的目的就是为了开发一个新模块或者修复一个BUG，当开发工作完成后删除该分支，处理别的事情时再新建一个就好了。</div>
</div>
</div>
</div>
</div>
<div class="admonition-question-new-feature-dev-dev-new-feature admonition hint">
<p class="admonition-title">question: 本来应该在 <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">feature</span></code> 上改，但不小心直接在 <code class="docutils literal notranslate"><span class="pre">dev</span></code> 上改了。能不能在不动 <code class="docutils literal notranslate"><span class="pre">dev</span></code> 直接放到 <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">feature</span></code></p>
<div class="line-block">
<div class="line">Solution：直接切换到  <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">feature</span></code></div>
<div class="line">git中存在工作区和暂存区，这两个区都是被所有本地分支共享的。</div>
<div class="line">当有内容修改时，修改信息就会放在工作区中，此时如果直接检出一个新的分支，就会把工作区的内容都带过去。</div>
</div>
</div>
<div class="admonition-question-new-feature-ing-fix-bug-commit-on-new-feature-hotfix-branch admonition hint">
<p class="admonition-title">question: 在 <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">feature</span></code> ing 但是临时收到消息要去 fix bug。既不想马上就 commit on <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">feature</span></code>， 也不想 把工作区的内容搬到  <code class="docutils literal notranslate"><span class="pre">hotfix</span></code> branch.</p>
<dl class="simple">
<dt>Solution：</dt><dd><ol class="arabic simple">
<li><p>在 <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">feature</span></code> <strong>stash &amp; checkout</strong> 暂存 &amp; 切出到 <code class="docutils literal notranslate"><span class="pre">hotfix</span></code></p></li>
<li><p>在 <code class="docutils literal notranslate"><span class="pre">hotfix</span></code> 完成任务：pull 》commit 》push 》merge request 》delete</p></li>
<li><p>checkout <code class="docutils literal notranslate"><span class="pre">new</span> <span class="pre">feature</span></code> 之后 <strong>stash pop</strong>，暂存区恢复到工作区</p></li>
</ol>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/home/runner/work/io/io/docs/source/utils/git.rst</span>, line 1914)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<div class="line-block">
<div class="line">暂存区是独立于所有分支，直接把还没 commit 的提出来放在一边。~感觉像another 工作区，此时无论什么分支都不会保留 stashed data，只有被 pop 之后才会恢复到工作区。</div>
</div>
</div>
<div class="admonition-stage-stash-different admonition danger">
<p class="admonition-title"><code class="docutils literal notranslate"><span class="pre">stage</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">stash</span></code> !! DIFFERENT</p>
<ul class="simple">
<li><p><span class="defi">Stashing</span> takes the dirty state of your working directory — that is, your modified tracked files and staged changes — and saves it on a stack of unfinished changes that you can reapply at any time (even on a different branch).</p></li>
<li><p>When recording your own work, the contents of modified files in your working tree are temporarily stored to a <span class="defi">staging area</span> called the “index” with git add.</p></li>
</ul>
<p><a class="reference external" href="https://blog.csdn.net/u010037020/article/details/81537809">Git中stash和stage的差别</a></p>
</div>
<div class="admonition- admonition note">
<p class="admonition-title">合并很多个提交到一个提交上再提交</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 假设现在开发完毕 并且已经在feature-many-commits上提交了多次</span>
git<span class="w"> </span>checkout<span class="w"> </span>dev
git<span class="w"> </span>pull<span class="w">                        </span><span class="c1"># dev保持最新的代码</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature-many-commits
git<span class="w"> </span>rebase<span class="w"> </span>dev<span class="w">          </span><span class="c1"># 将feature-many-commits上所有的commit，重新在新的dev的HEAD上commit一遍</span>
git<span class="w"> </span>checkout<span class="w"> </span>dev<span class="w">        </span><span class="c1"># 再次切换到dev上</span>
git<span class="w"> </span>merge<span class="w"> </span>feature-many-commits<span class="w"> </span><span class="c1"># 将feature-many-commits上的内容合并到dev上</span>
git<span class="w"> </span>push<span class="w">                </span><span class="c1"># 推送即可</span>
</pre></div>
</div>
<p><a class="reference external" href="https://juejin.cn/post/7028965736022278175">保姆级教程 | Merge Request 分支合并请求</a></p>
<p>合并分支</p>
<p>只对尚未推送或分享给 <strong>别人</strong> 的本地修改执行变基操作清理历史， 从不对已推送至别处的提交执行变基操作</p>
</div>
</section>
<section id="id30">
<h3 id="id30">六、参与开源项目<a class="headerlink" href="#id30" title="Link to this heading">¶</a></h3>
<p>这里我们以袋鼠云的 chunjun 做示例, 首先我们需要 <a class="reference external" href="https://github.com/DTStack/chunjun">fork</a> 该项目。</p>
<img alt="img/git/1.git-fork.png" src="img/git/1.git-fork.png"/>
<p>然后就可以在自己的仓库中看到 chunjun 项目了</p>
<p>![git-fork-after](../../img/git/2.git-fork-after.png)</p>
<p>clone 我们仓库中的 chunjun 项目</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/your-github-name/chunjun.git
</pre></div>
</div>
<p>添加远程分支</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>upstream<span class="w"> </span>https://github.com/DTStack/chunjun.git
</pre></div>
</div>
<p>添加了之后可以查看远程仓库</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>remote<span class="w"> </span>-v
origin<span class="w">  </span>https://github.com/your-github-name/chunjun.git<span class="w"> </span><span class="o">(</span>fetch<span class="o">)</span>
origin<span class="w">  </span>https://github.com/your-github-name/chunjun.git<span class="w"> </span><span class="o">(</span>push<span class="o">)</span>
upstream<span class="w">    </span>https://github.com/DTStack/chunjun.git<span class="w"> </span><span class="o">(</span>fetch<span class="o">)</span>
upstream<span class="w">    </span>https://github.com/DTStack/chunjun.git<span class="w"> </span><span class="o">(</span>push<span class="o">)</span>
</pre></div>
</div>
<p>不论是准备开发一个新功能，还是准备提交一个 pr，都需要优先更新远程分支到本地, 例如, 现在你需要基于master开发一个新的功能，你可以做如下操作</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 可以使用</span>
git<span class="w"> </span>pull
<span class="c1"># 或者使用</span>
git<span class="w"> </span>fetch<span class="w"> </span>upstream<span class="w"> </span>-p
git<span class="w"> </span>rebase<span class="w"> </span>upstream/master

<span class="c1"># 然后基于 master 创建一个 feature 分支(一般新功能需要先写issue和社区同学讨论该功能，比如和作者讨论你的想法是否能带来好的效果、以及该功能是否可行)</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature_your-issueid
</pre></div>
</div>
<p>等你开发完功能，并且完成测试之后，可以提交代码, 注意这里先不要直接push</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"your-commit-message"</span>
</pre></div>
</div>
<p>此时你开发一个功能可能耗时1h，期间已经有其他同学提交了代码，所以你还需要保持最新代码,</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>fetch<span class="w"> </span>upstream
git<span class="w"> </span>rebase<span class="w"> </span>upstream/feature_your-issueid
</pre></div>
</div>
<p>rebase 之后可能会有文件冲突，需要按需解决冲突，将所有冲突都解决之后再执行</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>rebase<span class="w"> </span>--continue
</pre></div>
</div>
<p>看到提示  <code class="docutils literal notranslate"><span class="pre">rebase</span> <span class="pre">successful</span></code>  之类的就表示冲突解决完成了，然后就提交到你的github 仓库中(注意不是upstream), rebase 之后可能无法正常推送, 需要  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">-f</span></code>  强制推送，这个操作有风险, 操作前请仔细检查以避免出现无关代码被强制覆盖的问题, 具体风险可以看 &lt;a href=”#56-git-rebase”&gt;5.6 rebase&lt;/a&gt; 相关的解释。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>feature_your-issueid
</pre></div>
</div>
<p>然后按页面提示，提交pr</p>
</section>
</section>
<section id="id31">
<h2 id="id31">Git版本管理及使用规范<a class="headerlink" href="#id31" title="Link to this heading">¶</a></h2>
<p>Git常用分支包括: <span class="defi">master</span> , <span class="defi">hotfix</span> , <span class="defi">release</span> , <span class="defi">develop</span> , <span class="defi">feature</span></p>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column docutils">
<ul>
<li><dl>
<dt><span class="defi">master</span>  ＝ <span class="defi">production</span> 主分支</dt><dd><div class="line-block">
<div class="line">stores the <strong>official release</strong> history</div>
<div class="line">只能从其他分支合并，不能在这个分支直接修改(no commits)</div>
<div class="line">理论上 <strong>每次并到</strong> <code class="docutils literal notranslate"><span class="pre">master</span></code> 都需要打 <span class="defi">Tag</span></div>
<div class="line">除 <strong>项目负责人</strong> 外其他开发人员不得向 <code class="docutils literal notranslate"><span class="pre">master</span></code> 分支合并内容。</div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><span class="defi">hotfix</span> for 紧急修 bugs</dt><dd><div class="line-block">
<div class="line">在 Production( <strong>已经上线了</strong> ) 发现新的 Bug 时候, <strong>立刻尽快</strong> 去处理发布上线</div>
<div class="line">从  <code class="docutils literal notranslate"><span class="pre">master</span></code> 拉， 直接进行测试及上线, 并回 <code class="docutils literal notranslate"><span class="pre">master</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">develop</span></code></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><span class="defi">release</span> for 提测及上线分支 - 预发布的版本</dt><dd><div class="line-block">
<div class="line">在 <code class="docutils literal notranslate"><span class="pre">develop</span></code> 开发完拉到 <code class="docutils literal notranslate"><span class="pre">release</span></code> 去测试，修改 Bug 等</div>
<div class="line">通过测试后可以正式上线，并回 <code class="docutils literal notranslate"><span class="pre">master</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">develop</span></code>, 然后 <strong>DELETE</strong></div>
<div class="line">同时，其它开发人员可以基于 Develop 分支新建 Feature (记住：一旦打了 Release 分支之后不要从 Develop 分支上合并新的改动到 Release 分支)</div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><span class="defi">develop</span> 主开发分支</dt><dd><div class="line-block">
<div class="line">包含所有要发布到下一个 Release 的代码</div>
<div class="line">每一次 pre-determined release date is approaching 从  <code class="docutils literal notranslate"><span class="pre">master</span></code> 拉去 sync, 然后去不断被 merged into。</div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt><span class="defi">feature</span> for 开发一个新的功能</dt><dd><div class="line-block">
<div class="line">从  <code class="docutils literal notranslate"><span class="pre">develop</span></code> 拉</div>
<div class="line">开发完成稳定后，要再并入 <code class="docutils literal notranslate"><span class="pre">develop</span></code> 分支, 然后 <strong>DELETE</strong></div>
</div>
</dd>
</dl>
</li>
</ul>
</div>
<div class="sd-col sd-d-flex-column docutils">
<p><strong>分支命名</strong> for <code class="docutils literal notranslate"><span class="pre">hotfix</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">release</span></code> &amp; <code class="docutils literal notranslate"><span class="pre">feature</span></code></p>
<div class="admonition-example-branch-type-target-yymmdd admonition hint">
<p class="admonition-title">Example: <code class="docutils literal notranslate"><span class="pre">[branch_type]/[target]_YYMMDD</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">hotfix/providerLose</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">release/pubMsg_20210701</span></code></p></li>
</ul>
</div>
<p><strong>Git代码提交规约</strong></p>
<ul class="simple">
<li><p>用户名为本人姓名，邮箱为公司邮箱或本人邮箱</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">[commit-type]:</span> <span class="pre">commit-message</span></code></p></li>
<li><p>若一次提交有多个功能修改，则每个功能提交描述作为单独的一行，每行以英文标识符“,”作为行尾结束符。</p></li>
</ul>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>commit-type</p></th>
<th class="head"><p>说明</p></th>
<th class="head"><p>示例</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ADD</p></td>
<td></td>
<td><p>ADD:增加文件</p></td>
</tr>
<tr class="row-odd"><td><p>DEL</p></td>
<td></td>
<td><p>DEL:删除文件</p></td>
</tr>
<tr class="row-even"><td><p>MOD</p></td>
<td><p>修改功能</p></td>
<td><p>MOD:修改功能</p></td>
</tr>
<tr class="row-odd"><td><p>FIX</p></td>
<td></td>
<td><p>FIX:issue2</p></td>
</tr>
<tr class="row-even"><td><p>PREF</p></td>
<td><p>优化 <strong>perf</strong> ormance</p></td>
<td><p>PREF:优化功能</p></td>
</tr>
<tr class="row-odd"><td><p>STYLE</p></td>
<td><p>修改代码格式</p></td>
<td><p>STYLE:修改代码格式</p></td>
</tr>
<tr class="row-even"><td><p>REFACTOR</p></td>
<td><p>重构</p></td>
<td><p>REFACTOR:重构代码</p></td>
</tr>
<tr class="row-odd"><td><p>DOCS</p></td>
<td><p>文档</p></td>
<td><p>DOCS:文档</p></td>
</tr>
</tbody>
</table>
<div class="line-block">
<div class="line"><span class="defi">STYLE</span> （不影响代码运行的变动）</div>
<div class="line"><span class="defi">REFACTOR</span> 既不增加新功能，也不修改bug的代码变动，一般重构需要使用新的独立分支处理）</div>
</div>
</div>
</div>
</div>
<div class="sd-container-fluid sd-sphinx-override sd-m-0 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column sd-col-9 sd-col-xs-9 sd-col-sm-9 sd-col-md-9 sd-col-lg-9 docutils">
<figure class="align-default" id="id53">
<img alt="../_images/git_workflow_1.png" src="../_images/git_workflow_1.png"/>
<figcaption>
<p><span class="caption-text">基于 Vincent Driessen 提出的 Git Flow 流程图</span><a class="headerlink" href="#id53" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</div>
<div class="sd-col sd-d-flex-column sd-col-3 sd-col-xs-3 sd-col-sm-3 sd-col-md-3 sd-col-lg-3 sd-m-0 docutils">
<p>从右往左，根据 timeline:</p>
<ul class="simple">
<li><p>在 0.1 版本上打算进行新的一轮 release (1.0) 。从 <code class="docutils literal notranslate"><span class="pre">master(0.1)</span></code> 叉到 <code class="docutils literal notranslate"><span class="pre">develop</span></code>。</p></li>
<li><p>根据预计设定的 features 从 <code class="docutils literal notranslate"><span class="pre">develop</span></code> 上叉不同的 <code class="docutils literal notranslate"><span class="pre">feature</span></code> 各自进行开发。</p></li>
<li><p>开发ing, 被通知之前的 0.1 版本有严重问题马上进行修复，从  <code class="docutils literal notranslate"><span class="pre">master(0.1)</span></code> 叉到 <code class="docutils literal notranslate"><span class="pre">hotfixes</span></code> 来修复，直接测试完就:</p>
<ul>
<li><p>并回 <code class="docutils literal notranslate"><span class="pre">master(0.2)</span></code> 修复并打 tag</p></li>
<li><p>并回 <code class="docutils literal notranslate"><span class="pre">develop</span></code>  使得下一轮更新也存在它。（因为中间 <code class="docutils literal notranslate"><span class="pre">develop</span></code> 不会再 sync form <code class="docutils literal notranslate"><span class="pre">master</span></code></p></li>
<li><p><strong>DELETE</strong> 结束，继续去开发。</p></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column sd-col-7 sd-col-xs-7 sd-col-sm-7 sd-col-md-7 sd-col-lg-7 docutils">
<figure class="align-default">
<img alt="../_images/git_workflow_2.png" src="../_images/git_workflow_2.png"/>
</figure>
<p>BTW, 本次 features 的 next ver. for next release 也可以从 <code class="docutils literal notranslate"><span class="pre">develop</span></code> 那个位置再 pull 去继续开发。</p>
</div>
<div class="sd-col sd-d-flex-column sd-col-5 sd-col-xs-5 sd-col-sm-5 sd-col-md-5 sd-col-lg-5 docutils">
<ul class="simple">
<li><p>预定的 <code class="docutils literal notranslate"><span class="pre">features</span></code> 在一些 commits 之后已经完成，单纯 feature上测试通过就并回 <code class="docutils literal notranslate"><span class="pre">develop</span></code></p></li>
<li><p>准备进入 release 阶段。从 <code class="docutils literal notranslate"><span class="pre">develop</span></code> 叉到 <code class="docutils literal notranslate"><span class="pre">release</span></code> 进行这一轮的测试和上线。
一旦开叉到 <code class="docutils literal notranslate"><span class="pre">release</span></code> 就只能允许 bugfixes，理论上不允许再加入别的 features，要留待下一轮 next Release</p></li>
<li><p>在 <code class="docutils literal notranslate"><span class="pre">release</span></code> 发现 bug 直接在 <code class="docutils literal notranslate"><span class="pre">release</span></code> 上 bugfixes, 修完也要并回 <code class="docutils literal notranslate"><span class="pre">develop</span></code> 使得下一轮更新也存在它。</p></li>
<li><p>通过 release 测试之后，从 <code class="docutils literal notranslate"><span class="pre">release</span></code> 叉到 <code class="docutils literal notranslate"><span class="pre">master(1.0)</span></code> 来发布新版本</p></li>
</ul>
</div>
</div>
</div>
<ul class="simple">
<li><p><a class="reference external" href="https://juejin.cn/post/7254190852762796090">Git版本管理及使用规范</a></p></li>
<li><p><a class="reference external" href="https://www.cnblogs.com/kevin-ying/p/14329768.html">大厂git分支管理规范：gitflow规范指南</a></p></li>
<li><p><a class="reference external" href="https://www.atlassian.com/git/tutorials/comparing-workflows/gitflow-workflow">Gitflow workflow</a></p></li>
</ul>
</section>
<section id="todo">
<h2 id="todo">TODO<a class="headerlink" href="#todo" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://nanmu.me/zh-cn/posts/2022/what-happens-on-gitlab-when-you-do-git-push/">当你git push时，Gitlab上发生了什么？</a></p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="index.html" title="杂"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> 杂 </span>
              </div>
            </a>
          
          
            <a href="hadoop.html" title="(Apache 基金会的) Hadoop"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> (Apache 基金会的) Hadoop </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2024, coconut.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.4.7.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>