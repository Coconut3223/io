<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Git &#8212; HomePage</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=83e35b93" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/katex-math.css?v=91adb8b6" />
    <link rel="stylesheet" type="text/css" href="../_static/css/rtd_sphinx_search.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/css/def.css?v=5a9d86bd" />
    <script src="../_static/documentation_options.js?v=7d86a446"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=6dbb43f8"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script src="../_static/js/rtd_search_config.js"></script>
    <script src="../_static/js/rtd_sphinx_search.min.js"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
    <link rel="next" title="(Apache 基金会的) Hadoop" href="hadoop.html" />
    <link rel="prev" title="杂" href="index.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#utils/git" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="HomePage"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">&#xe869</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Cocobook</span>
          <span class="md-header-nav__topic"> Git </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/Coconut3223/io/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    io
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../_static/versions.json",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">HomePage</a></li>
            
            <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Homepage</a></li>
            
            <li class="md-tabs__item"><a href="../AI/index.html" class="md-tabs__link">AI</a></li>
            
            <li class="md-tabs__item"><a href="../python/index.html" class="md-tabs__link">Python</a></li>
            
            <li class="md-tabs__item"><a href="../NLP/index.html" class="md-tabs__link">NLP</a></li>
            
            <li class="md-tabs__item"><a href="../SQL/index.html" class="md-tabs__link">SQL</a></li>
            
            <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Utils</a></li>
          <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">杂</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="HomePage" class="md-nav__button md-logo">
      
        <i class="md-icon">&#xe869</i>
      
    </a>
    <a href="../index.html"
       title="HomePage">Cocobook</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/Coconut3223/io/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    io
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Content</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../AI/index.html" class="md-nav__link">AI</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../AI/ML/index.html" class="md-nav__link">ML</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../AI/DL/index.html" class="md-nav__link">DL</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../CV/index.html" class="md-nav__link">CV</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../NLP/index.html" class="md-nav__link">NLP</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../python/index.html" class="md-nav__link">python</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../SQL/index.html" class="md-nav__link">SQL</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="index.html" class="md-nav__link">utils</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#utils-git--page-root" class="md-nav__link">Git</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#background" class="md-nav__link">Background</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#software-contiguration-management-scm" class="md-nav__link">软件配置管理, Software Contiguration Management,SCM</a>
        </li>
        <li class="md-nav__item"><a href="#git-client-tool" class="md-nav__link">git client tool</a>
        </li>
        <li class="md-nav__item"><a href="#mac" class="md-nav__link">mac</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#zsh" class="md-nav__link">zsh</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id1" class="md-nav__link">工作流程原理</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id2" class="md-nav__link">四大区域</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#details" class="md-nav__link">details</a>
        </li>
        <li class="md-nav__item"><a href="#git-command" class="md-nav__link">git command</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id3" class="md-nav__link">初始化</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#local-init" class="md-nav__link">本地新建一个 local init</a>
        </li>
        <li class="md-nav__item"><a href="#gui-init" class="md-nav__link">GUI init</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#git-config" class="md-nav__link">git config 配置</a>
        </li>
        <li class="md-nav__item"><a href="#id4" class="md-nav__link">日常操作</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id5" class="md-nav__link">提交代码</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id6" class="md-nav__link">基本流程</a>
        </li>
        <li class="md-nav__item"><a href="#id7" class="md-nav__link">一些过程中可能用到的查看指令</a>
        </li>
        <li class="md-nav__item"><a href="#id8" class="md-nav__link">一些操作</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id9" class="md-nav__link">分支操作</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id10" class="md-nav__link">4.3 更新操作</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id11" class="md-nav__link">合并操作</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id12" class="md-nav__link">合并冲突</a>
        </li>
        <li class="md-nav__item"><a href="#id13" class="md-nav__link">暂存代码保护现场</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id14" class="md-nav__link">五、git 高级操作</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id15" class="md-nav__link">5.1 git 撤销操作</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#git-commit" class="md-nav__link">5.2 git 找回丢失文件(commit了)</a>
        </li>
        <li class="md-nav__item"><a href="#id16" class="md-nav__link">5.3 git 找回丢失文件(未commit,但添加暂存区了)</a>
        </li>
        <li class="md-nav__item"><a href="#id17" class="md-nav__link">5.4 终极大招</a>
        </li>
        <li class="md-nav__item"><a href="#id18" class="md-nav__link">5.5 git 迁移(保留 commit)</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#clone" class="md-nav__link">5.5.1 clone 原来的项目</a>
        </li>
        <li class="md-nav__item"><a href="#gitlab" class="md-nav__link">5.5.2 推送到新的gitlab</a>
        </li>
        <li class="md-nav__item"><a href="#id19" class="md-nav__link">5.5.3 本地代码更换gitlab地址</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#git-rebase" class="md-nav__link">5.6 git rebase</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#merge" class="md-nav__link">5.6.1 merge 时只有一个分支变更</a>
        </li>
        <li class="md-nav__item"><a href="#id20" class="md-nav__link">5.6.2 merge 时两个分支有变更</a>
        </li>
        <li class="md-nav__item"><a href="#rebase" class="md-nav__link">5.6.3 rebase 时只有一个分支变更</a>
        </li>
        <li class="md-nav__item"><a href="#id21" class="md-nav__link">5.6.4 rebase 时两个分支有变更</a>
        </li>
        <li class="md-nav__item"><a href="#id22" class="md-nav__link">5.6.5 rebase 总结</a>
        </li>
        <li class="md-nav__item"><a href="#id23" class="md-nav__link">5.6.6 rebase 的命令行操作</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#squash" class="md-nav__link">squash</a>
        </li>
        <li class="md-nav__item"><a href="#fixup" class="md-nav__link">fixup</a>
        </li>
        <li class="md-nav__item"><a href="#edit" class="md-nav__link">edit</a>
        </li>
        <li class="md-nav__item"><a href="#reword" class="md-nav__link">reword</a>
        </li>
        <li class="md-nav__item"><a href="#drop" class="md-nav__link">drop</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#cherry-pick" class="md-nav__link">5.7 cherry-pick</a>
        </li>
        <li class="md-nav__item"><a href="#id24" class="md-nav__link">六、参与开源项目</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="git">
<h1 id="utils-git--page-root">Git<a class="headerlink" href="#utils-git--page-root" title="Link to this heading">¶</a></h1>
<section id="background">
<h2 id="background">Background<a class="headerlink" href="#background" title="Link to this heading">¶</a></h2>
<p><a class="reference external" href="https://www.cnblogs.com/springbarley/archive/2012/11/03/2752984.html">https://www.cnblogs.com/springbarley/archive/2012/11/03/2752984.html</a></p>
<img alt="utils/gitwork.png" src="utils/gitwork.png"/>
<ul class="simple">
<li><dl class="simple">
<dt>合作模式</dt><dd><ul>
<li><dl class="simple">
<dt>Collocated Contributor Repositories: (Fork and Pull)</dt><dd><ul>
<li><p>team members (Developers) pull the latest code from a central shared repository to theirown private repository.</p></li>
<li><p>make their changes locally, 然后  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">&lt;local_main&gt;:&lt;remote_subbranch&gt;</span></code>  来 share changes，但是没有权限去 push 到  <code class="docutils literal notranslate"><span class="pre">remote_main</span></code> ，</p></li>
<li><p>project maintainers 就可以 accepted and pulled， <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span> <span class="pre">&lt;subbranch&gt;</span></code> 到 project main.</p></li>
<li><p>Repos are on a centralized host.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Single Repository, Shared Maintenance: (Shared Repo)</dt><dd><ul>
<li><p>每一个 team member 都是 project maintainer，可以直接 make changes  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">&lt;local_main&gt;:&lt;remote_main&gt;</span></code> 。</p></li>
<li><p>Relies on policies to restrict access to the main project branch</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
<section id="software-contiguration-management-scm">
<h3 id="software-contiguration-management-scm">软件配置管理, Software Contiguration Management,SCM<a class="headerlink" href="#software-contiguration-management-scm" title="Link to this heading">¶</a></h3>
<p>通过执行版本控制、变更控制的规程，以及使用合适的配置管理软件，来保证所有配置项的完整性和可跟踪性。配置管理是对工作成果(源码文件、需求文档、设计文档，开发文档)的一种有效保护。</p>
<ul class="simple">
<li><p><strong>集中版本控制系统</strong></p></li>
</ul>
<p>是放在中央服务器上，每次只能由一个人去锁定服务器文件的去用</p>
<ul>
<li><p>doc-level锁，</p></li>
<li><p>row-level锁，后者就是需要提前分配好行数，然后进行比对合并，提高了多人协作水平。如果是同样对一行，那也没辙，那也只能是锁住不给别人用），在锁定期间其他人是不能进行修改的，只能查看。</p>
<blockquote>
<div><p>一旦服务器发生故障或者损坏，就会丢失</p>
</div></blockquote>
</li>
</ul>
</section>
<section id="git-client-tool">
<h3 id="git-client-tool">git client tool<a class="headerlink" href="#git-client-tool" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><dl class="simple">
<dt>Git Bash</dt><dd><ul>
<li><p>[Download for macOS](<a class="reference external" href="https://git-scm.com/download/mac">https://git-scm.com/download/mac</a>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span> <span class="pre">git</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">--version</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><p>Github Desktop 【</p></li>
<li><p>sourcetree</p></li>
</ul>
</section>
<section id="mac">
<h3 id="mac">mac<a class="headerlink" href="#mac" title="Link to this heading">¶</a></h3>
<section id="zsh">
<h4 id="zsh">zsh<a class="headerlink" href="#zsh" title="Link to this heading">¶</a></h4>
<p>把如下代码添加至你的  <code class="docutils literal notranslate"><span class="pre">~/.zshrc</span></code>  文件中，就可以在**右侧显示分支名称**</p>
<div class="literal-block-wrapper docutils container" id="id25">
<div class="code-block-caption"><span class="caption-text">zsh</span><a class="headerlink" href="#id25" title="Link to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>autoload -Uz vcs_info
precmd_vcs_info() { vcs_info }
precmd_functions+=( precmd_vcs_info )
setopt prompt_subst
RPROMPT=\$vcs_info_msg_0_
# PROMPT=\$vcs_info_msg_0_'%# '
zstyle ':vcs_info:git:*' formats '%b'
</pre></div>
</div>
</div>
<ul class="simple">
<li><p>[在其它环境中使用 Git - Zsh 中的 Git](<a class="reference external" href="https://git-scm.com/book/zh/v2">https://git-scm.com/book/zh/v2</a>/附录-A%3A-在其它环境中使用-Git-Zsh-中的-Git)</p></li>
</ul>
</section>
</section>
</section>
<section id="id1">
<h2 id="id1">工作流程原理<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h2>
<section id="id2">
<h3 id="id2">四大区域<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<ul>
<li><dl>
<dt>3个本地区域</dt><dd><ul>
<li><p>工作区, <strong>Working Directory</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>用户工作的地方，放代码文件的地方。</p></li>
<li><p>需要往 repository 里放文件，就要先在工作区里放文件。Git 会自动检测这里的文件变化情况。</p></li>
</ul>
</div></blockquote>
</li>
<li><p>当 repository 里有很多 branches，工作区会自动是所选 branch 的工作地方。</p></li>
<li><p>暂存区, <strong>Staging Area</strong> :</p>
<blockquote>
<div><ul class="simple">
<li><p>存放临时的改动, working directory 里有修改的文件需要先  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span> <span class="pre">file_name</span></code>  提交到 staging area，然后再 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-m</span> <span class="pre">&lt;message&gt;</span></code>  放到 local repository 里，然后就会产生一个版本号文件。</p></li>
</ul>
</div></blockquote>
</li>
<li><p>事实上它只是一个文件, 保存即将提交的文件列表信息。</p></li>
<li><p>Git 目录， <strong>.git directory, Respository</strong></p>
<blockquote>
<div><ul class="simple">
<li><p>安全存放数据的位置, 这里面有提交到 <strong>所有版本</strong> 的数据。通过这个实现万一远程挂了，怎么在 local 端继续操作</p></li>
<li><p>HEAD file 指向最新放入仓库的版本</p></li>
<li><p>heads dir 里是每个分支指向的最新版本</p></li>
<li><p>objects dir 里是所有版本的修改情况</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>1个远程区域</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>远程库，Remote</dt><dd><ul>
<li><p>托管代码的服务器，从 local repository 推送文件到远程库需要  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code> , 从远程库拉取文件来更新 repository 需要  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">pull</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
</section>
<section id="details">
<h2 id="details">details<a class="headerlink" href="#details" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><dl class="simple">
<dt>版本号</dt><dd><ul>
<li><p>SHA-1 加密， 用来 merge 时避免 conflict</p></li>
<li><p>共40位，前两位2定位  <code class="docutils literal notranslate"><span class="pre">objects</span></code>  里的 dir name，后38位定位 file name</p></li>
<li><dl class="simple">
<dt>查看版本号文件不能直接手动打开，需要用 <strong>git bash</strong> 打开</dt><dd><ul>
<li><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cat-file</span> <span class="pre">-p</span> <span class="pre">&lt;version&gt;</span></code></dt><dd><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">-p</span></code>  友好地查看</p></li>
<li><p>但是不知道为什么会error  <code class="docutils literal notranslate"><span class="pre">Not</span> <span class="pre">a</span> <span class="pre">valid</span> <span class="pre">object</span> <span class="pre">name</span> <span class="pre">636a7d6c4e21df81163ad4616e301e86ca000f</span></code></p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><p>内容是当前提前信息的</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="git-command">
<h2 id="git-command">git command<a class="headerlink" href="#git-command" title="Link to this heading">¶</a></h2>
<section id="id3">
<h3 id="id3">初始化<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<section id="local-init">
<h4 id="local-init">本地新建一个 local init<a class="headerlink" href="#local-init" title="Link to this heading">¶</a></h4>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">init</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>mkdir<span class="w"> </span>local_init
<span class="nb">cd</span><span class="w"> </span>local_init
git<span class="w"> </span>init
ls
</pre></div>
</div>
<div class="line-block">
<div class="line">此时就会出现一个 .git 的隐藏 directory，这就是 local repository。</div>
<div class="line">以后所有的 git 操作历史提交记录信息全都在此, 只要这个文件夹还存在, 就可以记住我们所有的 git 操作。</div>
</div>
<a class="reference internal image-reference" href="../_images/local_git_init_1.png"><img alt="../_images/local_git_init_1.png" src="../_images/local_git_init_1.png" style="width: 474.59999999999997px; height: 181.79999999999998px;"/>
</a>
<p>在 local init 新建的 repository 是没有任何的提交文件，所以也没有 default 的 branch 文件。</p>
<ul class="simple">
<li><p>heads  directory 里没有文件，哪怕 HEAD 里指向 main 或者master。</p></li>
<li><p>objects directory 里没有文件，因为没有版本。</p></li>
<li><p>所以用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">branch</span> <span class="pre">-m</span> <span class="pre">branch1</span></code>  也没有用，因为head里依旧没有文件</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/local_git_init_2.png"><img alt="../_images/local_git_init_2.png" src="../_images/local_git_init_2.png" style="width: 549.6px; height: 277.2px;"/>
</a>
<a class="reference internal image-reference" href="../_images/local_git_init_3.png"><img alt="../_images/local_git_init_3.png" src="../_images/local_git_init_3.png" style="width: 454.2px; height: 195.0px;"/>
</a>
<a class="reference internal image-reference" href="../_images/local_git_init_4.png"><img alt="../_images/local_git_init_4.png" src="../_images/local_git_init_4.png" style="width: 318.0px; height: 340.2px;"/>
</a>
</section>
<section id="gui-init">
<h4 id="gui-init">GUI init<a class="headerlink" href="#gui-init" title="Link to this heading">¶</a></h4>
<a class="reference internal image-reference" href="../_images/gui_create_1.png"><img alt="../_images/gui_create_1.png" src="../_images/gui_create_1.png" style="width: 378.0px; height: 347.4px;"/>
</a>
<p>除了 local init 里的东西，还会自动 initial commit</p>
<ul class="simple">
<li><p>生成  <code class="docutils literal notranslate"><span class="pre">.git</span></code> ,  <code class="docutils literal notranslate"><span class="pre">.gitattribute</span></code></p></li>
<li><p>可以自选要不要带上  <code class="docutils literal notranslate"><span class="pre">readme.md</span></code></p></li>
<li><p>heads  directory 里有文件，是 default branch (main 或者 master，自己设)，里面指向的就是 initial commit 的版本文件</p></li>
<li><p>objects directory 有文件，包括 initial commit 这个版本文件</p></li>
<li><p>所以用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">branch</span> <span class="pre">-m</span> <span class="pre">branch1</span></code>  就有用，而且可以选择branch。</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/gui_create_2.png"><img alt="../_images/gui_create_2.png" src="../_images/gui_create_2.png" style="width: 575.4px; height: 225.6px;"/>
</a>
</section>
</section>
<section id="git-config">
<h3 id="git-config">git config 配置<a class="headerlink" href="#git-config" title="Link to this heading">¶</a></h3>
<ul>
<li><p>查看 git 配置  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">config</span> <span class="pre">--list</span></code></p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>--list
<span class="c1"># 提交代码时的用户信息</span>
user.name<span class="o">=</span>
user.email<span class="o">=</span>
...
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>设置提交代码时的用户信息</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. usrname</span>
git<span class="w"> </span>config<span class="w"> </span>--global<span class="w"> </span>user.name<span class="w"> </span><span class="s2">"yourUserName"</span>

<span class="c1"># 2. useremail</span>
git<span class="w"> </span>config<span class="w"> </span>--gloabl<span class="w"> </span>user.email<span class="w"> </span><span class="s2">"yourEmail"</span>

<span class="c1"># 3. 没有  ``global``  只对当前仓库生效</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>修改 git 配置文件</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. 针对当前仓库</span>
$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>-e

<span class="c1"># 2. 针对 local 所有仓库</span>
$<span class="w"> </span>git<span class="w"> </span>config<span class="w"> </span>-e<span class="w"> </span>--global
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
<section id="id4">
<h3 id="id4">日常操作<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<section id="id5">
<h4 id="id5">提交代码<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h4>
<section id="id6">
<h5 id="id6">基本流程<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h5>
<ol class="arabic">
<li><dl>
<dt>working dir -&gt; staging area</dt><dd><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. 该命令可以将文件添加到暂存区</span>
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span><span class="o">[</span>file1<span class="o">]</span><span class="w"> </span><span class="o">[</span>file2<span class="o">]</span><span class="w"> </span>...

<span class="c1"># 2. 添加指定目录到暂存区</span>
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span><span class="o">[</span>dir<span class="o">]</span>

<span class="c1"># 3. 添加当前目录下所有文件进入暂存区</span>
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>.

<span class="c1"># 4. 添加当前目录下特定格式进入暂存区.</span>
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>*.py
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>staging area -&gt; local repository</dt><dd><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span> <span class="pre">-m</span> <span class="pre">&lt;message&gt;</span></code></p>
</dd>
</dl>
</li>
<li><p>local respository -&gt; remote</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">origin</span> <span class="pre">&lt;local_branch&gt;</span> <span class="pre">:</span> <span class="pre">&lt;remote_branch&gt;</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">origin</span></code>  :</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">local_branch</span></code>  working dir 的 branch</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">remote_branch</span></code>  你要 push 的那个 repository 的那个 branch</p></li>
</ul>
</div></blockquote>
</li>
</ol>
</section>
<section id="id7">
<h5 id="id7">一些过程中可能用到的查看指令<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h5>
<ul>
<li><p>查看在你上次提交之后是否有对文件进行再次修改</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">nothing</span> <span class="pre">to</span> <span class="pre">commit</span></code>  目前「沒有東西可以提交」</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Untracked</span> <span class="pre">files</span></code>  所有文件都是当前没有被加入过branch的文件，也没有被  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>  放进 staging area</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Changes</span> <span class="pre">not</span> <span class="pre">staged</span> <span class="pre">for</span> <span class="pre">commit</span></code>  改过，没有被  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>  放进 staging area</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Changes</span> <span class="pre">to</span> <span class="pre">be</span> <span class="pre">committed</span></code>  改过，已经放进 staging area。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Unmerged</span> <span class="pre">paths</span></code>  冲突的文件。在文件中把冲突都保留下来了，并需要自己手动处理。</p></li>
</ul>
</div></blockquote>
</li>
<li><dl class="simple">
<dt>比较文件在 <strong>暂存区和工作区</strong> 的差异，已经写入暂存区和已经被修改但尚未写入暂存区文件的区别</dt><dd><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code></p>
</dd>
</dl>
</li>
<li><p>查看暂存区的文件</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">ls-files</span></code></p>
<ul>
<li><p>可选参数:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">-d</span></code> : 显示删除的文件</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-m</span></code> : 显示被修改过的文件</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-o</span></code> : 显示没有被 git 跟踪过的文件</p></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</li>
<li><p>查看 <strong>暂存区</strong> 文件中的内容</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cat-file</span> <span class="pre">-p</span></code></p>
<ul class="simple">
<li><p>如果 error， 可以看看  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">ls-files</span></code>  在不在暂存区里</p></li>
</ul>
</div></blockquote>
</li>
<li><p>给版本文件打标签</p></li>
</ul>
<a class="reference internal image-reference" href="../_images/tag-1.png"><img alt="../_images/tag-1.png" src="../_images/tag-1.png" style="width: 265.2px; height: 373.8px;"/>
</a>
</section>
<section id="id8">
<h5 id="id8">一些操作<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h5>
<ul>
<li><p>删除文件</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rm</span></code></p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. 将文件从暂存区和工作区中删除</span>
<span class="c1"># 可以加上 -f, 表示强制删除之前修改过而且 add 到暂存区的文件</span>
$<span class="w"> </span>git<span class="w"> </span>rm<span class="w"> </span><span class="o">[</span>-f<span class="o">]</span><span class="w"> </span>&lt;file&gt;

<span class="c1"># 2. 将文件从暂存区删除，在工作区保留</span>
$<span class="w"> </span>git<span class="w"> </span>rm<span class="w"> </span>--cached<span class="w"> </span>&lt;file&gt;
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
</section>
<section id="id9">
<h4 id="id9">分支操作<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h4>
<ul>
<li><p>查看分支  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">branch</span> <span class="pre">-a</span></code></p></li>
<li><p>创建新分支  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">-b</span> <span class="pre">&lt;new_branch&gt;</span></code></p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. 创建分支,注意新分支创建后不会自动切换为当前分支</span>
$<span class="w"> </span>git<span class="w"> </span>branch<span class="w"> </span>&lt;new_branch&gt;

<span class="c1"># 2. 基于当前分支创建一个新分支,并进行切换</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>&lt;new_branch&gt;

<span class="c1"># 3. 基于指定分支创建一个新的分支,并进行切换</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>&lt;new_branch&gt;<span class="w"> </span>&lt;given_brach&gt;

<span class="c1"># 4. 创建远程分支(本地分支push到远程)：</span>
$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>&lt;remote_branch&gt;
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>切换分支  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span></code></p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. 切换分支</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>&lt;branch&gt;

<span class="c1"># 2. 切换到上一个分支</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>-

<span class="c1"># 3. 切换 commit version</span>
$<span class="w"> </span>git<span class="w"> </span>log<span class="w"> </span><span class="c1"># 查看版本号</span>
$<span class="w"> </span>git<span class="w"> </span>checkout<span class="w"> </span>&lt;SHA&gt;
</pre></div>
</div>
<p>[Git 切换分支](<a class="reference external" href="https://www.freecodecamp.org/chinese/news/git-switch-branch/">https://www.freecodecamp.org/chinese/news/git-switch-branch/</a>)</p>
</div></blockquote>
</li>
<li><p>删除分支</p>
<blockquote>
<div><div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 1. local : 只能删除已经参与了合并的分支，对于未有合并的分支是无法删除的</span>
$<span class="w"> </span>git<span class="w"> </span>branch<span class="w"> </span>-d<span class="w"> </span>&lt;local_branch&gt;

<span class="c1"># 2. local : 想强制删除一个分支</span>
$<span class="w"> </span>git<span class="w"> </span>branch<span class="w"> </span>-D<span class="w"> </span>&lt;local_branch&gt;

<span class="c1"># 3. 删除远程分支</span>
$<span class="w"> </span>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>:heads/&lt;_remote_branch&gt;
</pre></div>
</div>
</div></blockquote>
</li>
</ul>
</section>
</section>
</section>
<section id="id10">
<h2 id="id10">4.3 更新操作<a class="headerlink" href="#id10" title="Link to this heading">¶</a></h2>
<p>@TODO</p>
<section id="id11">
<h3 id="id11">合并操作<a class="headerlink" href="#id11" title="Link to this heading">¶</a></h3>
<ol class="arabic">
<li><p>先切换到要合并的主分支  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">master</span></code></p></li>
<li><p>选择要合并的另外一个 branch</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span> <span class="pre">&lt;another_branch&gt;</span></code></p>
</div></blockquote>
</li>
</ol>
<div class="sd-container-fluid sd-sphinx-override sd-mb-4 docutils">
<div class="sd-row sd-row-cols-2 sd-row-cols-xs-2 sd-row-cols-sm-2 sd-row-cols-md-2 sd-row-cols-lg-2 docutils">
<div class="sd-col sd-d-flex-column docutils">
<a class="reference internal image-reference" href="../_images/merge_1.png"><img alt="../_images/merge_1.png" src="../_images/merge_1.png" style="width: 274.8px; height: 279.0px;"/>
</a>
</div>
<div class="sd-col sd-d-flex-column docutils">
<a class="reference internal image-reference" href="../_images/merge_2.png"><img alt="../_images/merge_2.png" src="../_images/merge_2.png" style="width: 271.2px; height: 279.0px;"/>
</a>
</div>
</div>
</div>
<section id="id12">
<h4 id="id12">合并冲突<a class="headerlink" href="#id12" title="Link to this heading">¶</a></h4>
<p>合并代码出现冲突提示。 这个时候不可以进行任何分支切换和commit操作，需要按照提示将冲突解决。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 冲突提示</span>
Auto-merging<span class="w"> </span>README.md
CONFLICT<span class="w"> </span><span class="o">(</span>content<span class="o">)</span>:<span class="w"> </span>Merge<span class="w"> </span>conflict<span class="w"> </span><span class="k">in</span><span class="w"> </span>README.md
Automatic<span class="w"> </span>merge<span class="w"> </span>failed<span class="p">;</span><span class="w"> </span>fix<span class="w"> </span>conflicts<span class="w"> </span>and<span class="w"> </span><span class="k">then</span><span class="w"> </span>commit<span class="w"> </span>the<span class="w"> </span>result.
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/merge_2.png"><img alt="../_images/merge_2.png" src="../_images/merge_2.png" style="width: 271.2px; height: 279.0px;"/>
</a>
<a class="reference internal image-reference" href="../_images/merge_3.png"><img alt="../_images/merge_3.png" src="../_images/merge_3.png" style="width: 429.59999999999997px; height: 171.0px;"/>
</a>
<a class="reference internal image-reference" href="../_images/merge_4.png"><img alt="../_images/merge_4.png" src="../_images/merge_4.png" style="width: 551.4px; height: 242.39999999999998px;"/>
</a>
<ol class="arabic">
<li><p>查看冲突文件内容</p>
<blockquote>
<div><div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ vim README.md
1111
2222
&lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD
3333
=======
3344
&gt;&gt;&gt;&gt;&gt;&gt;&gt; feature/hotfix-002
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><p>从  <code class="docutils literal notranslate"><span class="pre">&lt;&lt;&lt;&lt;&lt;&lt;&lt;</span> <span class="pre">HEAD</span></code>  开始, 到  <code class="docutils literal notranslate"><span class="pre">=======</span></code>  都是主分支已经存在的内容。</p></li>
<li><p>从  <code class="docutils literal notranslate"><span class="pre">=======</span></code>  开始, 到  <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;&gt;&gt;&gt;&gt;</span> <span class="pre">branch</span></code>  都是 merge 过来的分支的内容。</p></li>
</ul>
</li>
<li><p>解决冲突，视情况保留(删除)记录</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>冲突解决完成之后, 再次提交代码 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code></p></li>
</ol>
</div></blockquote>
</li>
</ol>
</section>
<section id="id13">
<h4 id="id13">暂存代码保护现场<a class="headerlink" href="#id13" title="Link to this heading">¶</a></h4>
<div class="admonition-master-dev-bug-git-stash admonition hint">
<p class="admonition-title">项目经理提了一个新的需求, 开发就需要从 master 分支迁出一个新的分支进行功能开发(例如迁出新分支为dev), 如果在开发过程中生产上有紧急 bug 需要修复, 就可以用到  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span></code>  了。</p>
<p>这种情况一般是出现在你正在完成一个功能，但是忽然线上发现了一个Bug，必须马上开一个新的分支来修复bug，但是现在的功能没写完不打算提交(commit)，现在怎么办？？</p>
</div>
<div class="admonition-local-repository-commit admonition note">
<p class="admonition-title">为什么要暂存，而不用直接在自己的 local repository commit</p>
<p>commit 需要写 message。一般 message 都是写 “完成xx功能，修改xx功能”， 如果这样写但是其实做到一半就会有歧义。如果不这样写，交代自己的工作进度，也行。但是一旦 push 的话就会把该 branch 的所有 commit 都 push 到 shared repository。那么 messages 都 public 了。</p>
</div>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span></code>  可以将现在的 <strong>工作区</strong> 全部的修改、新增、删除等操作，全部保存起来。</p>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span></code>  的常用命令:</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">save</span> <span class="pre">'save</span> <span class="pre">message'</span></code> : 执行存储时, 添加备注, 方便查找, 当然只执行  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span></code>  也是可以的, 但查找时不方便。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">list</span></code> : 查看 stash 了哪些存储。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">show</span></code> : 显示做了哪些改动, 默认 show 第一个存储, 如果要显示其他的存储, 后面加  <code class="docutils literal notranslate"><span class="pre">stash@{$num}</span></code> , 比如第二个:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">show</span> <span class="pre">stash@{1}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stast</span> <span class="pre">show</span> <span class="pre">-p</span></code> : 显示第一个存储的改动, 如果想显示其他存储, 则:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">show</span> <span class="pre">stash@{$num}</span> <span class="pre">-p</span></code> , 比如第二个:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">show</span> <span class="pre">stash@{1}</span> <span class="pre">-p</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">apply</span></code> : 应用某个存储, 但不会把存储从存储列表中删除, 默认使用第一个存储, 即  <code class="docutils literal notranslate"><span class="pre">stash@{0}</span></code> , 如果要是用其他, 则:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">apply</span> <span class="pre">stash@{$num}</span></code> , 比如第二个:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">apply</span> <span class="pre">stash@{1}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">pop</span></code> : 恢复之前缓存的工作目录, 将缓存列表中对应的 stash 删除, 并将对应修改应用到当前的工作目录下, 默认为第一个 stash, 即  <code class="docutils literal notranslate"><span class="pre">stash@{0}</span></code> , 如果要应用并删除其他 stash, 则:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">pop</span> <span class="pre">stash@{$num}</span></code> , 比如应用并删除第二个:  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">pop</span> <span class="pre">stash@{1}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">drop</span> <span class="pre">stash@{num}</span></code> : 丢弃  <code class="docutils literal notranslate"><span class="pre">stash@{num}</span></code>  存储, 从列表中删除这个存储</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">stash</span> <span class="pre">clear</span></code> : 删除所有缓存的 stash</p></li>
</ol>
<p>开始模拟现场</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span># git 初始化
$ cd .. &amp;&amp; rm -rf git-study &amp;&amp; mkdir git-study &amp;&amp; cd git-study &amp;&amp; git init
$ echo 'file1 init' &gt; file1.txt
$ echo 'file2 init' &gt; file2.txt
$ git add .
$ git commit -m 'change: add file1 &amp; file2'
[master (root-commit) 525c358] change: add file1 &amp; file2
2 files changed, 2 insertions(+)
create mode 100644 file1.txt
create mode 100644 file2.txt

# 然后从 master 分支创建两个新的 feature 分支
$ git branch feature1
$ git branch feature2

# checkout feature1, 修改 file1.txt, 并在 feature1 上创建两次提交
$ git checkout feature1
$ echo 'add file1.txt code 1' &gt;&gt; file1.txt
$ git add file1.txt
$ git commit -m 'change file1 no.1'
$ echo 'add file2.txt code 2' &gt;&gt; file1.txt
$ git add file1.txt
$ git commit -m 'change file1 no.2'
# 目前 feature1 上的改动内容
$ cat file1.txt
file1 init
add file1.txt code 1
add file2.txt code 2
$ cat file2.txt
file2 init

# checkout feature2, 修改 file2.tx
$ git checkout feature2
$ echo 'add file2.txt code 1' &gt;&gt; file2.txt
$ git add file2.txt
$ git commit -m 'change file2 no.1'
# 目前 feature2 上的改动内容
$ cat file1.txt
file1 init
$ cat file2.txt
file2 init
add file2.txt code 1

# 假设不小心将 feature2 合并到了 feature1, 并在 feature1 继续进行了代码开发并提交
$ git checkout feature1
$ git merge feature2
$ echo 'add file1.txt no.3 &amp; code end' &gt;&gt; file1.txt
$ git add file1.txt
$ git commit -m 'change file1 no.3'
# 此时 feature1 上所有文件的内容
$ cat file1.txt
file1 init
add file1.txt code 1
add file2.txt code 2
add file1.txt no.3 &amp; code end
$ cat file2.txt
file2 init
add file2.txt code 1

# 此时我们发现了不小心 merge 进来的 feature2, 而且在这基础上我们还有新的 commit, 如果我们想将 merge 剔除, 可以做如下操作
# 先查看需要还原 commit 的版本号
$ git log --oneline
8a1454f (HEAD -&gt; feature1) change file1 no.3
422a454 Merge branch 'feature2' into feature1
4978e2c (feature2) change file2 no.1
ee4a50e change file1 no.2
dc397c1 change file1 no.1
525c358 (master) change: add file1 &amp; file2
# 其中, 422a454 就是误合并的 commitid
# 目前我们需要做的就是撤销已提交的 commit, 回滚到 feature2 误合并到 feature1 分支的 commit 版本。
$ git reset --mixed 422a454
Unstaged changes after reset:
M  file1.txt
$ git log --oneline
422a454 (HEAD -&gt; feature1) Merge branch 'feature2' into feature1
4978e2c (feature2) change file2 no.1
ee4a50e change file1 no.2
dc397c1 change file1 no.1
525c358 (master) change: add file1 &amp; file2
$ git diff file1.txt
diff --git a/file1.txt b/file1.txt
index 4a1ca46..6954af7 100644
--- a/file1.txt
+++ b/file1.txt
@@ -1,3 +1,4 @@
file1 init
add file1.txt code 1
add file2.txt code 2
+add file1.txt no.3 &amp; code end   ## 可以看见, feature1 最后一次提交已经是未暂存状态了
# 此时, 我们就可以使用 git stash, 将撤销的代码存储起来,
$ git stash save 'save file1.txt reset code'
Saved working directory and index state On feature1: save file1.txt reset code
# 查看 stash 列表
$ git stash list
stash@{0}: On feature1: save file1.txt reset code
# 查看 status, 可以看见在工作空间已经没有了
$ git status
On branch feature1
nothing to commit, working tree clean

# 然后再撤销 merge 相关的信息
$ git reset --hard HEAD~
# 再查看此时本地的文件内容
$ cat file1.txt
file1 init
add file1.txt code 1
add file2.txt code 2
$ cat file2.txt
file2 init

# 接下来恢复 feature1 上被撤销的代码
$ git stash list
stash@{0}: On feature1: save file1.txt reset code
$ git stash apply stash{0}
On branch feature1
Changes not staged for commit:
(use "git add &lt;file&gt;..." to update what will be committed)
(use "git restore &lt;file&gt;..." to discard changes in working directory)
modified:   file1.txt

no changes added to commit (use "git add" and/or "git commit -a")
# 此时代码就恢复回来了
$ cat file1.txt
file1 init
add file1.txt code 1
add file2.txt code 2
add file1.txt no.3 &amp; code end
</pre></div>
</div>
<p>说明: git stash会贮存及不会贮存的文件范围</p>
<ul class="simple">
<li><dl class="simple">
<dt>会贮存:</dt><dd><ul>
<li><p>添加到暂存区的修改（staged changes）</p></li>
<li><p>git跟踪的但并未添加到暂存区的修改（unstaged changes）</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>不会贮存:</dt><dd><ul>
<li><p>在工作目录中新的文件（untracked files）</p></li>
<li><p>被忽略的文件（ignored files）</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<p>当然, 如果仅仅需要 删除某个 commit, 其实有更好的方法</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 假设, 当前已经到了 git commit -m 'change file1 no.3', 当前 log</span>
$<span class="w"> </span>git<span class="w"> </span>log
commit<span class="w"> </span>3e6be928866581f1779bb0f0e84d29d068d698e8<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature1<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kino@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">23</span>:30:31<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800

<span class="w">    </span>change<span class="w"> </span>file1<span class="w"> </span>no.3

commit<span class="w"> </span>ef733ffec4e80ed851f353f2d8b2dba46b831bb6
Merge:<span class="w"> </span>5e96765<span class="w"> </span>7d9cebd
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kino@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">23</span>:30:29<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800

<span class="w">    </span>Merge<span class="w"> </span>branch<span class="w"> </span><span class="s1">'feature2'</span><span class="w"> </span>into<span class="w"> </span>feature1
...

<span class="c1"># 我们可以直接 git revert 指定的 commit, 例如 上面 merge 的 commit id 是 ef733ffec4e80ed851f353f2d8b2dba46b831bb6</span>
$<span class="w"> </span>git<span class="w"> </span>revert<span class="w"> </span>-i<span class="w"> </span>ef733ffec4e80ed851f353f2d8b2dba46b831bb6<span class="w"> </span>-m<span class="w"> </span><span class="m">1</span>
<span class="c1"># 注意, 已经要加上 -m 1, 否则会报如下错:</span>
<span class="c1">#   error: commit ef733ffec4e80ed851f353f2d8b2dba46b831bb6 is a merge but no -m option was given.</span>
<span class="c1">#   fatal: revert failed</span>
<span class="c1"># 在这里解释下 -m 1 的含义:</span>
<span class="c1">#   从上面的 git log 可以看见 "Merge: 5e96765 7d9cebd" 的信息, 这代表着, 本次 merge 是使用当前分支的 5e96765(commit) 和 feature2 分支的 7d9cebd(commit) 合并而来, 我们可以做一下验证:</span>
<span class="c1">#     # 首先 cat-file 5e96765</span>
<span class="c1">#     $ git cat-file -p 5e96765</span>
<span class="c1">#     tree fa6ff2fd55be9834b45f0be9d347b1670594ed17</span>
<span class="c1">#     parent d27c172b6e876938eb39094801ca5e436a30b3c3</span>
<span class="c1">#     author kino &lt;kino@gmail.com&gt; 1669303829 +0800</span>
<span class="c1">#     committer kino &lt;kino@gmail.com&gt; 1669303829 +0800</span>
<span class="c1">#     change file1 no.2</span>
<span class="c1">#    # 然后取 tree 的 id 继续查看, 可以看到, 这个 tree 记录该 commit 的两个文件</span>
<span class="c1">#    $ git cat-file -p fa6ff2fd55be9834b45f0be9d347b1670594ed17</span>
<span class="c1">#    100644 blob 4a1ca461271ec4e0041822373470703dca5d0626  file1.txt</span>
<span class="c1">#    100644 blob 18ffc0add953f06f00be32437b9f79e09af27d32  file2.txt</span>
<span class="c1">#    # 然后取 file2.txt 的 id 继续查看, 可以看到, 这个 tree 记录 该 file2.txt 的内容为: file2 init</span>
<span class="c1">#    $ git cat-file -p 18ffc0add953f06f00be32437b9f79e09af27d32</span>
<span class="c1">#    file2 init</span>
<span class="c1">#    # 然后我们再 cat-file 7d9cebd</span>
<span class="c1">#    tree 1b5c42acd113046ec223223affe7b3ef579a293b</span>
<span class="c1">#    parent 9acd7882175075c0f3e2f44dfa0d91f3d0a673d1</span>
<span class="c1">#    author kino &lt;kino@gmail.com&gt; 1669303829 +0800</span>
<span class="c1">#    committer kino &lt;kino@gmail.com&gt; 1669303829 +0800</span>
<span class="c1">#    change file2 no.1</span>
<span class="c1">#    # 然后取 tree 的 id 继续查看, 可以看到, 这个 tree 记录该 commit 的两个文件</span>
<span class="c1">#    git cat-file -p 1b5c42acd113046ec223223affe7b3ef579a293b</span>
<span class="c1">#    100644 blob 0c481f7fe4602d041634c353e31846bf1b638c37  file1.txt</span>
<span class="c1">#    100644 blob c6b0b29e598db81ef8e54ec955df78cfac4ae316  file2.txt</span>
<span class="c1">#    # 然后取 file2.txt 的 id 继续查看, 可以看到, 这个 tree 记录 该 file2.txt 的内容</span>
<span class="c1">#    git cat-file -p c6b0b29e598db81ef8e54ec955df78cfac4ae316</span>
<span class="c1">#    file2 init</span>
<span class="c1">#    add file2.txt code 1</span>
<span class="c1"># 由此我们可以得出结论, 5e96765 就是 feature1 在 Merge 之前的状态, 而 7d9cebd 就是 feature2 在 Merge 之前的状态。</span>
<span class="c1"># 因为 一个 Merge 记录了两个分支的 commit 信息, 所以, 在 revert merge 的时候,需要明确的支出, 要revert 到哪个commit, 因为我们是想取消 feature2 里面的内容, 所以就是 -m 1</span>

<span class="c1"># ok, 回到正题, git revert 之后, 我们再查看 log</span>
$<span class="w"> </span>git<span class="w"> </span>log<span class="w"> </span>--oneline
b4dde93<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature1<span class="o">)</span><span class="w"> </span>Revert<span class="w"> </span><span class="s2">"Merge branch 'feature2' into feature1"</span>
3e6be92<span class="w"> </span>change<span class="w"> </span>file1<span class="w"> </span>no.3
ef733ff<span class="w"> </span>Merge<span class="w"> </span>branch<span class="w"> </span><span class="s1">'feature2'</span><span class="w"> </span>into<span class="w"> </span>feature1
5e96765<span class="w"> </span>change<span class="w"> </span>file1<span class="w"> </span>no.2
7d9cebd<span class="w"> </span><span class="o">(</span>feature2<span class="o">)</span><span class="w"> </span>change<span class="w"> </span>file2<span class="w"> </span>no.1
d27c172<span class="w"> </span>change<span class="w"> </span>file1<span class="w"> </span>no.1
9acd788<span class="w"> </span><span class="o">(</span>master<span class="o">)</span><span class="w"> </span>change:<span class="w"> </span>add<span class="w"> </span>file1<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>file2
<span class="c1"># 然后查看 file2.txt</span>
$<span class="w"> </span>cat<span class="w"> </span>file2.txt
file2<span class="w"> </span>init
</pre></div>
</div>
</section>
</section>
</section>
<section id="id14">
<h2 id="id14">五、git 高级操作<a class="headerlink" href="#id14" title="Link to this heading">¶</a></h2>
<section id="id15">
<h3 id="id15">5.1 git 撤销操作<a class="headerlink" href="#id15" title="Link to this heading">¶</a></h3>
<p><strong>disk:</strong></p>
<p><strong>暂存区:</strong></p>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>command</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>查看修改</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">diff</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>查看状态</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">status</span></code>  -&gt;  <code class="docutils literal notranslate"><span class="pre">Changes</span> <span class="pre">not</span> <span class="pre">staged</span> <span class="pre">for</span> <span class="pre">comit</span></code></p></td>
</tr>
<tr class="row-even"><td><p>撤销文件修改</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">checkout</span> <span class="pre">&lt;change_file&gt;</span>  <span class="pre">or</span> <span class="pre">git</span> <span class="pre">restore</span> <span class="pre">&lt;change_file&gt;</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>提交暂存区</p></td>
<td><p>git add &lt;change_file&gt;</p></td>
</tr>
</tbody>
</table>
<p><strong>local:</strong></p>
<table>
<thead>
<tr class="row-odd"><th class="head"><p>command</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>撤销commit(保留磁盘上的修改和暂存区记录)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--soft</span> <span class="pre">HEAD~1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>撤销commit(清除暂存区记录, 只保留磁盘上的修改)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">HEAD~1``===</span> <span class="pre">``git</span> <span class="pre">reset</span> <span class="pre">--mixed</span> <span class="pre">HEAS~1</span></code></p></td>
</tr>
<tr class="row-even"><td><p>撤销commit(清除暂存区记录, 清除磁盘上的修改)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span> <span class="pre">HEAD~1</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>生成新的 <code class="docutils literal notranslate"><span class="pre">commitId</span></code> ,将上一个 <code class="docutils literal notranslate"><span class="pre">commit+</span></code> 的内容变成 <code class="docutils literal notranslate"><span class="pre">commit-</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span> <span class="pre">HEAD</span></code></p></td>
</tr>
<tr class="row-even"><td><p>提交远端git</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code></p></td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span></code>  &amp;  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span></code> :</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span></code> : 只能回到之前某一个commit的状态。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span></code> :撤销中间任意一个commit。 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span> <span class="pre">70a0;(git</span> <span class="pre">revert</span> <span class="pre">HEAD~1)</span></code></p></li>
</ol>
<p>如果操作项目的分支是公共分支，只能通过  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span></code>  生成一个新的 commitId，从这个结果上撤销我们之前的修改。</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">revert</span> <span class="pre">HEAD</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span></code></p></li>
</ol>
<p>如果操作项目的分支是个人分支，可以通过 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span></code> 撤销我们之前的修改</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span> <span class="pre">HEAD~1</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">-f</span></code></p></li>
</ol>
</section>
</section>
<section id="git-commit">
<h2 id="git-commit">5.2 git 找回丢失文件(commit了)<a class="headerlink" href="#git-commit" title="Link to this heading">¶</a></h2>
<p>恢复因为执行  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span> <span class="pre">--hard</span> <span class="pre">COMMITID</span></code>  丢失的文件</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 重新创建一个项目</span>
$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>..<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>git-study<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>git-study<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>git-study<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>git<span class="w"> </span>init
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'master message 1'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>master_1.txt
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>master_1.txt
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">'first commit'</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'master message 2'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>master_2.txt
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>master_2.txt
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">'No.2 commit'</span>

<span class="c1"># 在这两次commit的基础上, reset 到第一次(first commit)上</span>
$<span class="w"> </span>git<span class="w"> </span>log<span class="w">   </span><span class="c1"># 获取第一次commitid</span>
$<span class="w"> </span>git<span class="w"> </span>reset<span class="w"> </span>--hard<span class="w"> </span>4a9bcb880db85a1ca77807dea9b3adce29dc4fda
<span class="c1"># 再次查看 log 信息, 此时可以看见只有一次commit了, 第二次 commit(No.2 commit) 已经丢失</span>
$<span class="w"> </span>git<span class="w"> </span>log<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span>
</pre></div>
</div>
<p>git 提供了  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reflog</span></code>  用来记录你的每一次改变目录树的命令，使用好他就可以很方便的恢复你的提交：</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>4a9bcb8<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>master<span class="o">)</span><span class="w"> </span>HEAD@<span class="o">{</span><span class="m">0</span><span class="o">}</span>:<span class="w"> </span>reset:<span class="w"> </span>moving<span class="w"> </span>to<span class="w"> </span>4a9bcb880db85a1ca77807dea9b3adce29dc4fda
80258ce<span class="w"> </span>HEAD@<span class="o">{</span><span class="m">1</span><span class="o">}</span>:<span class="w"> </span>commit:<span class="w"> </span>No.2<span class="w"> </span>commit
4a9bcb8<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>master<span class="o">)</span><span class="w"> </span>HEAD@<span class="o">{</span><span class="m">2</span><span class="o">}</span>:<span class="w"> </span>commit<span class="w"> </span><span class="o">(</span>initial<span class="o">)</span>:<span class="w"> </span>first<span class="w"> </span>commit
</pre></div>
</div>
<p>可以看到最上面一条记录是将 HEAD 重新指向第一次的commit了, 同时也有显示第二次 commit 的 commitid, 有了这个 commitid, 就可以回滚了。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>reset<span class="w"> </span>--hard<span class="w"> </span>80258ce
HEAD<span class="w"> </span>is<span class="w"> </span>now<span class="w"> </span>at<span class="w"> </span>80258ce<span class="w"> </span>No.2<span class="w"> </span>commit
$<span class="w"> </span>git<span class="w"> </span>log
commit<span class="w"> </span>80258ce0146f373d15a1991d61af4061687782bc<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kino@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:26:10<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800

<span class="w">    </span>No.2<span class="w"> </span>commit

commit<span class="w"> </span>4a9bcb880db85a1ca77807dea9b3adce29dc4fda
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kino@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:25:06<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800

<span class="w">    </span>first<span class="w"> </span>commit
</pre></div>
</div>
<p>可以看到, commit 已被找回.</p>
<p>但是通常情况下, 可能会出现在  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reset</span></code>  之后, 还有新的 commit, 如果直接  <code class="docutils literal notranslate"><span class="pre">reset</span></code>  恢复的 commit, 肯定会造成新的 commit 又丢失, 所以如果我们只是想恢复这个一个 commit, 可以使用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">commitid</span></code>  来单独将这个 commitid 恢复到当前分支或者用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">merge</span></code>  来做合并</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>cherry-pick<span class="w"> </span>04b0396
<span class="o">[</span>master<span class="w"> </span>fbf401a<span class="o">]</span><span class="w"> </span>No.2<span class="w"> </span>commit
Date:<span class="w"> </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:38:14<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800
<span class="m">1</span><span class="w"> </span>file<span class="w"> </span>changed,<span class="w"> </span><span class="m">1</span><span class="w"> </span>insertion<span class="o">(</span>+<span class="o">)</span>
create<span class="w"> </span>mode<span class="w"> </span><span class="m">100644</span><span class="w"> </span>master_2.txt

$<span class="w"> </span>git<span class="w"> </span>log
commit<span class="w"> </span>fbf401a96bd9831c18ed02e9ee852cef8111ccb1<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kino@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:38:14<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800

<span class="w">    </span>No.2<span class="w"> </span>commit

commit<span class="w"> </span>1b5bfdb36ad01fb86d94b76654347f5de5475f37
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kino@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Nov<span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:38:05<span class="w"> </span><span class="m">2022</span><span class="w"> </span>+0800

<span class="w">    </span>first<span class="w"> </span>commit
</pre></div>
</div>
</section>
<section id="id16">
<h2 id="id16">5.3 git 找回丢失文件(未commit,但添加暂存区了)<a class="headerlink" href="#id16" title="Link to this heading">¶</a></h2>
<p>如果只  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>  了没有  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">commit</span></code> (如果连  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code> 都没有, 那只能找磁盘数据恢复的方式了), 这就不是仅仅一个  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">reflog</span></code>  就能找回的了。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>..<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span>git-study<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>git-study<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>git-study<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>git<span class="w"> </span>init
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'master message 1'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>master_1.txt
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>master_1.txt
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">'first commit'</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'master message 2'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>master_2.txt
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>master_2.txt
$<span class="w"> </span>git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s1">'No.2 commit'</span>
$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="s1">'master message 3'</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>master_3.txt
$<span class="w"> </span>git<span class="w"> </span>add<span class="w"> </span>.

<span class="c1"># 查看 log</span>
$<span class="w"> </span>git<span class="w"> </span>log<span class="w"> </span>-n<span class="w"> </span><span class="m">2</span>
<span class="c1"># 取最新的一次 commit id</span>
$<span class="w"> </span>git<span class="w"> </span>reset<span class="w"> </span>--hard<span class="w"> </span>ee614a48f753479a111723ae7ad926e0750ffa6c
<span class="c1"># 查看 status</span>
$<span class="w"> </span>git<span class="w"> </span>status
On<span class="w"> </span>branch<span class="w"> </span>master
nothing<span class="w"> </span>to<span class="w"> </span>commit,<span class="w"> </span>working<span class="w"> </span>tree<span class="w"> </span>clean
<span class="c1"># 查看本地文件</span>
total<span class="w"> </span><span class="m">16</span>
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>kino<span class="w">  </span>staff<span class="w">    </span>17B<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:43<span class="w"> </span>master_1.txt
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>kino<span class="w">  </span>staff<span class="w">    </span>17B<span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:43<span class="w"> </span>master_2.txt
<span class="c1"># 可以看见文件已经丢了</span>
</pre></div>
</div>
<p>git 提供了  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">fsck</span> <span class="pre">--lost-found</span></code>  命令, 他会通过一些神奇的方式把历史操作过的文件以某种算法算出来加到.git/lost-found文件夹里，输出的记录就像下面这个样子。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>❯<span class="w"> </span>git<span class="w"> </span>fsck<span class="w"> </span>--lost-found
Checking<span class="w"> </span>object<span class="w"> </span>directories:<span class="w"> </span><span class="m">100</span>%<span class="w"> </span><span class="o">(</span><span class="m">256</span>/256<span class="o">)</span>,<span class="w"> </span><span class="k">done</span>.
dangling<span class="w"> </span>blob<span class="w"> </span>adbd4c8bf64367fb685336a67f02c5716dc47d73
</pre></div>
</div>
<p>这里返回的第一行带有  <code class="docutils literal notranslate"><span class="pre">blob</span></code>  的信息，我们可以用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">show</span></code> 来查看里面的内容</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>show<span class="w"> </span>adbd4c8bf64367fb685336a67f02c5716dc47d73
master<span class="w"> </span>message<span class="w"> </span><span class="m">3</span>

<span class="c1"># 比如可以将内容追加到新文件中</span>
$<span class="w"> </span>git<span class="w"> </span>show<span class="w"> </span>adbd4c8bf64367fb685336a67f02c5716dc47d73<span class="w"> </span>&gt;<span class="w"> </span>master_3.txt
</pre></div>
</div>
<p>小记: 如果你的提交记录多的话,  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">fsck</span> <span class="pre">--lost-found</span></code>  可以看见很多内容, 如下</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>fsck<span class="w"> </span>--lost-found
Checking<span class="w"> </span>object<span class="w"> </span>directories:<span class="w"> </span><span class="m">100</span>%<span class="w"> </span><span class="o">(</span><span class="m">256</span>/256<span class="o">)</span>,<span class="w"> </span><span class="k">done</span>.
Checking<span class="w"> </span>objects:<span class="w"> </span><span class="m">100</span>%<span class="w"> </span><span class="o">(</span><span class="m">35559</span>/35559<span class="o">)</span>,<span class="w"> </span><span class="k">done</span>.
dangling<span class="w"> </span>blob<span class="w"> </span>601e8abff177a0b2f8a31944654c0cdf0dd1f197
dangling<span class="w"> </span>tree<span class="w"> </span>6c247c35ae51aa86736f745802bb59b97b6598ee
dangling<span class="w"> </span>blob<span class="w"> </span>7a379e6f07391f3bca1fbcc076fcde8f719ffb69
dangling<span class="w"> </span>blob<span class="w"> </span>c66fa02bf74853789b63615a80998b3fbd3d8823
dangling<span class="w"> </span>blob<span class="w"> </span>4996ec43a907f8f6312c3bf137e2f76c7f4c9c9c
dangling<span class="w"> </span>commit<span class="w"> </span>69a110054ca792e6b1060d20ec24ddc9710ada4d
dangling<span class="w"> </span>blob<span class="w"> </span>87ed1263b56d0a98cd163440f872f135a34b61da
dangling<span class="w"> </span>blob<span class="w"> </span>aff0bc224d142929e3f82b8855dd1e97d8b3635b
dangling<span class="w"> </span>blob<span class="w"> </span>eef114f8614a15a11ccfbb7cf5e34302072176e1
dangling<span class="w"> </span>blob<span class="w"> </span>b50db5dad43e13fde45141039f684be48e293739
dangling<span class="w"> </span>blob<span class="w"> </span>820f0136b61394e482fd18e28a7ba81fbb31f688
dangling<span class="w"> </span>blob<span class="w"> </span>2d26cd809139b86218d3460c85baed90d018f007
dangling<span class="w"> </span>blob<span class="w"> </span>603ca9d770947939d8da7ff3aef3775bb27c427e
dangling<span class="w"> </span>blob<span class="w"> </span>e54821ed942c6582d01f60b6715e16301cdcfc4d
dangling<span class="w"> </span>blob<span class="w"> </span>e06be73bb272c7837ab38226c1c1bb13f845574e
dangling<span class="w"> </span>blob<span class="w"> </span>399aede4e687465bf7c895251bef685b0de089b6
dangling<span class="w"> </span>blob<span class="w"> </span>5ea2239d63a9a119a54a52fde6ebf208a940832a
dangling<span class="w"> </span>blob<span class="w"> </span>35ab95c7faf42b7dbbf4e0992527c719ffd4acbd
dangling<span class="w"> </span>blob<span class="w"> </span>9bb609de693b78eb1dc0e3dca7a9d684effd3f4a
dangling<span class="w"> </span>blob<span class="w"> </span>aac499592477199b2630791aecde2db8a608dfa9
dangling<span class="w"> </span>commit<span class="w"> </span>10c581dcdf08ea1bed594a359e09698afd4f794e
dangling<span class="w"> </span>blob<span class="w"> </span>06eb7790a9f71bf796749940102030c6e9503022
</pre></div>
</div>
<p>可以看到这里有 <code class="docutils literal notranslate"><span class="pre">blob</span></code> 、 <code class="docutils literal notranslate"><span class="pre">commit</span></code> 、 <code class="docutils literal notranslate"><span class="pre">tree</span></code> 类型的数据，其实还有 <code class="docutils literal notranslate"><span class="pre">tag</span></code> 等类型的, 这里需要了解下 git 的底层存储</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">commit</span></code>  数据结构在每次提交之后都会生成一个, 当我们进行  <code class="docutils literal notranslate"><span class="pre">commit</span></code>  之后, 首先会创建一个  <code class="docutils literal notranslate"><span class="pre">commit</span></code>  组件, 之后创建一个  <code class="docutils literal notranslate"><span class="pre">tree</span></code>  组件, 把所有的文件信息都存在里面, 每个  <code class="docutils literal notranslate"><span class="pre">blob</span></code>  都代表一个文件, 都可以在  <code class="docutils literal notranslate"><span class="pre">tree</span></code>  里面找到。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">blob</span></code>  组件并不会对文件信息进行存储, 而是只对文件的内容进行记录, 文件信息存储在  <code class="docutils literal notranslate"><span class="pre">tree</span></code>  里.</p></li>
</ul>
</section>
<section id="id17">
<h2 id="id17">5.4 终极大招<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h2>
<p>如果 5.3 并没有找到你想要的内容, 那只能再去看看最近修改的文件了</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>find<span class="w"> </span>.git/objects<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span><span class="p">|</span><span class="w"> </span>xargs<span class="w"> </span>ls<span class="w"> </span>-lt<span class="w"> </span><span class="p">|</span><span class="w"> </span>sed<span class="w"> </span>3q
-r--r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>kino<span class="w">  </span>staff<span class="w">   </span><span class="m">33</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:43<span class="w"> </span>.git/objects/ad/bd4c8bf64367fb685336a67f02c5716dc47d73
-r--r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>kino<span class="w">  </span>staff<span class="w">   </span><span class="m">33</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:43<span class="w"> </span>.git/objects/cc/6e4eeea4f70e784fade7a18bdba6c28f7642e8
-r--r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>kino<span class="w">  </span>staff<span class="w">   </span><span class="m">33</span><span class="w"> </span><span class="m">11</span><span class="w"> </span><span class="m">24</span><span class="w"> </span><span class="m">02</span>:43<span class="w"> </span>.git/objects/24/b6cb352efeff7a2b24b99e8ff814ab1fc2a2fd
</pre></div>
</div>
<p>使用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cat-file</span> <span class="pre">-t</span> <span class="pre">commitid</span></code>  可以看见是什么类型的</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>cat-file<span class="w"> </span>-t<span class="w"> </span>adbd4c8bf64367fb685336a67f02c5716dc47d73
blob

$<span class="w"> </span>git<span class="w"> </span>cat-file<span class="w"> </span>-t<span class="w"> </span>cc6e4eeea4f70e784fade7a18bdba6c28f7642e8
blob

$<span class="w"> </span>git<span class="w"> </span>cat-file<span class="w"> </span>-t<span class="w"> </span>24b6cb352efeff7a2b24b99e8ff814ab1fc2a2fd
blob
</pre></div>
</div>
<p>再使用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cat-file</span> <span class="pre">-p</span> <span class="pre">commitid</span></code>  查看内容</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>git<span class="w"> </span>cat-file<span class="w"> </span>-p<span class="w"> </span>adbd4c8bf64367fb685336a67f02c5716dc47d73
master<span class="w"> </span>message<span class="w"> </span><span class="m">3</span>

$<span class="w"> </span>git<span class="w"> </span>cat-file<span class="w"> </span>-p<span class="w"> </span>cc6e4eeea4f70e784fade7a18bdba6c28f7642e8
master<span class="w"> </span>message<span class="w"> </span><span class="m">2</span>

$<span class="w"> </span>git<span class="w"> </span>cat-file<span class="w"> </span>-p<span class="w"> </span>24b6cb352efeff7a2b24b99e8ff814ab1fc2a2fd
master<span class="w"> </span>message<span class="w"> </span><span class="m">1</span>
</pre></div>
</div>
</section>
<section id="id18">
<h2 id="id18">5.5 git 迁移(保留 commit)<a class="headerlink" href="#id18" title="Link to this heading">¶</a></h2>
<section id="clone">
<h3 id="clone">5.5.1 clone 原来的项目<a class="headerlink" href="#clone" title="Link to this heading">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>--bare<span class="w"> </span>git://github.com/username/project.git
</pre></div>
</div>
</section>
<section id="gitlab">
<h3 id="gitlab">5.5.2 推送到新的gitlab<a class="headerlink" href="#gitlab" title="Link to this heading">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>project
git<span class="w"> </span>push<span class="w"> </span>--mirror<span class="w"> </span>git@example.com/username/newproject.git
</pre></div>
</div>
<p>会提示没有权限, 在gitlab中把项目的权限保护关掉就好了</p>
</section>
<section id="id19">
<h3 id="id19">5.5.3 本地代码更换gitlab地址<a class="headerlink" href="#id19" title="Link to this heading">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>remote<span class="w"> </span>set-url<span class="w"> </span>origin<span class="w"> </span>git@example.com/username/newproject.git
</pre></div>
</div>
</section>
</section>
<section id="git-rebase">
<h2 id="git-rebase">5.6 git rebase<a class="headerlink" href="#git-rebase" title="Link to this heading">¶</a></h2>
<p>准备4个场景:</p>
<ul class="simple">
<li><p>merge 时只有一个分支变更</p></li>
<li><p>merge 时两个分支有变更</p></li>
<li><p>rebase 时只有一个分支变更</p></li>
<li><p>rebase 时两个分支有变更</p></li>
</ul>
<section id="merge">
<h3 id="merge">5.6.1 merge 时只有一个分支变更<a class="headerlink" href="#merge" title="Link to this heading">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-rf<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>first-project
git<span class="w"> </span>init
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c0"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"init"</span>

<span class="c1">## 创建一个分支</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature

<span class="c1">## 在 master 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>main
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c1"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c1 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c2"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c2 commit"</span>

<span class="c1">## feature 合并 master 新增记录</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature
git<span class="w"> </span>merge<span class="w"> </span>main

<span class="c1">## 查看日志, 可以看见 feature 分支上已经有了 master 的两个提交了</span>
git<span class="w"> </span>log<span class="w"> </span>--graph<span class="w"> </span>--pretty<span class="o">=</span>oneline<span class="w"> </span>--abbrev-commit
*<span class="w"> </span>c001f6f<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature,<span class="w"> </span>main<span class="o">)</span><span class="w"> </span>c2<span class="w"> </span>commit
*<span class="w"> </span>a4d98be<span class="w"> </span>c1<span class="w"> </span>commit
*<span class="w"> </span>7171bfa<span class="w"> </span>init

cat<span class="w"> </span>README.md
c0
c1
c2
</pre></div>
</div>
</section>
<section id="id20">
<h3 id="id20">5.6.2 merge 时两个分支有变更<a class="headerlink" href="#id20" title="Link to this heading">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-rf<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>first-project
git<span class="w"> </span>init
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c0"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"init"</span>

<span class="c1">## 创建两个分支</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature1
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature2

<span class="c1">## 在 feature1 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature1
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c1"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c1 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c2"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c2 commit"</span>

<span class="c1">## 在 feature2 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature2
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c3"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c3 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c4"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c4 commit"</span>

<span class="c1">## 在 feature1 上添加一个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature1
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c5"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c5 commit"</span>

<span class="c1">## 查看两个分支的commit时间</span>
git<span class="w"> </span>log<span class="w"> </span>feature1
commit<span class="w"> </span>a16e20a00329b0a60cbf8f541ff999e065a907b0<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature1<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:13<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c5<span class="w"> </span>commit

commit<span class="w"> </span>bddb67864d6a8e5923618564304090a869dedf68
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:02<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>4a0978f9892241abd481251ed96f5a7b92199011
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:16:58<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>cde011b84e70d5dfbd966b91f5d9ab0aeefff25a<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:16:49<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

git<span class="w"> </span>log<span class="w"> </span>feature2
commit<span class="w"> </span>02f337014fa6acbdcbcf79d4ecd6668cdd37d6cb<span class="w"> </span><span class="o">(</span>feature2<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:09<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c4<span class="w"> </span>commit

commit<span class="w"> </span>e4567ef53ad207ea88cc042140183f8e047a5b69
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:06<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit

commit<span class="w"> </span>cde011b84e70d5dfbd966b91f5d9ab0aeefff25a<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:16:49<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

<span class="c1">## 可以看见, feature2 上的两个 commit 时间晚于 feature1 的 c2/c3 commit, 但是又早于 feature1 上的 c5 commit</span>
<span class="c1">## 现在将 feature1 合并到 feature2</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature2
git<span class="w"> </span>merge<span class="w"> </span>feature1
<span class="c1">## 冲突提示</span>
Already<span class="w"> </span>on<span class="w"> </span><span class="s1">'feature2'</span>
Auto-merging<span class="w"> </span>README.md
CONFLICT<span class="w"> </span><span class="o">(</span>content<span class="o">)</span>:<span class="w"> </span>Merge<span class="w"> </span>conflict<span class="w"> </span><span class="k">in</span><span class="w"> </span>README.md
Automatic<span class="w"> </span>merge<span class="w"> </span>failed<span class="p">;</span><span class="w"> </span>fix<span class="w"> </span>conflicts<span class="w"> </span>and<span class="w"> </span><span class="k">then</span><span class="w"> </span>commit<span class="w"> </span>the<span class="w"> </span>result.
<span class="c1">## 解决冲突</span>
vim<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit

<span class="c1">## 再次查看feature2的提交记录, 发现多出来了一个 commit:faaa86d914cce98ab6dd6159ff76a4fe351f809e</span>
<span class="c1">## 并且时间顺序是按两个分支的时间排好序的(合并后时间有序未被打乱)</span>
commit<span class="w"> </span>6f9869531606418e4c40fabb9cfaabfa1425545a<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature2<span class="o">)</span>
Merge:<span class="w"> </span>02f3370<span class="w"> </span>a16e20a
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:20:13<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>Merge<span class="w"> </span>branch<span class="w"> </span><span class="s1">'feature1'</span><span class="w"> </span>into<span class="w"> </span>feature2

commit<span class="w"> </span>a16e20a00329b0a60cbf8f541ff999e065a907b0<span class="w"> </span><span class="o">(</span>feature1<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:13<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c5<span class="w"> </span>commit

commit<span class="w"> </span>02f337014fa6acbdcbcf79d4ecd6668cdd37d6cb
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:09<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c4<span class="w"> </span>commit

commit<span class="w"> </span>e4567ef53ad207ea88cc042140183f8e047a5b69
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:06<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit

commit<span class="w"> </span>bddb67864d6a8e5923618564304090a869dedf68
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:17:02<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>4a0978f9892241abd481251ed96f5a7b92199011
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:16:58<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>cde011b84e70d5dfbd966b91f5d9ab0aeefff25a<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:16:49<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init
</pre></div>
</div>
</section>
<section id="rebase">
<h3 id="rebase">5.6.3 rebase 时只有一个分支变更<a class="headerlink" href="#rebase" title="Link to this heading">¶</a></h3>
<p>rebase 分支未作出commit</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-rf<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>first-project
git<span class="w"> </span>init
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c0"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"init"</span>

<span class="c1">## 创建一个分支</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature

<span class="c1">## 在 master 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>master
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c1"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c1 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c2"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c2 commit"</span>

<span class="c1">## feature 合并 master 新增记录</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature
git<span class="w"> </span>rebase<span class="w"> </span>master

<span class="c1">## 查看日志, 可以看见 feature 分支上已经有了 master 的两个提交了, 并且指针feature和master同时指向HEAD</span>
git<span class="w"> </span>log<span class="w"> </span>--graph<span class="w"> </span>--pretty<span class="o">=</span>oneline<span class="w"> </span>--abbrev-commit
*<span class="w"> </span>715cf72<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature,<span class="w"> </span>master<span class="o">)</span><span class="w"> </span>c2<span class="w"> </span>commit
*<span class="w"> </span>5f626b8<span class="w"> </span>c1<span class="w"> </span>commit
*<span class="w"> </span>6a2e050<span class="w"> </span>init
</pre></div>
</div>
</section>
<section id="id21">
<h3 id="id21">5.6.4 rebase 时两个分支有变更<a class="headerlink" href="#id21" title="Link to this heading">¶</a></h3>
<p>rebase 分支作出commit</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-rf<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>first-project
git<span class="w"> </span>init
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c0"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"init"</span>

<span class="c1">## 创建一个分支</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature
<span class="c1">## 在 feature 上添加一个 commit</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c3"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c3 commit"</span>

<span class="c1">## 在 master 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>master
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c1"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c1 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c2"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c2 commit"</span>

<span class="c1">## 查看 feature 分支的log</span>
git<span class="w"> </span>log<span class="w"> </span>feature
commit<span class="w"> </span>d97013d9428e61d4d97ebe6a67b5c27d1b98c7cb<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:26:59<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit

commit<span class="w"> </span>fb9a4a69bbb4d187f0f3a94dbf0cb2938f114e62
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:26:55<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

<span class="c1">## 查看 master 分支的log</span>
git<span class="w"> </span>log<span class="w"> </span>master
commit<span class="w"> </span>0ec71a9b42831756babb31aba75d56e0e73a6c68<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:27:10<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>fdf2a2ec1967c0f29e60d65fa285f627e2cd6767
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:27:07<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>fb9a4a69bbb4d187f0f3a94dbf0cb2938f114e62
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:26:55<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

<span class="c1">## 可以看见 feature 分支上的 c3 commit 时间早于 master 分支的 c1/c2 commit</span>
<span class="c1">## feature 合并 master 新增记录</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature
git<span class="w"> </span>rebase<span class="w"> </span>master
<span class="c1">## 提示有冲突, 解决冲突</span>
vim<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>rebase<span class="w"> </span>--continue
<span class="c1">## 再次查看 feature 分支的 log, 发现 c3 commit 时间早于 master 分支的 c1/c2 commit, 但是排在了最后面(没按时间排序)</span>
<span class="c1">## 并且, c3 commit 的 commit id 已经变了.</span>
<span class="c1">## rebase 原理: 一次 rebase 中, 会拿到 当前分支最新的 commit、被 rebase 分支最新的 commit、以及它们最近的一个父commit,</span>
<span class="c1">##     然后将当前分支 从父commit到当前最新commit 移动到被 rebase 分支最新代码之后(此时被移动过来的commit是属于被重新commit了, 和原来的已经不一样了)</span>
<span class="c1">##     最后将当前分支的指针移动到最近的地方.</span>
commit<span class="w"> </span>e5fd30e03a32d1a902895dfa8ec51e50ba02bd41<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:26:59<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit

commit<span class="w"> </span>0ec71a9b42831756babb31aba75d56e0e73a6c68<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:27:10<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>fdf2a2ec1967c0f29e60d65fa285f627e2cd6767
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:27:07<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>fb9a4a69bbb4d187f0f3a94dbf0cb2938f114e62
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Thu<span class="w"> </span>Apr<span class="w"> </span><span class="m">6</span><span class="w"> </span><span class="m">23</span>:26:55<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

<span class="c1">## 查看 feature 的log, 也能得出上面说的原理</span>
*<span class="w"> </span>e5fd30e<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature<span class="o">)</span><span class="w"> </span>c3<span class="w"> </span>commit
*<span class="w"> </span>0ec71a9<span class="w"> </span><span class="o">(</span>master<span class="o">)</span><span class="w"> </span>c2<span class="w"> </span>commit
*<span class="w"> </span>fdf2a2e<span class="w"> </span>c1<span class="w"> </span>commit
*<span class="w"> </span>fb9a4a6<span class="w"> </span>init
</pre></div>
</div>
</section>
<section id="id22">
<h3 id="id22">5.6.5 rebase 总结<a class="headerlink" href="#id22" title="Link to this heading">¶</a></h3>
<p>rebase 的时候, 找到 <strong>当前分支</strong> 和 <strong>被rebase分支</strong> 的父commit, 然后找到当前分支在父commit之后所有的commit记录, 把这些 commit 记录移动到被 rebase 分支上去, 这些 commit 记录已经不是原来的 commit 了(因为 commit id 已经改变了)。或者通俗来说: rebase 就是被rebase分支插入到当前分支之前, 例如: 从 master checkout 一个 feature 用作开发, 开发一段时间之后, 有人给 master 提交代码了(如fixbug), 那么我们应该 rebase master 到当前分支, 当 master 最新的代码放到 feature 最前面.</p>
<p>根据上面说的, rebase 是将 被rebase 分支的commit 放到最前面, 所以在后续开发中, 如果 feature 分支需要回退版本, 那么这将很好追溯代码; 如果我们使用 merge 将master 提交的代码合并到 feature 分支, 那回退版本就可以能把别人提交的代码也删掉了.</p>
<p>同样的, 因为 rebase 会让当前分支的 commit 重新生成, 这会改变分支的历史, 在 push 到远程分支的时候, 会提示你的代码和远程分支不一致, 这就需要强制 push 了( <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">--force-with-lease</span> <span class="pre">origin</span> <span class="pre">mybranch</span></code> ), 所以, <strong>千万不要在公共分支上使用 rebase, 历史被打乱是一件很严重的事情!!!</strong></p>
<ol class="arabic simple">
<li><p>在公共分支上不要使用 rebase, 应该用 merge;</p></li>
<li><p>功能分支上, 可以选择 rebase(不介意时间顺序, 把自己的 commit 顶到最后).</p></li>
</ol>
</section>
<section id="id23">
<h3 id="id23">5.6.6 rebase 的命令行操作<a class="headerlink" href="#id23" title="Link to this heading">¶</a></h3>
<p>开启命令行操作</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>your_commit_id
</pre></div>
</div>
<div class="admonition-example admonition hint">
<p class="admonition-title">example</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>HEAD~3
</pre></div>
</div>
</div>
<p>之后会提示很多信息</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1">### 可以选择的操作</span>
<span class="c1"># Commands:</span>
<span class="c1">### p: 选择一个提交并且应用它: pick 111111e c1 first-commit -&gt; 改变分支的 commit 信息为 first-commit,其commit id 是 111111e</span>
<span class="c1"># p, pick &lt;commit&gt; = use commit</span>
<span class="c1"># r, reword &lt;commit&gt; = use commit, but edit the commit message</span>
<span class="c1"># e, edit &lt;commit&gt; = use commit, but stop for amending</span>
<span class="c1"># s, squash &lt;commit&gt; = use commit, but meld into previous commit</span>
<span class="c1"># f, fixup [-C | -c] &lt;commit&gt; = like "squash" but keep only the previous</span>
<span class="c1">#                    commit's log message, unless -C is used, in which case</span>
<span class="c1">#                    keep only this commit's message; -c is same as -C but</span>
<span class="c1">#                    opens the editor</span>
<span class="c1"># x, exec &lt;command&gt; = run command (the rest of the line) using shell</span>
<span class="c1"># b, break = stop here (continue rebase later with 'git rebase --continue')</span>
<span class="c1"># d, drop &lt;commit&gt; = remove commit</span>
<span class="c1"># l, label &lt;label&gt; = label current HEAD with a name</span>
<span class="c1"># t, reset &lt;label&gt; = reset HEAD to a label</span>
<span class="c1"># m, merge [-C &lt;commit&gt; | -c &lt;commit&gt;] &lt;label&gt; [# &lt;oneline&gt;]</span>
<span class="c1"># .       create a merge commit using the original merge commit's</span>
<span class="c1"># .       message (or the oneline, if no original merge commit was</span>
<span class="c1"># .       specified); use -c &lt;commit&gt; to reword the commit message</span>
<span class="c1">#</span>
<span class="c1"># These lines can be re-ordered; they are executed from top to bottom.</span>
<span class="c1">#</span>
<span class="c1"># If you remove a line here THAT COMMIT WILL BE LOST.</span>
<span class="c1">#</span>
<span class="c1"># However, if you remove everything, the rebase will be aborted.</span>
<span class="c1">#</span>
</pre></div>
</div>
<p>假设现在有如下 commit 记录</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>..
rm<span class="w"> </span>-rf<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>first-project
git<span class="w"> </span>init
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c0"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"init"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c1"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c1 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c2"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c2 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c3"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c3 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c4"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c4 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c5"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c5 commit"</span>

git<span class="w"> </span>log
commit<span class="w"> </span>84a6eefbec1d95b74f75b2f4ce290291bf70ac7d<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:16:51<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c5<span class="w"> </span>commit

commit<span class="w"> </span>f7dfd4a23515f8b4c5f35df7f10a0436887de8b9
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:16:50<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c4<span class="w"> </span>commit

commit<span class="w"> </span>9cbec48fce6bf102dc9160a2c60fb04d8038de14
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:16:50<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit

commit<span class="w"> </span>1d316c48f7879387bee619f68de1c1d635d01350
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:16:50<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>3e477718c5c4a00bc708e4e413e79104651e784b
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:16:50<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>e8e267817444fb8601ddd76ac98af570cfb546eb
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:16:50<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init
</pre></div>
</div>
<section id="squash">
<h4 id="squash">squash<a class="headerlink" href="#squash" title="Link to this heading">¶</a></h4>
<p>我想要将 c4 commit 和 c3 commit 合并成一个commit</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>e8e267817444fb8601ddd76ac98af570cfb546eb
pick<span class="w"> </span>3e47771<span class="w"> </span>c1<span class="w"> </span>commit
pick<span class="w"> </span>1d316c4<span class="w"> </span>c2<span class="w"> </span>commit
pick<span class="w"> </span>9cbec48<span class="w"> </span>c3<span class="w"> </span>commit
squash<span class="w"> </span>f7dfd4a<span class="w"> </span>c4<span class="w"> </span>commit
pick<span class="w"> </span>84a6eef<span class="w"> </span>c5<span class="w"> </span>commit

<span class="c1">## 修改合并的commit信息</span>

<span class="c1">## 查看 log</span>
commit<span class="w"> </span>779c9bf0f7503a0b7020a447666c7ef3c241b884<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:19:01<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c5<span class="w"> </span>commit

commit<span class="w"> </span>0e4b3536cb998f3ffab91746954366915d9eb360
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:19:01<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit
<span class="w">    </span>c4<span class="w"> </span>commit

commit<span class="w"> </span>348af55dbbb9472ca132ff6ad0aa159efe9d6fca
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:19:01<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>282990a0baf322e25c49c0245fecb9ff4bd0bab6
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:19:01<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>0ac0f9228c9be4b02632e01849036d8eeee73378
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:19:01<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

<span class="c1">## 查看 0e4b353 变更了哪些东西, 可以看见, 本次 commit, 修改了 README.md 文件, 添加了 c3/c4 两行代码</span>
commit<span class="w"> </span>0e4b3536cb998f3ffab91746954366915d9eb360
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">00</span>:19:01<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit
<span class="w">    </span>c4<span class="w"> </span>commit

diff<span class="w"> </span>--git<span class="w"> </span>a/README.md<span class="w"> </span>b/README.md
index<span class="w"> </span>c3f2bc9..d226868<span class="w"> </span><span class="m">100644</span>
---<span class="w"> </span>a/README.md
+++<span class="w"> </span>b/README.md
@@<span class="w"> </span>-1,3<span class="w"> </span>+1,5<span class="w"> </span>@@
c0
c1
c2
+c3
+c4
</pre></div>
</div>
</section>
<section id="fixup">
<h4 id="fixup">fixup<a class="headerlink" href="#fixup" title="Link to this heading">¶</a></h4>
<p>也可以使用 fixup 代替 squash, fixup 不会保留合并的的提交信息, 可以使用此操作将一个小的提交合并到之前的提交中</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>0ac0f9228c9be4b02632e01849036d8eeee73378
pick<span class="w"> </span>fdf2a2e<span class="w"> </span>c1<span class="w"> </span>commit
pick<span class="w"> </span>0ec71a9<span class="w"> </span>c2<span class="w"> </span>commit
pick<span class="w"> </span>e5fd30e<span class="w"> </span>c3<span class="w"> </span>commit
fixup<span class="w"> </span>69799d0<span class="w"> </span>c4<span class="w"> </span>commit
pick<span class="w"> </span>cb1017b<span class="w"> </span>c5<span class="w"> </span>commit
</pre></div>
</div>
</section>
<section id="edit">
<h4 id="edit">edit<a class="headerlink" href="#edit" title="Link to this heading">¶</a></h4>
<p>当然还可以修改 commit 信息</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>0ac0f9228c9be4b02632e01849036d8eeee73378
pick<span class="w"> </span>fdf2a2e<span class="w"> </span>c1<span class="w"> </span>commit
pick<span class="w"> </span>0ec71a9<span class="w"> </span>c2<span class="w"> </span>commit
pick<span class="w"> </span>e5fd30e<span class="w"> </span>c3<span class="w"> </span>commit
edit<span class="w"> </span>69799d0<span class="w"> </span>c4<span class="w"> </span>commit
pick<span class="w"> </span>cb1017b<span class="w"> </span>c5<span class="w"> </span>commit

<span class="c1"># 执行以下命令开始操作(可以执行多次)</span>
git<span class="w"> </span>commit<span class="w"> </span>--amend
<span class="c1">## 填写 commit 信息</span>
<span class="c1">## 修改到满意之后, 执行以下命令生效</span>
git<span class="w"> </span>rebase<span class="w"> </span>--continue
</pre></div>
</div>
</section>
<section id="reword">
<h4 id="reword">reword<a class="headerlink" href="#reword" title="Link to this heading">¶</a></h4>
<p>修改 commit 信息也可以直接使用 reword, 这将直接开始修改</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>0ac0f9228c9be4b02632e01849036d8eeee73378
pick<span class="w"> </span>fdf2a2e<span class="w"> </span>c1<span class="w"> </span>commit
pick<span class="w"> </span>0ec71a9<span class="w"> </span>c2<span class="w"> </span>commit
pick<span class="w"> </span>e5fd30e<span class="w"> </span>c3<span class="w"> </span>commit
reword<span class="w"> </span>69799d0<span class="w"> </span>c4<span class="w"> </span>commit
pick<span class="w"> </span>cb1017b<span class="w"> </span>c5<span class="w"> </span>commit
</pre></div>
</div>
</section>
<section id="drop">
<h4 id="drop">drop<a class="headerlink" href="#drop" title="Link to this heading">¶</a></h4>
<p>除此之外, 还可以删除某个 commit</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>rebase<span class="w"> </span>-i<span class="w"> </span>0ac0f9228c9be4b02632e01849036d8eeee73378
pick<span class="w"> </span>fdf2a2e<span class="w"> </span>c1<span class="w"> </span>commit
pick<span class="w"> </span>0ec71a9<span class="w"> </span>c2<span class="w"> </span>commit
pick<span class="w"> </span>e5fd30e<span class="w"> </span>c3<span class="w"> </span>commit
drop<span class="w"> </span>69799d0<span class="w"> </span>c4<span class="w"> </span>commit
pick<span class="w"> </span>cb1017b<span class="w"> </span>c5<span class="w"> </span>commit
</pre></div>
</div>
</section>
</section>
</section>
<section id="cherry-pick">
<h2 id="cherry-pick">5.7 cherry-pick<a class="headerlink" href="#cherry-pick" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span></code>  命令用于将指定的提交（commit）应用于当前分支。这个命令可以方便地将其他分支或者提交的修改应用到当前分支中，而无需将整个分支合并。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>rm<span class="w"> </span>-rf<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>mkdir<span class="w"> </span>first-project<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="nb">cd</span><span class="w"> </span>first-project
git<span class="w"> </span>init
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c0"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"init"</span>

<span class="c1">## 创建两个分支</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature1
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature2

<span class="c1">## 在 feature1 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature1
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c1"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c1 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c2"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c2 commit"</span>

<span class="c1">## 在 feature2 上添加两个 commit</span>
git<span class="w"> </span>checkout<span class="w"> </span>feature2
<span class="nb">echo</span><span class="w"> </span><span class="s2">"c3"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c3 commit"</span>

<span class="nb">echo</span><span class="w"> </span><span class="s2">"c4"</span><span class="w"> </span>&gt;&gt;<span class="w"> </span>README.md
git<span class="w"> </span>add<span class="w"> </span>README.md
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"c4 commit"</span>

git<span class="w"> </span>log<span class="w"> </span>feature1
commit<span class="w"> </span>762ae4b983da0bff873877779cd74e1aa8d10f88<span class="w"> </span><span class="o">(</span>feature1<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">01</span>:07:24<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c2<span class="w"> </span>commit

commit<span class="w"> </span>32fd3337cdf54589d9e6c46626886cd3c8936fa1
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">01</span>:07:24<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c1<span class="w"> </span>commit

commit<span class="w"> </span>526925ca652065f75129e49f25090d58d33ce31f<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">01</span>:07:24<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init

git<span class="w"> </span>log<span class="w"> </span>feature2
commit<span class="w"> </span>f956ab14791d3d3718a57ddd8f062178f808cf44<span class="w"> </span><span class="o">(</span>HEAD<span class="w"> </span>-&gt;<span class="w"> </span>feature2<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">01</span>:07:24<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c4<span class="w"> </span>commit

commit<span class="w"> </span>b0666c02180c1bddf60190e14bb9391379b54598
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">01</span>:07:24<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>c3<span class="w"> </span>commit

commit<span class="w"> </span>526925ca652065f75129e49f25090d58d33ce31f<span class="w"> </span><span class="o">(</span>master<span class="o">)</span>
Author:<span class="w"> </span>kino<span class="w"> </span>&lt;kinoxyz1@gmail.com&gt;
Date:<span class="w">   </span>Fri<span class="w"> </span>Apr<span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="m">01</span>:07:24<span class="w"> </span><span class="m">2023</span><span class="w"> </span>+0800

<span class="w">    </span>init
</pre></div>
</div>
<p>现在讲 feature1 分支上的 762ae4b983da0bff873877779cd74e1aa8d10f88 应用到 feature2 上</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>checkout<span class="w"> </span>feature2
git<span class="w"> </span>cherry-pick<span class="w"> </span>762ae4b983da0bff873877779cd74e1aa8d10f88
</pre></div>
</div>
<p>如果有冲突, 需要解决冲突后, 使用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">add</span></code>  添加到暂存区, 然后使用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span> <span class="pre">--continue</span></code>  继续 cherry-pick 操作, 直到完成.</p>
<div class="admonition-git-cherry-pick admonition danger">
<p class="admonition-title">使用  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">cherry-pick</span></code>  命令将提交应用到当前分支时，也可能会引入新的问题，因此在使用该命令时需要谨慎</p>
</div>
</section>
<section id="id24">
<h2 id="id24">六、参与开源项目<a class="headerlink" href="#id24" title="Link to this heading">¶</a></h2>
<p>这里我们以袋鼠云的 chunjun 做示例, 首先我们需要 [fork](<a class="reference external" href="https://github.com/DTStack/chunjun">https://github.com/DTStack/chunjun</a>) 该项目。</p>
<img alt="img/git/1.git-fork.png" src="img/git/1.git-fork.png"/>
<p>然后就可以在自己的仓库中看到 chunjun 项目了</p>
<p>![git-fork-after](../../img/git/2.git-fork-after.png)</p>
<p>clone 我们仓库中的 chunjun 项目</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/your-github-name/chunjun.git
</pre></div>
</div>
<p>添加远程分支</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>remote<span class="w"> </span>add<span class="w"> </span>upstream<span class="w"> </span>https://github.com/DTStack/chunjun.git
</pre></div>
</div>
<p>添加了之后可以查看远程仓库</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>remote<span class="w"> </span>-v
origin<span class="w">  </span>https://github.com/your-github-name/chunjun.git<span class="w"> </span><span class="o">(</span>fetch<span class="o">)</span>
origin<span class="w">  </span>https://github.com/your-github-name/chunjun.git<span class="w"> </span><span class="o">(</span>push<span class="o">)</span>
upstream<span class="w">    </span>https://github.com/DTStack/chunjun.git<span class="w"> </span><span class="o">(</span>fetch<span class="o">)</span>
upstream<span class="w">    </span>https://github.com/DTStack/chunjun.git<span class="w"> </span><span class="o">(</span>push<span class="o">)</span>
</pre></div>
</div>
<p>不论是准备开发一个新功能，还是准备提交一个 pr，都需要优先更新远程分支到本地, 例如, 现在你需要基于master开发一个新的功能，你可以做如下操作</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="c1"># 可以使用</span>
git<span class="w"> </span>pull
<span class="c1"># 或者使用</span>
git<span class="w"> </span>fetch<span class="w"> </span>upstream<span class="w"> </span>-p
git<span class="w"> </span>rebase<span class="w"> </span>upstream/master

<span class="c1"># 然后基于 master 创建一个 feature 分支(一般新功能需要先写issue和社区同学讨论该功能，比如和作者讨论你的想法是否能带来好的效果、以及该功能是否可行)</span>
git<span class="w"> </span>checkout<span class="w"> </span>-b<span class="w"> </span>feature_your-issueid
</pre></div>
</div>
<p>等你开发完功能，并且完成测试之后，可以提交代码, 注意这里先不要直接push</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>commit<span class="w"> </span>-m<span class="w"> </span><span class="s2">"your-commit-message"</span>
</pre></div>
</div>
<p>此时你开发一个功能可能耗时1h，期间已经有其他同学提交了代码，所以你还需要保持最新代码,</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>fetch<span class="w"> </span>upstream
git<span class="w"> </span>rebase<span class="w"> </span>upstream/feature_your-issueid
</pre></div>
</div>
<p>rebase 之后可能会有文件冲突，需要按需解决冲突，将所有冲突都解决之后再执行</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>add<span class="w"> </span>.
git<span class="w"> </span>rebase<span class="w"> </span>--continue
</pre></div>
</div>
<p>看到提示  <code class="docutils literal notranslate"><span class="pre">rebase</span> <span class="pre">successful</span></code>  之类的就表示冲突解决完成了，然后就提交到你的github 仓库中(注意不是upstream), rebase 之后可能无法正常推送, 需要  <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">push</span> <span class="pre">-f</span></code>  强制推送，这个操作有风险, 操作前请仔细检查以避免出现无关代码被强制覆盖的问题, 具体风险可以看 &lt;a href=”#56-git-rebase”&gt;5.6 rebase&lt;/a&gt; 相关的解释。</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>push<span class="w"> </span>origin<span class="w"> </span>feature_your-issueid
</pre></div>
</div>
<p>然后按页面提示，提交pr</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="index.html" title="杂"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> "Previous" </span> 杂 </span>
              </div>
            </a>
          
          
            <a href="hadoop.html" title="(Apache 基金会的) Hadoop"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> "Next" </span> (Apache 基金会的) Hadoop </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2024, coconut.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>