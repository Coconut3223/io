<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>CNN &#8212; cocobook  æ–‡æ¡£</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=83e35b93" />
    <link rel="stylesheet" type="text/css" href="../../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=87e54e7c" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/katex-math.css?v=91adb8b6" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/def.css?v=5a9d86bd" />
    <script src="../../_static/documentation_options.js?v=7d86a446"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/translations.js?v=beaddf03"></script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <link rel="index" title="ç´¢å¼•" href="../../genindex.html" />
    <link rel="search" title="æœç´¢" href="../../search.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue-grey data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#AI/DL/cnn" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../../index.html" title="cocobook  æ–‡æ¡£"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">cocobook  æ–‡æ¡£</span>
          <span class="md-header-nav__topic"> CNN </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="../../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../../"versions.json"",
        target_loc = "../../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../../index.html" class="md-tabs__link">cocobook  æ–‡æ¡£</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../../index.html" title="cocobook æ–‡æ¡£" class="md-nav__button md-logo">
      
        <img src="../../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../../index.html"
       title="cocobook æ–‡æ¡£">cocobook  æ–‡æ¡£</a>
  </label>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#ai-dl-cnn--page-root" class="md-nav__link">CNN</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#introduction" class="md-nav__link">Introduction</a>
        </li>
        <li class="md-nav__item"><a href="#keywords" class="md-nav__link">Keywords</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#shared-weights" class="md-nav__link">Shared Weightsï¼Œå…±äº«æƒé‡</a>
        </li>
        <li class="md-nav__item"><a href="#local-receptive-fields-sparse-connectivity" class="md-nav__link">Local Receptive Fields & Sparse Connectivity, å±€éƒ¨æ„ŸçŸ¥åŸŸ & ç¨€ç–è¿æ¥</a>
        </li>
        <li class="md-nav__item"><a href="#spatial-information" class="md-nav__link">Spatial Information</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#structure" class="md-nav__link">Structure</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#input-layer" class="md-nav__link">Input Layer</a>
        </li>
        <li class="md-nav__item"><a href="#convolution-layers-conv" class="md-nav__link">Convolution Layers, Conv</a>
        </li>
        <li class="md-nav__item"><a href="#filters-kernels" class="md-nav__link">Filters, Kernels</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#about-size" class="md-nav__link">about Size</a>
        </li>
        <li class="md-nav__item"><a href="#about-stride-s" class="md-nav__link">about Stride sï¼šç§»åŠ¨çš„æ–¹æ ¼</a>
        </li>
        <li class="md-nav__item"><a href="#about-padding" class="md-nav__link">about Padding</a>
        </li>
        <li class="md-nav__item"><a href="#about-meaning" class="md-nav__link">about Meaning</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#batch-normalization" class="md-nav__link">Batch Normalization</a>
        </li>
        <li class="md-nav__item"><a href="#activation-function" class="md-nav__link">Activation function</a>
        </li>
        <li class="md-nav__item"><a href="#pooling-layer" class="md-nav__link">Pooling Layer, æ± åŒ–å±‚</a>
        </li>
        <li class="md-nav__item"><a href="#flatten-layer-tensor-reshape" class="md-nav__link">Flatten Layer â€” Tensor Reshape</a>
        </li>
        <li class="md-nav__item"><a href="#fully-connected-layer-fc" class="md-nav__link">Fully- Connected Layer, FC</a>
        </li>
        <li class="md-nav__item"><a href="#softmax" class="md-nav__link">softmax</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#famous-cnn-architectures" class="md-nav__link">Famous CNN Architectures</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#deeper-or-wider" class="md-nav__link">Deeper or Wider?</a>
        </li>
        <li class="md-nav__item"><a href="#lenet-5" class="md-nav__link"><strong>LeNet-5</strong></a>
        </li>
        <li class="md-nav__item"><a href="#alexnet" class="md-nav__link">AlexNet</a>
        </li>
        <li class="md-nav__item"><a href="#vgg-net" class="md-nav__link">VGG Net</a>
        </li>
        <li class="md-nav__item"><a href="#residual-net-resnet" class="md-nav__link">Residual Net, <strong>ResNet</strong></a>
        </li>
        <li class="md-nav__item"><a href="#dense-net" class="md-nav__link"><strong>Dense Net</strong></a>
        </li>
        <li class="md-nav__item"><a href="#googlenet" class="md-nav__link"><strong>GoogleNet</strong></a>
        </li>
        <li class="md-nav__item"><a href="#light-weight-networks" class="md-nav__link">Light-weight networks</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#practical-exercise" class="md-nav__link">Practical Exercise</a>
        </li>
        <li class="md-nav__item"><a href="#parameters-initialization" class="md-nav__link">Parameters Initialization</a>
        </li>
        <li class="md-nav__item"><a href="#bach-normalization" class="md-nav__link">Bach Normalization</a>
        </li>
        <li class="md-nav__item"><a href="#application" class="md-nav__link">Application</a>
        </li>
        <li class="md-nav__item"><a href="#edge-detection" class="md-nav__link">Edge Detection</a>
        </li>
        <li class="md-nav__item"><a href="#exercise" class="md-nav__link">Exercise</a>
        </li>
        <li class="md-nav__item"><a href="#code" class="md-nav__link">code</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../../_sources/AI/DL/cnn.rst.txt">æ˜¾ç¤ºæºä»£ç </a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="cnn">
<h1 id="ai-dl-cnn--page-root">CNN<a class="headerlink" href="#ai-dl-cnn--page-root" title="Link to this heading">Â¶</a></h1>
<p>!!! danger â€œTo maintain spatial struture.â€</p>
<dl>
<dt>!!! p â€œsummaryâ€</dt><dd><p><span class="defi">Conv</span></p>
<ul class="simple">
<li><p>Accept a volume of size $W_1times H_1times D_1$</p></li>
<li><p>Requires 4 hyperparameters
- Number of filters $K$
- Filterâ€™ size $F$
- Stride $S$
- Zero padding $P$</p></li>
<li><p>Number of weights $(Ftimes Ftimes D_1)times K + Ktext{(shared bias)}$</p></li>
<li><p>Produce a volume of size $(frac{W_1-F+2P}{S}+1)times(frac{H_1-F+2P}{S}+1)times K$</p></li>
<li><p>In the output volume, the $d^{th}$ of $W_2times H_2$ is the result of performing a valid convolution of the $d^{th}$ filter over the input volume with a stride $S$, and the offser by $d^{th}$ bias.</p></li>
</ul>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 18)</p>
<p>Bullet list ends without a blank line; unexpected unindent.</p>
</aside>
<p>â€”</p>
<p><span class="defi">Pool</span></p>
<ul class="simple">
<li><p>Accept a volume of size $W_2times H_2times K$</p></li>
<li><p>Requires 2 hyperparameters
- pooling kernelâ€™ size $F$
- Stride $S$</p></li>
<li><p>Number of weights $0$</p></li>
<li><p>Produce a volume of size $(frac{W_2-F}{S}+1)times(frac{H_2-F}{S}+1)$</p></li>
<li><p>It is not common to use zero padding for pooling layer.</p></li>
</ul>
</dd>
<dt>!!! p â€œcommon settingâ€</dt><dd><p>$K$ 2 çš„å¹‚
F3S1P1, F5S1P2, F5S2P(whatever fits),F1S1P0</p>
</dd>
</dl>
<section id="introduction">
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Link to this heading">Â¶</a></h2>
<p><strong>Inï¼š</strong> Vision Taskï¼Œå°±æ˜¯**é’ˆå¯¹å›¾åƒè¿™ä¸€ç‰¹æ®Šç»“æ„**ï¼ŒåŒ…æ‹¬å›¾ç‰‡åˆ†ç±», Object Detection ç›®æ ‡æ£€æµ‹ï¼Œè¾¹ç¼˜æ£€æµ‹, Object Segmentation ç›®æ ‡æå–ï¼Œå›¾ç‰‡é£æ ¼è¿ç§»ï¼Œ Image Captioning çœ‹å›¾è¯´è¯, Retrieval æ¢å¤å›¾ç‰‡â€¦</p>
<p>å…³äºå¤„ç†çš„å›¾ç‰‡å¯¹è±¡ï¼Œæœ‰å•çº¯åŸºäº <strong>é»‘ç™½ç…§ç‰‡ç°åº¦å›¾åƒ(widthâœ–ï¸height)</strong> çš„å·ç§¯ï¼Œä¹Ÿæœ‰åŸºäº <strong>å½©è‰²ç…§ç‰‡ç«‹ä½“RGB(widethâœ–ï¸heightâœ–ï¸depthchannel)</strong> çš„å·ç§¯</p>
<dl class="simple">
<dt>!!! p â€œâ€</dt><dd><p>&lt;u&gt;CNNÂ is a sequence ofÂ Convolution Layers, interspersed with activation functions&lt;/u&gt;.
&lt;div class=â€gridâ€ markdown&gt;
&lt;p&gt;CNN is proposed toÂ reduceÂ the number of parameters, preserveÂ the image layout information, and make the networkÂ deeper &lt;/p&gt;
&lt;figure markdown=â€spanâ€&gt;![](./pics/CNN_22.png){width=80%}&lt;/figure&gt;
&lt;/div&gt;</p>
</dd>
</dl>
<p>!!! p â€œå’Œå…¨è¿æ¥ç›¸æ¯”è¾ƒï¼Œå…¨è¿æ¥çš„å‚æ•°æ•°é‡è¾ƒå¤šï¼ˆä¸¤å±‚ä¹‹é—´çš„ç¥ç»å…ƒéœ€è¦ä¸¤ä¸¤ç›¸è¿ï¼‰ï¼Œå·ç§¯ç¥ç»ç½‘ç»œçš„å‚æ•°è¾ƒå°‘ï¼Œä¸»è¦æ˜¯ç”±äºæƒå€¼å…±äº«å’Œç¨€ç–è¿æ¥ã€‚â€</p>
<p>![](./pics/CNN_1.png){width=80%}
![](./pics/CNN_2.png){width=80%}
![](./pics/CNN_3.png){width=80%}
![](./pics/CNN_4.png){width=80%}</p>
<ol class="arabic simple">
<li><p>The input of image data into the convolution neural network is processed with the help of pixel values of the image in the convolution layer.</p></li>
<li><p><span class="defi">Filters</span> are generated that perform convolutions over the entire image and train the network to identify and learn features from images, which are converted to matrices.</p></li>
<li><p><span class="defi">Batch</span> normalization of input vectors is performed at each layer, so as to ensure all input vectors are <strong>normalized</strong> and hence regularization in the network is attained.</p></li>
<li><p>The convolutions are performed until better accuracy has been attained and maximum feature extraction is done.</p></li>
<li><p>Convolutions result in the <strong>sub-sampling</strong> of images and the dimensions of input get changed according to <span class="defi">padding</span> and <span class="defi">stride</span> chosen.</p></li>
<li><p>Each convolution follows the <span class="defi">activation layer(ReLU)</span> and ==pooling layer==, which brings in <strong>non-linearity</strong> and helps in <strong>sub-sampling</strong> respectively.</p></li>
<li><p>After the final convolution, the input matrix is converted to feature vectors. This feature vector is the ==flattened layer==.</p></li>
<li><p>Feature vector serves as input to the next layer(fully connected layer), where all features are collectively transferred into this network. <span class="defi">Dropout</span> of random nodes occurs during training to reduce overfitting in this layer.</p></li>
<li><p>Finally, the raw values which are predicted output by the network are converted to probabilistic values with the use of ==softmax function==.</p></li>
</ol>
</section>
<section id="keywords">
<h2 id="keywords">Keywords<a class="headerlink" href="#keywords" title="Link to this heading">Â¶</a></h2>
<p>==å…±äº«æƒé‡==, ==å±€éƒ¨æ„ŸçŸ¥åŸŸ &amp; ç¨€ç–è¿æ¥==,:defi:<cite>Spatial Information</cite></p>
<section id="shared-weights">
<h3 id="shared-weights">Shared Weightsï¼Œå…±äº«æƒé‡<a class="headerlink" href="#shared-weights" title="Link to this heading">Â¶</a></h3>
<p>åŒä¸€ä¸ªfilteråœ¨è¾“å…¥çŸ©é˜µä¸­è¿›è¡Œæ‰«æ</p>
<p>ä¸€ä¸ªéšè—å±‚ä¸­çš„æ‰€æœ‰**ç¥ç»å…ƒéƒ½æ£€æµ‹åœ¨å›¾åƒçš„ä¸åŒä½ç½®å¤„çš„åŒä¸€ä¸ªç‰¹å¾ã€‚æƒé‡å…±äº«ï¼Œåˆ™æ£€æµ‹ç‰¹å¾ç›¸åŒã€‚** å› æ­¤ä¹Ÿå°†ä»è¾“å…¥å±‚åˆ°éšè—å±‚çš„è¿™ç§æ˜ å°„ç§°ä¸º&lt;u&gt;ç‰¹å¾æ˜ å°„ï¼Œfilters, kernels&lt;/u&gt;ã€‚è¯¥ç‰¹å¾æ˜ å°„çš„æƒé‡ç§°ä¸º**å…±äº«æƒé‡**ï¼Œå…¶åç½®ç§°ä¸ºå…±äº«åç½®ã€‚</p>
</section>
<section id="local-receptive-fields-sparse-connectivity">
<h3 id="local-receptive-fields-sparse-connectivity">Local Receptive Fields &amp; Sparse Connectivity, å±€éƒ¨æ„ŸçŸ¥åŸŸ &amp; ç¨€ç–è¿æ¥<a class="headerlink" href="#local-receptive-fields-sparse-connectivity" title="Link to this heading">Â¶</a></h3>
<p>For convolution with kernel sizeÂ $K$, each element in the output depends on aÂ $Ktimes K$Â receptive field in the input.
Each successive convolution contains multiple regions from the previous one.
è¾“å‡ºçŸ©é˜µä¸­çš„æ¯ä¸€ä¸ªæ•°å€¼åªç”±è¾“å…¥æ•°æ®çš„ä¸€éƒ¨åˆ†è®¡ç®—å¾—æ¥ã€‚ä¸å¸¸è§„ç¥ç»ç½‘ç»œä¸€æ ·ï¼Œè¾“å…¥å±‚çš„ç¥ç»å…ƒéœ€è¦å’Œéšè—å±‚çš„ç¥ç»å…ƒè¿æ¥ã€‚ä½†è¿™é‡Œ**ä¸æ˜¯å°†æ¯ä¸€ä¸ªè¾“å…¥ç¥ç»å…ƒéƒ½ä¸æ¯ä¸€ä¸ªéšè—ç¥ç»å…ƒè¿æ¥**ï¼Œè€Œæ˜¯ä»…ä»…åœ¨ä¸€ä¸ªå›¾åƒçš„**å±€éƒ¨åŒºåŸŸåˆ›å»ºè¿æ¥**</p>
<p>![](./pics/CNN_5.png){width=60%}
![](./pics/CNN_6.png){width=60%}</p>
</section>
<section id="spatial-information">
<h3 id="spatial-information">Spatial Information<a class="headerlink" href="#spatial-information" title="Link to this heading">Â¶</a></h3>
<p>è¾“å…¥å±‚ï¼š<strong>äºŒç»´çŸ©é˜µæ’åˆ—**çš„**ç¥ç»å…ƒ</strong>ã€‚</p>
</section>
</section>
<section id="structure">
<h2 id="structure">Structure<a class="headerlink" href="#structure" title="Link to this heading">Â¶</a></h2>
<p>![](./pics/CNN_21.png){width=80%}</p>
<section id="input-layer">
<h3 id="input-layer">Input Layer<a class="headerlink" href="#input-layer" title="Link to this heading">Â¶</a></h3>
<p><strong>äºŒç»´çŸ©é˜µæ’åˆ—**çš„**ç¥ç»å…ƒ</strong>ã€‚</p>
</section>
<section id="convolution-layers-conv">
<h3 id="convolution-layers-conv">Convolution Layers, Conv<a class="headerlink" href="#convolution-layers-conv" title="Link to this heading">Â¶</a></h3>
<p>!!! p â€œConvolve the filter with the image $Rightarrow$ &lt;u&gt;slide over the image spatially, computing dot products&lt;/u&gt;â€</p>
<p>å®Œæˆå›¾åƒå’Œfilter çš„å·ç§¯å°±æ˜¯</p>
<ol class="arabic">
<li><p>ç”¨ä¸€ä¸ªå°å°çš„ $Ftimes Ftimes D$ shared filter åœ¨$Ntimes Ntimes D$ å›¾åƒä¸Š slide spatially, ç©ºé—´æ„ä¹‰ä¸Šåœ°æ»‘åŠ¨ã€‚</p></li>
<li><p>æ»‘åŠ¨çš„æ—¶å€™ï¼Œæ¯ä¸€æ¬¡æ¡†å®šçš„**å°å°å¯¹åº”å°ºå¯¸** $Ftimes Ftimes D$ å— chunk of the image, Local Receptive Fieldsï¼Œå’Œ $Ftimes Ftimes D$ shared filter åš dot product ==element-wise multiplication==ï¼Œ.</p>
<blockquote>
<div><dl class="simple">
<dt>!!! danger â€œâ€</dt><dd><p>Dä¸ª channelï¼Œéƒ½è¦åˆ†åˆ«å’Œè¾“å…¥çš„Dä¸ªchannel åšå·ç§¯ï¼Œå¾—åˆ°Dä¸ªç‰¹å¾å›¾ï¼Œç„¶å**é€šé“èåˆ, sum all the (weights x inputs) of D channels**</p>
</dd>
</dl>
</div></blockquote>
</li>
<li><p>å°†æ‰€æœ‰æ»‘åŠ¨çš„åˆ°çš„ç»“æœæŒ‰ç©ºé—´é¡ºåºé‡æ–°æ‹¼æˆ: $(N-F+1)times(N-F+1)times red{1}$ tensor</p></li>
<li><p>å†åŠ ä¸Š $(N-F+1)times(N-F+1)times red{1}$ shared bias åç½®</p></li>
</ol>
<p>ä»¥ä¸Šæ˜¯åšä¸€ä¸ªfilterçš„è¿‡ç¨‹ã€‚$w^Tx+b$ã€‚
å› ä¸º input image å’Œ filter çš„ä¹˜æ³•æ˜¯ ==element-wise multiplication==ï¼Œå°±å’Œå‘é‡ç‚¹ç§¯ä¸€æ ·ï¼Œæ‰€ä»¥å¯ä»¥æƒ³è±¡ä¸ºå¤šç»´çš„ chunk å’Œ filter å’Œ bias å±•å¹³æˆå‘é‡ï¼Œ$R^{Ftimes Ftimes D}xrightarrow{text{Flatten}}R^{F^2Dtimes 1}xrightarrow{text{dot product}}R$</p>
<p>$K$ ä¸ª filters å°±æœ‰ $K$ ä¸ª tensorï¼Œæœ€å <strong>stack å †å </strong> these up to get a new â€œimage tensorâ€<span class="defi">activation map</span> of size as the input of the next layer. ç«‹ä½“å·ç§¯çš„è¾“å‡ºç»“æœçš„ç»´åº¦ï¼Œé•¿å’Œå®½å’Œä¹‹å‰ç°åº¦å›¾åƒçš„è®¡ç®—ä¸€æ ·ï¼Œè€Œ**ç»“æœçš„é€šé“æ•°åˆ™ç”±è¿‡æ»¤å™¨çš„ä¸ªæ•°å†³å®š**
$$(N-F+1)times(N-F+1)times red{K}$$</p>
<p>&lt;div class=â€gridâ€ markdown&gt;
&lt;figure markdown=â€spanâ€&gt;![](./pics/CNN_7.jpeg){width=90%}&lt;p&gt;å¹³é¢çš„ï¼Œe.g.ï¼š<a href="#id1"><span class="problematic" id="id2">**</span></a>é»‘ç™½ç…§ç‰‡ç°åº¦å›¾åƒ**&lt;/p&gt;&lt;/figure&gt;
&lt;figure markdown=â€spanâ€&gt;![](./pics/CNN_8.png)&lt;p&gt;ç«‹ä½“çš„ï¼Œe.gï¼š<a href="#id3"><span class="problematic" id="id4">**</span></a>å½©è‰²ç…§ç‰‡ç«‹ä½“RGBå›¾åƒ**&lt;/p&gt;&lt;/figure&gt;
&lt;/div&gt;</p>
<aside class="system-message" id="id1">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 124); <em><a href="#id2">backlink</a></em></p>
<p>Inline strong start-string without end-string.</p>
</aside>
<aside class="system-message" id="id3">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 124); <em><a href="#id4">backlink</a></em></p>
<p>Inline strong start-string without end-string.</p>
</aside>
<ul class="simple">
<li><p>ç«‹ä½“çš„ï¼Œe.gï¼š<strong>å½©è‰²ç…§ç‰‡ç«‹ä½“RGBå›¾åƒ</strong></p></li>
</ul>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 130)</p>
<p>Bullet list ends without a blank line; unexpected unindent.</p>
</aside>
<p>è¿‡æ»¤å™¨æ˜¯ä¸€ä¸ªç«‹æ–¹ä½“ï¼Œåœ¨è¾“å…¥æ•°æ®ä¸Šæ‰«æï¼Œæ¯ä¸€ä¸ªé€šé“çš„æƒé‡åˆ†åˆ«ä¸è¾“å…¥å›¾ç‰‡çš„æ¯ä¸€ä¸ªé€šé“æ‰«æåˆ°çš„å€¼ç›¸ä¹˜å†åŠ å’Œå¾—åˆ°è¾“å‡ºçŸ©é˜µä¸Šçš„ä¸€ä¸ªè¾“å‡ºå€¼</p>
<p>&lt;figure markdown=â€spanâ€&gt;![](./pics/CNN_9.png){width=90%}&lt;p&gt;ç«‹ä½“çš„ï¼Œe.gï¼š<a href="#id5"><span class="problematic" id="id6">**</span></a>å½©è‰²ç…§ç‰‡ç«‹ä½“RGBå›¾åƒ**&lt;/p&gt;&lt;/figure&gt;</p>
<aside class="system-message" id="id5">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 132); <em><a href="#id6">backlink</a></em></p>
<p>Inline strong start-string without end-string.</p>
</aside>
<p>&lt;figure markdown=â€spanâ€&gt;![](./pics/CNN_10.png){width=90%}&lt;p&gt;ç«‹ä½“çš„ï¼Œe.gï¼š<a href="#id7"><span class="problematic" id="id8">**</span></a>å½©è‰²ç…§ç‰‡ç«‹ä½“RGBå›¾åƒ**&lt;/p&gt;&lt;/figure&gt;</p>
<aside class="system-message" id="id7">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 134); <em><a href="#id8">backlink</a></em></p>
<p>Inline strong start-string without end-string.</p>
</aside>
</section>
<section id="filters-kernels">
<h3 id="filters-kernels">Filters, Kernels<a class="headerlink" href="#filters-kernels" title="Link to this heading">Â¶</a></h3>
<p>!!! p â€œInput ImageÂ xÂ Â Feature DetectorÂ =Â ==Feature Map==â€</p>
<section id="about-size">
<h4 id="about-size">about Size<a class="headerlink" href="#about-size" title="Link to this heading">Â¶</a></h4>
<ol class="arabic">
<li><dl>
<dt>always <a href="#id9"><span class="problematic" id="id10">**</span></a>extend the full depth o**f the input volumeï¼Œ ä¸€ä¸ª filter çš„æ·±åº¦(é€šé“æ•°)è¦å’Œ input çš„æ·±åº¦(é€šé“æ•°)ä¸€æ ·ï¼Œä½†æ˜¯è¾“å‡ºä»åªæœ‰ä¸€ä¸ªé€šé“æ•°ã€‚</dt><dd><aside class="system-message" id="id9">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 144); <em><a href="#id10">backlink</a></em></p>
<p>Inline strong start-string without end-string.</p>
</aside>
<p>$$18=cfrac{32-5}{1}+1, 30=cfrac{32-3}{1}+1$$</p>
<p><code class="docutils literal notranslate"><span class="pre">`mermaid</span>
<span class="pre">graph</span> <span class="pre">LR</span>
<span class="pre">A[Input&lt;br&gt;32âœ–ï¸32âœ–ï¸&lt;FONT</span> <span class="pre">COLOR="#ff0000"&gt;3&lt;/FONT&gt;]</span>
<span class="pre">B{Filter&lt;br&gt;5âœ–ï¸5âœ–ï¸&lt;FONT</span> <span class="pre">COLOR="#ff0000"&gt;3&lt;/FONT&gt;}</span>
<span class="pre">C{Filter&lt;br&gt;3âœ–ï¸3âœ–ï¸&lt;FONT</span> <span class="pre">COLOR="#ff0000"&gt;3&lt;/FONT&gt;}</span>
<span class="pre">A</span> <span class="pre">--&gt;</span> <span class="pre">B</span>
<span class="pre">A</span> <span class="pre">--&gt;</span> <span class="pre">C</span>
<span class="pre">D{Stride&lt;br&gt;1}</span>
<span class="pre">B</span> <span class="pre">---</span> <span class="pre">D</span>
<span class="pre">C</span> <span class="pre">---</span> <span class="pre">D</span>
<span class="pre">E[Output&lt;br&gt;18âœ–ï¸18âœ–ï¸&lt;FONT</span> <span class="pre">COLOR="#ff0000"&gt;1&lt;/FONT&gt;]</span>
<span class="pre">F[Output&lt;br&gt;30âœ–ï¸30âœ–ï¸&lt;FONT</span> <span class="pre">COLOR="#ff0000"&gt;1&lt;/FONT&gt;]</span>
<span class="pre">D</span> <span class="pre">--&gt;</span> <span class="pre">E</span>
<span class="pre">D</span> <span class="pre">--&gt;</span> <span class="pre">F</span>
<span class="pre">`</span></code></p>
<p>![](./pics/CNN_11.png){width=60%}</p>
</dd>
</dl>
</li>
<li><p>dim of <strong>filter ä¸€èˆ¬ä¸ºå¥‡æ•°ï¼Œè‹¥ä¸ºå¶æ•°ï¼Œåˆ™ä¼šäº§ç”Ÿä¸å¯¹ç§°å¡«å……</strong></p></li>
</ol>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 166)</p>
<p>Enumerated list ends without a blank line; unexpected unindent.</p>
</aside>
<p>3. <strong>1âœ–ï¸1 Convolution</strong> is meaningful!
It computes the dot product over the channels.</p>
<p>&lt;figure markdown=â€spanâ€&gt;![](./pics/CNN_13.png){width=60%}&lt;p&gt;1âœ–ï¸1 Convolution&lt;/p&gt;&lt;/figure&gt;</p>
<p><strong>advantagesï¼š</strong></p>
<ul>
<li><p>Shrinking too volumes spatially</p>
<blockquote>
<div><p>!!! danger â€œShrinking too fast is not good,â€</p>
</div></blockquote>
</li>
</ul>
<p>æ¯”å¦‚è¯´CNNï¼ŒCNNæ˜¯ç”¨å·ç§¯æ ¸å’Œæ„Ÿå—é‡åšè¿ç®—ï¼Œæ¯ä¸€ä¸ªæ–°äº§ç”Ÿç‰¹å¾æ•°ï¼Œä¹Ÿå°±æ˜¯ output çš„ä¸€ä¸ªå°å°çš„æ•°å­—ï¼Œå›Šæ‹¬çš„ä¹Ÿåªæ˜¯ä¸€ä¸ªå°å°çš„æ„Ÿå—é‡çš„ä¿¡æ¯ã€‚å¯¹ä¸€ä¸ªkernel æ¥è¯´ï¼Œè™½ç„¶ output æ˜¯ç”±æ‰€æœ‰çš„æ„Ÿå—é‡ of input å·ç§¯ä¹‹åå †å è€Œæˆçš„ä¸€ä¸ª [L, W]çŸ©é˜µï¼Œä¹Ÿå°±æ˜¯è¿™ä¸€ä¸ª kernel å’Œæ‰€æœ‰çš„æ„Ÿå—é‡åšè¿ç®—çš„ç»“æœå †å è€Œæˆã€‚ä½†æ˜¯ <strong>ç®€å•å±€éƒ¨ç‰¹å¾å †å ä¸ç­‰äºå…¨å±€ç‰¹å¾ã€‚</strong> è¿™ä¹Ÿæ˜¯CNNç¨€ç–é“¾æ¥çš„ç‰¹ç‚¹ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å¸¸è¯´CNNå¯¹äºé‚£ç§é•¿åºåˆ— long sequence input ä¸å¤ªå‹å¥½ï¼Œå› ä¸ºå¯¹äºä¸¤ä¸ªé—´éš”æ¯”è¾ƒè¿œçš„ pixels æ¥è¯´ï¼Œè¦æ˜¯æƒ³è·å¾—ä»–ä»¬ä¹‹é—´çš„å…³ç³»ç‰¹å¾ï¼Œå°±éœ€è¦å †å å¾ˆå¤šä¸ªå·ç§¯å±‚ï¼Œæ‰èƒ½è·å¾—ä»–ä»¬çš„å…³ç³»ç‰¹å¾ã€‚</p>
<p>![](./pics/CNN_25.jpeg){width=60%}</p>
</section>
<section id="about-stride-s">
<h4 id="about-stride-s">about Stride sï¼šç§»åŠ¨çš„æ–¹æ ¼<a class="headerlink" href="#about-stride-s" title="Link to this heading">Â¶</a></h4>
<ol class="arabic">
<li><p>s = 1 ï¼ˆdefaultï¼‰</p></li>
<li><p><strong>do not want to capture all the data</strong> or information available so we skip some.</p></li>
<li><p>è®¾ç½®çš„ stride è¦è¢«åˆšå¥½è®¾ç½®çš„filterå·ç§¯åˆ°$$red{text{Output Size }(cfrac{N-F}{s}+1)times(cfrac{N-F}{s}+1) }, quadcfrac{N-F}{text{stride}}in Z $$</p>
<blockquote>
<div><p>![](./pics/CNN_12.png){width=40%}</p>
</div></blockquote>
</li>
</ol>
<p><strong>drawbacksï¼š</strong></p>
<ul class="simple">
<li><p>lose data over borders å®¹æ˜“ä¸¢å¤±è¾¹ç¼˜æˆ–è€…æ˜¯è§’è½ä¸Šçš„åƒç´ ä¿¡æ¯ï¼Œè­¬å¦‚æ‰€å½“ stride=1 çš„æ—¶å€™ï¼Œè¾¹è¾¹å°±å‡ºç°ä¸€éï¼Œä¸­é—´çš„éƒ¨åˆ†ä¼šåœ¨æ»‘åŠ¨çš„æ—¶å€™overlap åˆ°ï¼Œå‡ºç°æ¬¡æ•°å°±ä¼šé‡å¤ï¼Œè¿™ä¹Ÿä½“ç°äº†ä¸€ç§è®¾å®šï¼šå›¾åƒä¸­é—´æ€»æ˜¯æ¯”è¾ƒé‡è¦ï¼Œæ‰¿è½½æ›´å¤šä¿¡æ¯</p></li>
</ul>
<p><strong>advantagesï¼š</strong></p>
<ol class="arabic simple">
<li><p>è¾“å‡ºçš„å›¾ç‰‡ä¼šç¼©å°</p></li>
</ol>
</section>
<section id="about-padding">
<h4 id="about-padding">about Padding<a class="headerlink" href="#about-padding" title="Link to this heading">Â¶</a></h4>
<ul class="simple">
<li><p>ä¸ºä»€ä¹ˆè¦padï¼Ÿ</p></li>
</ul>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 204)</p>
<p>Bullet list ends without a blank line; unexpected unindent.</p>
</aside>
<p>ä¸ºäº†è§£å†³å®¹æ˜“ä¸¢å¤±è¾¹ç¼˜æˆ–è€…æ˜¯è§’è½ä¸Šçš„åƒç´ ä¿¡æ¯ã€‚padä¹‹åæœ¬æ¥è¾¹ç¼˜çš„éƒ¨åˆ†å°±ä¸ä¼šåªå‡ºç°ä¸€æ¬¡ã€‚ $impliedby$&lt;u&gt;convolved ä¹‹å‰ pad&lt;/u&gt;. Due to padding, information on the borders of images is also preserved similarly to at the centre of images.
- åœ¨å“ªé‡Œpadï¼Ÿ pad çš„èŒƒå›´å¤šå¤§</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 206)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><ul class="simple">
<li><p>To è§£å†³è¾¹ç¼˜å®¹æ˜“ä¸¢å¤± $implies$ &lt;u&gt;on the boundary&lt;/u&gt;, image çš„å››å‘¨éƒ½è¦ pad. èŒƒå›´è‡ªå®šä¹‰, <strong>pad with p-pixel border</strong></p></li>
<li><p>To <strong>å·ç§¯å‰åå¤§å°ä¸å˜</strong>ï¼Œ==$p=cfrac{F-1}{2}:text{when s=1}$==</p></li>
</ul>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 208)</p>
<p>Bullet list ends without a blank line; unexpected unindent.</p>
</aside>
<p>$p=cfrac{N(s-1)+F-s}{2}$</p>
</div></blockquote>
<p><strong>ä¿è¯å·ç§¯å‰åçš„ç»´åº¦ä¸å˜ï¼Œ</strong></p>
<ul>
<li><p>proof of  formula of p <strong>æ­¤å¤„stride=1ï¼ˆdefaultï¼‰</strong></p>
<blockquote>
<div><p>$N= N+2p-F+1implies p=cfrac{F-1}{2}$</p>
</div></blockquote>
</li>
<li><p>pad ä»€ä¹ˆï¼Ÿ</p></li>
</ul>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 216)</p>
<p>Bullet list ends without a blank line; unexpected unindent.</p>
</aside>
<p>&lt;u&gt;pad 0&lt;/u&gt; on the boundaryï¼Œå› ä¸ºåšçš„æ˜¯ dot productï¼Œä¸ä¼šå½±å“ç»“æœ</p>
<p>$$begin{align*}
text{Output Size without padding}&amp;=(cfrac{N-F}{s}+1)times(cfrac{N-F}{s}+1)\
text{Output Size with padding}&amp;=(cfrac{N+2p-F}{s}+1)times(cfrac{N+2p-F}{s}+1)
end{align*}$$</p>
<p>![](./pics/CNN_16.png){width=60%}</p>
</section>
<section id="about-meaning">
<h4 id="about-meaning">about Meaning<a class="headerlink" href="#about-meaning" title="Link to this heading">Â¶</a></h4>
<ol class="arabic simple">
<li><p>åŒä¸€å¼ ç‰¹å¾å›¾ï¼ŒåŒä¸€ä¸ªé€šé“ï¼Œä¸Šçš„æ‰€æœ‰å…ƒç´  (ç¥ç»å…ƒ) éƒ½æ˜¯å¯¹å›¾åƒçš„ä¸åŒä½ç½®çš„åŒä¸€ä¸ªç‰¹å¾çš„æ£€æµ‹ï¼Œé€šé“ä¸­æŸä¸€å¤„ (ç‰¹å¾å›¾ä¸ŠæŸä¸€ä¸ªç¥ç»å…ƒ) æ•°å€¼çš„å¤§å°å°±æ˜¯å½“å‰ä½ç½®å¯¹å½“å‰ç‰¹å¾å¼ºå¼±çš„ååº”ã€‚</p></li>
</ol>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 229)</p>
<p>Enumerated list ends without a blank line; unexpected unindent.</p>
</aside>
<p>2. ä¸€ä¸ª filter å°±æ˜¯ä¸€ä¸ªç‰¹å¾ï¼Œæ¯ä¸ª filter ä½“ç°çš„ç‰¹è´¨éƒ½ä¸ä¸€æ ·ã€‚
ä¸ºäº†ä½¿å¾—æ¨¡å‹å°†æ³¨æ„åŠ›é›†ä¸­äºå›¾ç‰‡çš„æŸäº›ä½ç½®ï¼Œ<strong>è€Œåœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæ›´å¥½çš„æ–¹æ³•æ˜¯å°†è¿‡æ»¤å™¨é‡Œé¢çš„å€¼è®¾ç½®æˆå‚æ•°ï¼Œè®©æ¨¡å‹é€šè¿‡åå‘ä¼ æ’­å»å­¦ä¹ åˆ°è¿‡æ»¤å™¨ä¸­çš„æƒé‡å€¼</strong>ï¼Œä»£æ›¿äººä¸ºçš„è®¾å®šã€‚</p>
<p>&lt;div class=â€gridâ€ markdown&gt;
&lt;figure markdown=â€spanâ€&gt;![](./pics/CNN_14.png)&lt;p&gt;yellow&lt;/p&gt;&lt;/figure&gt;
&lt;figure markdown=â€spanâ€&gt;![](./pics/CNN_15.png)&lt;p&gt;roll&lt;/p&gt;&lt;/figure&gt;
&lt;/div&gt;</p>
<ol class="arabic simple">
<li><p>&lt;u&gt;ç«‹ä½“çš„ filter&lt;/u&gt;ï¼Œæ¯ä¸€ä¸ªé€šé“çš„æƒé‡åˆ†åˆ«å¯¹åº”è¾“å…¥å›¾ç‰‡çš„æ¯ä¸€ä¸ªé€šé“ã€‚<strong>å¯ä»¥é€šè¿‡è®¾ç½®è¿‡æ»¤å™¨ä¸åŒé€šé“çš„æƒå€¼æ¥å…³æ³¨äºåŸå§‹å›¾ç‰‡ä¸åŒé€šé“çš„å†…å®¹</strong></p></li>
</ol>
</section>
</section>
<section id="batch-normalization">
<h3 id="batch-normalization">Batch Normalization<a class="headerlink" href="#batch-normalization" title="Link to this heading">Â¶</a></h3>
<p>Batch normalization is generally done in between convolution and activation(ReLU) layers. It normalizes the inputs at each layer, reduces internal co-variate shift(change in the distribution of network activations) and is a method to regularize a convolutional network.</p>
<p>Batch normalizing allows higher learning rates that can reduce training time and gives better performance. It allows learning at each layer by itself without being more dependent on other layers. Dropout which is also a regularizing technique, is less effective to regularize convolution layers.</p>
</section>
<section id="activation-function">
<h3 id="activation-function">Activation function<a class="headerlink" href="#activation-function" title="Link to this heading">Â¶</a></h3>
<p>å·ç§¯æ“ä½œåªæ˜¯åŠ æƒæ±‚å’Œçš„çº¿æ€§æ“ä½œï¼Œè‹¥ç¥ç»ç½‘ç»œåªç”¨å·ç§¯å±‚ï¼Œé‚£ä¹ˆæ— è®ºæœ‰å¤šå°‘å±‚ï¼Œè¾“å‡ºéƒ½æ˜¯è¾“å…¥çš„çº¿æ€§ç»„åˆï¼Œç½‘ç»œçš„è¡¨è¾¾èƒ½åŠ›æœ‰é™ï¼Œæ— æ³•å­¦ä¹ åˆ°éçº¿æ€§å‡½æ•°ã€‚å› æ­¤ CNN å¼•å…¥æ¿€åŠ±å‡½æ•°ï¼Œæ¿€æ´»å‡½æ•°æ˜¯ä¸ªéçº¿æ€§å‡½æ•°ï¼Œå¸¸ä½œç”¨äºå·ç§¯å±‚å’Œå…¨è¿æ¥å±‚è¾“å‡ºçš„æ¯ä¸ªç¥ç»å…ƒï¼ˆåˆ†é‡/å…ƒç´ ï¼‰ï¼Œç»™ç¥ç»å…ƒå¼•å…¥äº†éçº¿æ€§å› ç´ ï¼Œä½¿ç½‘ç»œçš„è¡¨è¾¾èƒ½åŠ›æ›´å¼ºï¼Œå‡ ä¹å¯é€¼è¿‘ä»»æ„å‡½æ•°ï¼Œè¿™æ ·ç¥ç»ç½‘ç»œå°±å¯åº”ç”¨åˆ°ä¼—å¤šçš„éçº¿æ€§æ¨¡å‹ä¸­ã€‚</p>
</section>
<section id="pooling-layer">
<h3 id="pooling-layer">Pooling Layer, æ± åŒ–å±‚<a class="headerlink" href="#pooling-layer" title="Link to this heading">Â¶</a></h3>
<p>a <span class="defi">down-sampling</span> strategy
1. Construct better translationally invariant features. å±€éƒ¨å¹³ç§»ä¸å˜æ€§ï¼Œå½“è¾“å…¥æœ‰ä¸€å®šçš„å¹³ç§»æ—¶ï¼Œç»æ± åŒ–åè¾“å‡ºä¸ä¼šå‘ç”Ÿæ”¹å˜ã€‚ä½¿å¾—å…¶ç‰¹å¾æå–ä¸ä¼šå› ä¸ºç›®æ ‡ä½ç½®çš„å˜åŒ–è€Œå—åˆ°è¾ƒå¤§çš„å½±å“
2. Learn more compact features. å°†æŸä¸ªå…ƒç´ é‚»åŸŸçš„**æ€»ä½“ç»Ÿè®¡**ç‰¹å¾ä½œä¸ºç½‘ç»œåœ¨è¯¥ä½ç½®çš„è¾“å‡º we are taking <strong>a summarized value</strong> over all the values present !!! controls overfitting
3. ç¼©å‡æ¨¡å‹çš„å¤§å°ï¼Œç®€åŒ–å·ç§¯å±‚çš„è¾“å‡º
4. æé«˜è®¡ç®—é€Ÿåº¦ä»¥åŠæé«˜æ¨¡å‹çš„é²æ£’æ€§ç­‰ã€‚
5. <strong>æ²¡æœ‰éœ€è¦å­¦ä¹ çš„å‚æ•°ï¼Œåªéœ€è¦å®šä¹‰è¿‡æ»¤å™¨çš„å¤§å°ä»¥åŠæ­¥é•¿å³å¯</strong></p>
<dl class="simple">
<dt>!!! p â€œThe Dimension After Poolingâ€</dt><dd><p>Given aÂ $Mtimes Ntimes D$Â tensor, if we apply the pooling operator with sizeÂ $Ktimes K$Â and StrideÂ $p$ , what are the dimensions of the output?
- depth has no change
- åœ¨widthå’Œheighté‚£é‡Œå°±åƒå·ç§¯ä¸€æ · $text{without padding}=(frac{N-F}{s}+1)times(frac{N-F}{s}+1)$
- $implies (cfrac{M-K}{p}+1)times (cfrac{N-K}{p}+1)times D$</p>
</dd>
</dl>
<p><a href="#id25"><span class="problematic" id="id26">|Pooling stategies||</span></a>
<a href="#id27"><span class="problematic" id="id28">|--|</span></a>â€“|
<a href="#id11"><span class="problematic" id="id12">|</span></a><a href="#id13"><span class="problematic" id="id14">**</span></a>Max Pooling**|ï¼ˆè¾ƒå¸¸ç”¨ï¼‰is robust to small perturbations.ç›´è§‚ç†è§£æ˜¯èƒ½å¤Ÿæå–å‡ºè¾“å…¥å›¾ç‰‡ä¸­æ¯”è¾ƒæ˜¾è‘—çš„ç‰¹å¾
<a href="#id15"><span class="problematic" id="id16">**</span></a>Average Pooling**|idk</p>
<aside class="system-message" id="id11">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 267); <em><a href="#id12">backlink</a></em></p>
<p>Inline substitution_reference start-string without end-string.</p>
</aside>
<aside class="system-message" id="id13">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 267); <em><a href="#id14">backlink</a></em></p>
<p>Inline strong start-string without end-string.</p>
</aside>
<aside class="system-message" id="id15">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 267); <em><a href="#id16">backlink</a></em></p>
<p>Inline strong start-string without end-string.</p>
</aside>
<p>&lt;figure markdown=â€spanâ€&gt;![](./pics/CNN_17.png){width=60%}&lt;p&gt;yellow&lt;/p&gt;&lt;/figure&gt;</p>
</section>
<section id="flatten-layer-tensor-reshape">
<h3 id="flatten-layer-tensor-reshape">Flatten Layer â€” Tensor Reshape<a class="headerlink" href="#flatten-layer-tensor-reshape" title="Link to this heading">Â¶</a></h3>
<p>&lt;div class=â€gridâ€ markdown&gt;
&lt;figure markdown=â€spanâ€&gt;![](./pics/CNN_18.png){width=60%}&lt;/figure&gt;
&lt;p&gt;the output feature map(matrix) will be converted into vector&lt;br&gt; å°†å‰é¢å·ç§¯å±‚æˆ–æ± åŒ–å±‚è¾“å‡ºçš„æ‰€æœ‰äºŒç»´ç‰¹å¾å›¾ä¸€èµ·æ˜ å°„æˆ1ä¸ªä¸€ç»´çš„ç‰¹å¾å‘é‡&lt;/p&gt;
&lt;/div&gt;</p>
</section>
<section id="fully-connected-layer-fc">
<h3 id="fully-connected-layer-fc">Fully- Connected Layer, FC<a class="headerlink" href="#fully-connected-layer-fc" title="Link to this heading">Â¶</a></h3>
<p>å…‰å·ç§¯æ˜¯ä¸èƒ½å®Œæˆåˆ†ç±»ä»»åŠ¡çš„ï¼Œæ‰€ä»¥å°±æ˜¯è¦åé¢è¿Â FCå±‚ï¼Œèµ·åˆ°â€œåˆ†ç±»å™¨â€çš„ä½œç”¨
<strong>ä¸­é—´å¯èƒ½æœ‰å¤šä¸ªFCå±‚ï¼Œ**æœ€åæ¨¡å‹è¾“å‡ºä¸€ä¸ª**ç»´åº¦ç­‰äºç±»åˆ«æ•°ï¼ˆè¾“å‡ºçš„ç¥ç»å…ƒä¸ªæ•°ï¼‰**çš„**å‘é‡</strong></p>
<p>&lt;div class=â€gridâ€ markdown&gt;
&lt;figure markdown=â€spanâ€&gt;![](./pics/CNN_19.png){width=60%}&lt;/figure&gt;
&lt;figure markdown=â€spanâ€&gt;![](./pics/CNN_20.png){width=60%}&lt;/figure&gt;
&lt;/div&gt;</p>
</section>
<section id="softmax">
<h3 id="softmax">softmax<a class="headerlink" href="#softmax" title="Link to this heading">Â¶</a></h3>
<p>softmaxå½’ä¸€åŒ–ï¼Œè¡¨ç¤ºæ¯ä¸€ç±»çš„æ¦‚ç‡ï¼Œç„¶å**å°†å¾—åˆ†æœ€é«˜çš„ç±»åˆ«åˆ¤ä¸ºè¾“å…¥çš„ç±»åˆ«**
The softmax function is used to map the non-normalized output of a network to a probability distribution.
è½¯æœ€å¤§å‡½æ•°ç”¨äºå°†ç½‘ç»œçš„éè§„èŒƒåŒ–è¾“å‡ºæ˜ å°„åˆ°æ¦‚ç‡åˆ†å¸ƒã€‚</p>
</section>
</section>
<section id="famous-cnn-architectures">
<h2 id="famous-cnn-architectures">Famous CNN Architectures<a class="headerlink" href="#famous-cnn-architectures" title="Link to this heading">Â¶</a></h2>
<section id="deeper-or-wider">
<h3 id="deeper-or-wider">Deeper or Wider?<a class="headerlink" href="#deeper-or-wider" title="Link to this heading">Â¶</a></h3>
<p><strong>Deep CNN</strong>ï¼šDeeply stacked  Convolution Neural Network</p>
<div class="line-block">
<div class="line-block">
<div class="line">| LeNet-5 | AlexNet | VGG Net | ResNet <a href="#id17"><span class="problematic" id="id18">|</span></a>GoogLeNet</div>
</div>
<div class="line">â€” | â€” | â€” | â€” | â€” | â€” |</div>
<div class="line">Key | ç‰¹å¾ç¨€ç–é“¾æ¥ | Relu activation  | smaller filters | ^ |</div>
<div class="line">Activation | Sigmoid | ReLU |  ^|^  |</div>
<div class="line">Advantages | basic architecture</div>
</div>
<aside class="system-message" id="id17">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 308); <em><a href="#id18">backlink</a></em></p>
<p>Inline substitution_reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 309)</p>
<p>Line block ends without a blank line.</p>
</aside>
<p>å¥ å®šåŸºç¡€ | GPU | ^ <a href="#id19"><span class="problematic" id="id20">|</span></a>^  |
| Drawbacks | ç®—åŠ›ä¸å¤Ÿ <a href="#id21"><span class="problematic" id="id22">|</span></a>^  |  |  |
| è®¾è®¡ç”¨é€” | æ‰‹å†™æ•°å­—è¯†åˆ« | ImageNet classification with deep convolutional neural networks â€“ NIPS 2012 | Very Deep Convolutional Networks for Large-Scale Image Recognition â€“ ICLR 2015 |  Deep Residual Learning for Image Recognition â€“ CVPR 2016|Going deeper with convolutions â€“ CVPR 2015
| deep CNN |  |  â˜‘ï¸|â˜‘ï¸  <a href="#id23"><span class="problematic" id="id24">|</span></a>â˜‘ï¸  |</p>
<aside class="system-message" id="id19">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 313); <em><a href="#id20">backlink</a></em></p>
<p>Inline substitution_reference start-string without end-string.</p>
</aside>
<aside class="system-message" id="id21">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 313); <em><a href="#id22">backlink</a></em></p>
<p>Inline substitution_reference start-string without end-string.</p>
</aside>
<aside class="system-message" id="id23">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">C:\Users\zxouyang\CodeProjects\PRIVATE_P\io\docs\source\AI/DL/cnn.rst</span>, line 313); <em><a href="#id24">backlink</a></em></p>
<p>Inline substitution_reference start-string without end-string.</p>
</aside>
<p>!!! p â€œThe Skip-connection was first proposed in ResNetâ€</p>
</section>
<section id="lenet-5">
<h3 id="lenet-5"><strong>LeNet-5</strong><a class="headerlink" href="#lenet-5" title="Link to this heading">Â¶</a></h3>
<p><strong>7 Layers</strong>Â (input layer not counted)</p>
<p><strong>3 Convolution Layers</strong>Â (C1; C3; C5)</p>
<p><strong>2 Pooling Layers</strong>Â (S2; S4) â€” Mean</p>
<p><strong>2 Fully Connected Layers</strong>Â (F6; Output)</p>
<p><strong>Sigmoid Activation!</strong></p>
<p>Detailsï¼š</p>
<ol class="arabic simple">
<li><p>subsampling ä¸­ä¼šåœ¨ç»“æœä¸Šå¤šåŠ ä¸€ä¸ªåç½®é¡¹</p></li>
<li><p>S2-C3 sparse connected ç”Ÿæˆçš„16@feature mapåˆ†åˆ«æŒ‰ç›¸é‚»3ä¸ªï¼Œç›¸é‚»4ä¸ªï¼Œéç›¸é‚»4ä¸ªå’Œå…¨éƒ¨6ä¸ªç‰¹å¾å›¾è¿›è¡Œfeature mappingã€å› ä¸ºç®—åŠ›ä¸è¶³ï¼Œé™åˆ¶äº†è¿æ¥æ•°ï¼Œå‡å°‘è®¡ç®—å¼€é”€ï¼›è¿™æ ·ä¸åŒç‰¹å¾å›¾çš„ç»„åˆå¯ä»¥ä½¿æ–°ç”Ÿæˆçš„feature map å­¦åˆ°ä¸åŒçš„ç‰¹å¾æ¨¡å¼ ã€‘</p></li>
<li><p>MLPä½œä¸ºåˆ†ç±»å™¨</p></li>
<li><p>è¿™é‡Œçš„ faltten æ˜¯ç”¨CNN</p></li>
</ol>
</section>
<section id="alexnet">
<h3 id="alexnet">AlexNet<a class="headerlink" href="#alexnet" title="Link to this heading">Â¶</a></h3>
<p>ReLU, max pooling, stride
Data augmentation
Optimizer parameters</p>
</section>
<section id="vgg-net">
<h3 id="vgg-net">VGG Net<a class="headerlink" href="#vgg-net" title="Link to this heading">Â¶</a></h3>
<p><strong>152 layersÂ for ImageNet.</strong></p>
<p>ğŸ’¡ <strong>Key Idea of VGG</strong>: Replace the large convolution filter by stacking some <strong>smaller convolution filters.</strong></p>
<ol class="arabic simple">
<li><p><strong>More concise and generalizable.</strong></p></li>
<li><p><strong>Smaller filters can achieve better performance than larger filters. smaller filters å †ç§¯å¯ä»¥æ¯” largeræ›´é«˜</strong></p></li>
<li><p><strong>Demonstrate that increase depth can boost performance. æ·±åº¦å¯æé«˜è¡¨ç°</strong></p></li>
</ol>
<p>5x5 conv = two 3x3 conv
7x7 conv = three 3x3 conv</p>
</section>
<section id="residual-net-resnet">
<h3 id="residual-net-resnet">Residual Net, <strong>ResNet</strong><a class="headerlink" href="#residual-net-resnet" title="Link to this heading">Â¶</a></h3>
<p>keep origin information</p>
<p>Skip-connection
Batch-normalization
Bottleneck block</p>
</section>
<section id="dense-net">
<h3 id="dense-net"><strong>Dense Net</strong><a class="headerlink" href="#dense-net" title="Link to this heading">Â¶</a></h3>
</section>
<section id="googlenet">
<h3 id="googlenet"><strong>GoogleNet</strong><a class="headerlink" href="#googlenet" title="Link to this heading">Â¶</a></h3>
<p>There are some parallel polar level.
Okay? Blocks in in a certain layer that means You will send. You will
send I input. Okay, into different convolutions. Okay. And letâ€™s go
through different architectures. And then we merged guys okay, into a
final okay output. Okay, So this is a key idea. Okay, significant
difference. Okay, of Google, net with different, other, different neural
networks. Okay. But yeah you can try this. Okay. But we will not Talk
about the details of this neural networks, Okay</p>
</section>
<section id="light-weight-networks">
<h3 id="light-weight-networks">Light-weight networks<a class="headerlink" href="#light-weight-networks" title="Link to this heading">Â¶</a></h3>
<p>!!! p â€œPerformance on computation limitsâ€</p>
<p>![](./pics/CNN_23.png){width=60%}
![](./pics/CNN_24.png){width=60%}</p>
<dl class="simple">
<dt>!!! danger â€œa depthwise convolution involves applying a separate 3x3 filter to each input channel.â€</dt><dd><p>&gt; &gt; For a depthwise 3x3 convolution, the number of  input channels and output channels are both 32, how many parameters does this convolution layer have ï¼Ÿ
&gt;
&gt; $3*3*32$</p>
</dd>
</dl>
<p><strong>Group convolution:</strong></p>
</section>
</section>
<section id="practical-exercise">
<h2 id="practical-exercise">Practical Exercise<a class="headerlink" href="#practical-exercise" title="Link to this heading">Â¶</a></h2>
</section>
<section id="parameters-initialization">
<h2 id="parameters-initialization">Parameters Initialization<a class="headerlink" href="#parameters-initialization" title="Link to this heading">Â¶</a></h2>
<p>å¿«é€Ÿ shrikage to point</p>
</section>
<section id="bach-normalization">
<h2 id="bach-normalization">Bach Normalization<a class="headerlink" href="#bach-normalization" title="Link to this heading">Â¶</a></h2>
</section>
<section id="application">
<h2 id="application">Application<a class="headerlink" href="#application" title="Link to this heading">Â¶</a></h2>
</section>
<section id="edge-detection">
<h2 id="edge-detection">Edge Detection<a class="headerlink" href="#edge-detection" title="Link to this heading">Â¶</a></h2>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼šè¾“å…¥æ˜¯ä¸€ä¸ª6*6çš„çŸ©é˜µï¼Œè¾“å…¥æ˜¯ä¸€ä¸ªå·¦ç™½å³ç°çš„å›¾ç‰‡ï¼ˆç™½è‰²éƒ¨åˆ†å¯¹åº”çš„çŸ©é˜µå€¼å¤§äº0ï¼Œç°è‰²éƒ¨åˆ†çš„å€¼ä¸º0ï¼‰ï¼Œä¸­é—´æœ‰ä¸€é“ç«–çº¿åˆ†å‰²ï¼›ä¸­é—´çš„å‚ç›´è¿‡æ»¤å™¨æ˜¯ä¸€ä¸ª3*3çš„çŸ©é˜µï¼Œç”±ç™½ç°é»‘ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼ŒçŸ©é˜µä¸‰åˆ—çš„å€¼åˆ†åˆ«å¤§äº0ï¼Œç­‰äº0å’Œå°äº0ï¼›è¾“å‡ºçš„ç»“æœçŸ©é˜µä¸­ï¼Œä¸­é—´çš„ä¸¤åˆ—å¤§äº0ï¼Œå³è¾“å‡ºçš„å›¾ç‰‡ä¸­é—´éƒ¨åˆ†ä¸ºç™½è‰²ï¼Œä¹Ÿå°±æ˜¯è¯´ç»è¿‡å·ç§¯ä¹‹åï¼ŒæˆåŠŸçš„æ£€æµ‹å‡ºäº†åŸå§‹å›¾ç‰‡ä¸­é—´å­˜åœ¨çš„å‚ç›´ç«–çº¿ã€‚</p>
</section>
<section id="exercise">
<h2 id="exercise">Exercise<a class="headerlink" href="#exercise" title="Link to this heading">Â¶</a></h2>
<p>&gt; &gt;(in L5 in AMA564), input $inR^{5times5}$,kernel $inR^{3times3}$,bias=-500, activation function is ReLU</p>
</section>
<section id="code">
<h2 id="code">code<a class="headerlink" href="#code" title="Link to this heading">Â¶</a></h2>
<p>[å·ç§¯ç¥ç»ç½‘ç»œï¼ˆæµ…æ˜¾æ˜“æ‡‚ï¼‰-å´æ©è¾¾è¯¾ç¨‹å­¦ä¹ ]: <a class="reference external" href="https://zhuanlan.zhihu.com/p/35251749/">https://zhuanlan.zhihu.com/p/35251749/</a></p>
<p>[ç¥ç»ç½‘ç»œåŠCNNä¸­çš„é€šé“ã€å…±äº«æƒé‡ã€ç‰¹å¾æ˜ å°„ç­‰çš„ç†è§£_zhu_Lydiaçš„åšå®¢-CSDNåšå®¢_cnnçš„é€šé“]:<a class="reference external" href="https://blog.csdn.net/zhu_Lydia/article/details/88567648">https://blog.csdn.net/zhu_Lydia/article/details/88567648</a></p>
<p>[Convolutional Neural Network Architecture | CNN Architecture]:<a class="reference external" href="https://www.analyticsvidhya.com/blog/2020/10/what-is-the-convolutional-neural-network-architecture/">https://www.analyticsvidhya.com/blog/2020/10/what-is-the-convolutional-neural-network-architecture/</a></p>
<p>[Convolutional Neural Network | Deep Learning | Developers Breach]: <a class="reference external" href="https://developersbreach.com/convolution-neural-network-deep-learning/">https://developersbreach.com/convolution-neural-network-deep-learning/</a></p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2024, coconut.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>