<!DOCTYPE html>

<html lang="zh-CN" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>pytorch &#8212; HomePage</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=83e35b93" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@0.16.10/dist/katex.min.css" />
    <link rel="stylesheet" type="text/css" href="../_static/katex-math.css?v=91adb8b6" />
    <link rel="stylesheet" type="text/css" href="../_static/css/def.css?v=5a9d86bd" />
    <script src="../_static/documentation_options.js?v=7d86a446"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=6dbb43f8"></script>
    <script src="../_static/translations.js?v=beaddf03"></script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <link rel="index" title="索引" href="../genindex.html" />
    <link rel="search" title="搜索" href="../search.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue-grey data-md-color-accent=blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#python/pytorch" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="HomePage"
           class="md-header-nav__button md-logo">
          
            <i class="md-icon">&#xe869</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Cocobook</span>
          <span class="md-header-nav__topic"> pytorch </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="get" name="search">
      <input type="text" class="md-search__input" name="q" placeholder=""Search""
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">HomePage</a></li>
            
            <li class="md-tabs__item"><a href="../AI/index.html" class="md-tabs__link">AI</a></li>
            
            <li class="md-tabs__item"><a href="index.html" class="md-tabs__link">Python</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="HomePage" class="md-nav__button md-logo">
      
        <i class="md-icon">&#xe869</i>
      
    </a>
    <a href="../index.html"
       title="HomePage">Cocobook</a>
  </label>
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">AI</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../AI/main.html" class="md-nav__link">Artificial Intelligence, AI</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">"Contents"</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#python-pytorch--page-root" class="md-nav__link">pytorch</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#configuration" class="md-nav__link">Configuration</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id1" class="md-nav__link">pytorch 安装</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#concept" class="md-nav__link">concept</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#autograd" class="md-nav__link">Autograd</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#locally-disable-gradient-computation" class="md-nav__link">locally disable gradient computation</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id8" class="md-nav__link">完整的</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#cpu-gpu" class="md-nav__link">cpu & gpu</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#gpu" class="md-nav__link">多gpu</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#id17" class="md-nav__link">训练和测试的不同</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#data" class="md-nav__link">Data</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#tensor" class="md-nav__link">Tensor</a>
        </li>
        <li class="md-nav__item"><a href="#class-dataset" class="md-nav__link">class DataSet</a>
        </li>
        <li class="md-nav__item"><a href="#datalodar" class="md-nav__link">Datalodar</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#nn" class="md-nav__link">nn</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id50" class="md-nav__link">一些基本的东西</a>
        </li>
        <li class="md-nav__item"><a href="#containers-nn" class="md-nav__link"><cite>Containers</cite>  负责 nn 框架的构建</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#module-nn-base-class" class="md-nav__link"><cite>Module</cite> 所有 NN 的 base class</a>
        </li>
        <li class="md-nav__item"><a href="#sequential-transforms-compose" class="md-nav__link"><cite>Sequential</cite> 类`transforms.Compose`的用法，模型进一步封装</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#nn-xxx-nn-functional-xxx" class="md-nav__link">nn.xxx & nn.functional.xxx</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#liner" class="md-nav__link">Liner</a>
        </li>
        <li class="md-nav__item"><a href="#conv" class="md-nav__link">Conv</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#id101" class="md-nav__link">)</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#pool" class="md-nav__link">Pool</a>
        </li>
        <li class="md-nav__item"><a href="#activation" class="md-nav__link">activation</a>
        </li>
        <li class="md-nav__item"><a href="#normalization" class="md-nav__link">Normalization</a>
        </li>
        <li class="md-nav__item"><a href="#droupout" class="md-nav__link">Droupout</a>
        </li>
        <li class="md-nav__item"><a href="#flatten" class="md-nav__link"><cite>flatten</cite></a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#torch-nn-loss-torch-optim" class="md-nav__link"><cite>torch.nn.`Loss &amp; `torch.Optim</cite></a>
        </li>
        <li class="md-nav__item"><a href="#save-load" class="md-nav__link">Save & Load</a>
        </li>
        <li class="md-nav__item"><a href="#representation" class="md-nav__link">representation</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#utils-tensorboard" class="md-nav__link"><cite>utils.tensorboard</cite></a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#cv" class="md-nav__link">CV</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#transforms" class="md-nav__link">transforms</a>
        </li>
        <li class="md-nav__item"><a href="#models" class="md-nav__link">models</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#vgg16" class="md-nav__link">vgg16</a>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="pytorch">
<h1 id="python-pytorch--page-root">pytorch<a class="headerlink" href="#python-pytorch--page-root" title="Link to this heading">¶</a></h1>
<section id="configuration">
<h2 id="configuration">Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h2>
<section id="id1">
<h3 id="id1">pytorch 安装<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>是否有显卡驱动</p></li>
</ol>
<p><cite>任务管理器</cite> 看 GPU 一般是 NVIDIA 的。</p>
<ol class="arabic">
<li><p>[pytorch downlaod]
- [pytorch V.S.cuda] 查显卡决定pytorch</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 17)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>&lt;kbd&gt;nvidia-smi&lt;/kbd&gt;  cmds查看显卡情况</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 18)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<ul class="simple">
<li><p>[pytorch V.S.python] 查pytorch 决定python虚拟环境</p></li>
</ul>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 19)</p>
<p>Bullet list ends without a blank line; unexpected unindent.</p>
</aside>
<blockquote>
<div><p>&lt;kbd&gt;conda create -n env_name python=? &lt;/kbd&gt;</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 20)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<ul class="simple">
<li><p>查架构</p></li>
</ul>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">python</span> <span class="pre">title="查看架构"</span>
<span class="pre">import</span> <span class="pre">platfrorm</span>
<span class="pre">print(platform.uname()[4])</span>
<span class="pre">#&gt;&gt;&gt;</span> <span class="pre">arm64</span>
<span class="pre">`</span></code></p>
</div></blockquote>
</li>
</ol>
<p>![](./pics/torch_download_1.png){width=80%}
![](./pics/torch_download_2.png){width=80%}</p>
<ol class="arabic">
<li><p>check</p>
<blockquote>
<div><p><a href="#id2"><span class="problematic" id="id3">``</span></a>` python title=”检查安装成功”
import torch</p>
<aside class="system-message" id="id2">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 33); <em><a href="#id3">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<p>print(torch.__version__)
print(torchvision.__version__)</p>
<p>print(torch.cuda.is_available()) # windows
print(torch.backends.mps.is_available()) # mac
# &gt;&gt;&gt; True : ok
<a href="#id4"><span class="problematic" id="id5">``</span></a><a href="#id6"><span class="problematic" id="id7">`</span></a></p>
<aside class="system-message" id="id4">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 39); <em><a href="#id5">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id6">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 39); <em><a href="#id7">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</div></blockquote>
</li>
</ol>
<dl class="simple">
<dt>!!! danger “<cite>torch.cuda.is_avaliable()</cite> -&gt; False”</dt><dd><ol class="arabic simple">
<li><p>检查 platform 是哪个</p></li>
<li><p>检查 gpu 是否支持cuda</p></li>
<li><p>检查显卡驱动版本</p></li>
<li><p>检查更新是否成功</p></li>
</ol>
</dd>
</dl>
</section>
</section>
</section>
<section id="concept">
<h1 id="concept">concept<a class="headerlink" href="#concept" title="Link to this heading">¶</a></h1>
<section id="autograd">
<h2 id="autograd">Autograd<a class="headerlink" href="#autograd" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>!!! p “”</dt><dd><p>Conceptually, autograd <span class="defi">records a graph</span> recording all of the operations that created the data as you execute operations, giving you ==a directed acyclic graph whose leaves are the input tensors and roots are the output tensors==. By tracing this graph from roots to leaves, you can automatically compute the gradients using the chain rule.</p>
</dd>
</dl>
<section id="locally-disable-gradient-computation">
<h3 id="locally-disable-gradient-computation">locally disable gradient computation<a class="headerlink" href="#locally-disable-gradient-computation" title="Link to this heading">¶</a></h3>
</section>
</section>
<section id="id8">
<h2 id="id8">完整的<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>!!! p “初步检查模型是否有写错”</dt><dd><p><code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">python</span>
<span class="pre">model</span> <span class="pre">=</span> <span class="pre">MyModel()</span>
<span class="pre">input</span> <span class="pre">=</span> <span class="pre">torch.ones(batch,</span> <span class="pre">input_size)</span>
<span class="pre">output</span> <span class="pre">=</span> <span class="pre">model(input)</span>
<span class="pre">print(output.shape())</span>
<span class="pre">`</span></code></p>
</dd>
</dl>
<section id="cpu-gpu">
<h3 id="cpu-gpu">cpu &amp; gpu<a class="headerlink" href="#cpu-gpu" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>!!! danger “要放进gpu的是”</dt><dd><ol class="arabic simple">
<li><p>model</p></li>
<li><p>损失函数</p></li>
<li><p>数据（X，label）</p></li>
</ol>
</dd>
</dl>
<p><span class="defi">使用方法</span></p>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>python hl_lines=”2 15 17”
“””</p>
<aside class="system-message" id="id9">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 83); <em><a href="#id10">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id11">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 83); <em><a href="#id12">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 85)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">meth1<span class="colon">:</span></dt>
<dd class="field-odd"><p>.cuda()</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 86)</p>
<p>Field list ends without a blank line; unexpected unindent.</p>
</aside>
<p>但要注意 gpu 是否可用</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 87)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””
if torch.cuda.is_available():</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 89)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>model = model.cuda()
loss_fn = loss_fn.cuda()</p>
</div></blockquote>
<dl>
<dt>for data in dataloader:</dt><dd><p>imgs, targets = data
if torch.cuda.is_available():</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 95)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>imgs, targets = imgs.cuda(), targets.cuda()</p>
</div></blockquote>
</dd>
</dl>
<dl class="simple">
<dt>“””</dt><dd><dl class="field-list simple">
<dt class="field-odd">meth2<span class="colon">:</span></dt>
<dd class="field-odd"><p>.to(device)</p>
</dd>
</dl>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 99)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””
device = torch.device(‘cuda’ if torch.cuda.is_available() else ‘cpu’)</p>
<p>model.to(device)
loss_fn.to(device)</p>
<dl class="simple">
<dt>for data in dataloader:</dt><dd><p>imgs, targets = data
imgs, targets = imgs.to(device), target.to(device)</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 108)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
<aside class="system-message" id="id13">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 108); <em><a href="#id14">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id15">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 108); <em><a href="#id16">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<section id="gpu">
<h4 id="gpu">多gpu<a class="headerlink" href="#gpu" title="Link to this heading">¶</a></h4>
<ol class="arabic">
<li><p>选择一个运行</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">device</span> <span class="pre">=</span> <span class="pre">torch.device('cuda')</span> <span class="pre">#</span> <span class="pre">default</span> <span class="pre">=</span> <span class="pre">第一块</span>
<span class="pre">device</span> <span class="pre">=</span> <span class="pre">torch.device('cuda:0')</span> <span class="pre">#</span> <span class="pre">第一块</span>
<span class="pre">device</span> <span class="pre">=</span> <span class="pre">torch.device('cuda:1')</span> <span class="pre">#</span> <span class="pre">第二块</span>
<span class="pre">`</span></code></p>
</div></blockquote>
</li>
<li><p>多gpu运行</p></li>
</ol>
</section>
</section>
<section id="id17">
<h3 id="id17">训练和测试的不同<a class="headerlink" href="#id17" title="Link to this heading">¶</a></h3>
<dl>
<dt>!!! p “当不涉及训练时： <cite>with torch.no_grad():</cite>”</dt><dd><p>反向传播的时候需要 tensor 的 <cite>requires_grad=True</cite> 才能自动求导，从而优化参数。这其中涉及 ==求导图==即内存的消耗
但是训练的时候不需要求导，在`with torch.no_grad():<a href="#id18"><span class="problematic" id="id19">`</span></a>下，所有计算得出的tensor的requires_grad都自动设置为False。
[【pytorch系列】 with torch.no_grad():用法详解]</p>
<aside class="system-message" id="id18">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 127); <em><a href="#id19">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</dd>
<dt>!!! p “<cite>model.train()</cite> &amp; <cite>model.eval()</cite>”</dt><dd><p>class:<cite>Dropout</cite>, <code class="xref py py-class docutils literal notranslate"><span class="pre">BatchNorm</span></code>,
etc.
- <cite>model.train()</cite> 写在模型训练前
- <cite>model.eval()`==`module.train(False)</cite> 写在模型测试前
<a href="#id20"><span class="problematic" id="id21">``</span></a><a href="#id22"><span class="problematic" id="id23">`</span></a>python hl_lines=”2 6”
for i in range(epoch):</p>
<aside class="system-message" id="id20">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 132); <em><a href="#id21">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id22">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 132); <em><a href="#id23">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 138)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>model.train()
for data in traning_loader:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 140)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>…</p>
</div></blockquote>
<p>model.eval()
for data in testing_loader:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 144)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>…</p>
</div></blockquote>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 145)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id24"><span class="problematic" id="id25">``</span></a><a href="#id26"><span class="problematic" id="id27">`</span></a></p>
<aside class="system-message" id="id24">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 145); <em><a href="#id25">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id26">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 145); <em><a href="#id27">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</dd>
</dl>
<p><a href="#id28"><span class="problematic" id="id29">``</span></a><a href="#id30"><span class="problematic" id="id31">`</span></a>python hl_lines=”1 13”
def train(self: T, mode: bool = True) -&gt; T:</p>
<aside class="system-message" id="id28">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 147); <em><a href="#id29">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id30">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 147); <em><a href="#id31">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 149)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><blockquote>
<div><p>“””
把模型调到 training mode.</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>mode: Bool</dt><dd><p>default = True = 训练模式
- False = 测评模式</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 156)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<dl class="simple">
<dt>“””</dt><dd><p>…</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 158)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>return self</p>
</div></blockquote>
<dl class="simple">
<dt>def eval(self: T) -&gt; T:</dt><dd><p>“””
把模型调到 evaluation mode
“””
return self.train(False)</p>
</dd>
</dl>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 165)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id32"><span class="problematic" id="id33">``</span></a><a href="#id34"><span class="problematic" id="id35">`</span></a></p>
<aside class="system-message" id="id32">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 165); <em><a href="#id33">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id34">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 165); <em><a href="#id35">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</section>
</section>
<section id="data">
<h2 id="data">Data<a class="headerlink" href="#data" title="Link to this heading">¶</a></h2>
<section id="tensor">
<h3 id="tensor">Tensor<a class="headerlink" href="#tensor" title="Link to this heading">¶</a></h3>
</section>
<section id="class-dataset">
<h3 id="class-dataset">class DataSet<a class="headerlink" href="#class-dataset" title="Link to this heading">¶</a></h3>
<dl>
<dt>!!! p “官方 <cite>torch.utils.data.DataSet</cite>”</dt><dd><p>一个虚拟的类，All datasets that represent a map from keys to data samples
- 所有的 dataset 都必须继承它</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 179)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><ol class="arabic simple">
<li><p>必须重写 <cite>__getitem__</cite></p></li>
<li><p>选择重写 <cite>__len__</cite></p></li>
<li><p>如果 key/indice 不是 int，对应的 DataLoader 也大改</p></li>
</ol>
</div></blockquote>
</dd>
</dl>
<p><a href="#id36"><span class="problematic" id="id37">``</span></a>` python
class Dataset(Generic[T_co]):</p>
<aside class="system-message" id="id36">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 183); <em><a href="#id37">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 185)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
设立数据集，包括 key/indice(default int)、data、label
要能通过 key/indice 来访问对应的 data 和 label
如果 key/indice 不是 int，对应的 DataLoader 也要大改
“””</p>
<dl class="simple">
<dt>def __getitem__(self, index) -&gt; T_co:</dt><dd><p>raise NotImplementedError</p>
</dd>
<dt>def __add__(self, other: ‘Dataset[T_co]’) -&gt; ‘ConcatDataset[T_co]’:</dt><dd><p>return ConcatDataset([self, other])</p>
</dd>
</dl>
<p># No <cite>def __len__(self)</cite> default?
# See NOTE [ Lack of Default <cite>__len__</cite> in Python Abstract Base Classes ]
# in pytorch/torch/utils/data/sampler.py</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 200)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id38"><span class="problematic" id="id39">``</span></a><a href="#id40"><span class="problematic" id="id41">`</span></a></p>
<aside class="system-message" id="id38">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 200); <em><a href="#id39">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id40">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 200); <em><a href="#id41">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</section>
<section id="datalodar">
<h3 id="datalodar">Datalodar<a class="headerlink" href="#datalodar" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>!!! p “<cite>torch.utils.data.DataLoader</cite>”</dt><dd><p>constructs a index sampler that yields integral indices</p>
</dd>
</dl>
<p>Epoch: 所有训练样本都以输入到模型中，称为一个Epoch
Iteration: 一批样本输入到模型中，为一个Iteration
Batchsize: 批大小，主要是决定一个Epoch有多少个Iteration</p>
<p>样本81， Batchsize=8;</p>
<p>1 Epoch = 10  drop_last=True
1 Epoch = 11  drop_last=False</p>
<p><a href="#id42"><span class="problematic" id="id43">``</span></a>` python hl_lines=”1”</p>
<aside class="system-message" id="id42">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 217); <em><a href="#id43">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<dl>
<dt>class DataLoader(Generic[T_co]):</dt><dd><p>“””
“抽样式”地少量 batch 加载数据，集 “数据集 dataset”， “抽样 sampler”，
“迭代器 iterator” 于一体。可以 单或者多进程 来加载</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>dataset: torch.DataSet</p></li>
<li><dl class="simple">
<dt>batch_size: Optional[int] = samples per batch</dt><dd><p>default = 1</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>shuffle: Optional[bool] = 在每个 epoch 开始的时候，对数据进行重新排序</dt><dd><p>default = False</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>sampler: Union[Sampler, Iterable, None] = 自定义从数据集中取样本的策略</dt><dd><p>default = None
根据 dataset 的性质来决定
和 shuffle 互斥</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>batch_sampler: Union[Sampler[Sequence], Iterable[Sequence], None]</dt><dd><p>=  与sampler类似，返回 batch 的 indice
default = None
和 batch_size, shuffle, sampler, drop_last 互斥</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>num_workers: int = 有多少个子进程</dt><dd><p>default = 0 只有 main process</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>drop_last: bool = 除不尽时候，要不要的最后一个 batch</dt><dd><p>default = False</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>generator: torch.Generator</dt><dd><p>default = None</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Warning:</dt><dd><ul class="simple">
<li><p>iterable-style datasets are incompatible with custom samplers first</p></li>
<li><p>设置了 batch_sampler，那么batch_size,shuffle,sampler,drop_last</p></li>
</ul>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 248)</p>
<p>Bullet list ends without a blank line; unexpected unindent.</p>
</aside>
<p>就不能再制定了</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 249)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 250)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
<dl>
<dt>def __init__(</dt><dd><p>self, dataset: Dataset[T_co], batch_size: Optional[int] = 1,
shuffle: Optional[bool] = None,
sampler: Union[Sampler, Iterable, None] = None,
batch_sampler: Union[Sampler[Sequence],Iterable[Sequence], None] = None,
num_workers: int = 0, collate_fn: Optional[_collate_fn_t] = None,
pin_memory: bool = False, drop_last: bool = False,
timeout: float = 0,
worker_init_fn: Optional[_worker_init_fn_t] = None,
multiprocessing_context=None, generator=None,
<a href="#id44"><span class="problematic" id="id45">*</span></a>, prefetch_factor: Optional[int] = None,
persistent_workers: bool = False,
pin_memory_device: str = “”):
…</p>
<aside class="system-message" id="id44">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 253); <em><a href="#id45">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</aside>
</dd>
<dt>def __len__(self) -&gt; int:</dt><dd><p>“””
Warning:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 270)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><ul class="simple">
<li><p><cite>IterableDataset</cite> 会 不正确 ！！！</p></li>
<li><p>Cannot statically verify that dataset is Sized</p></li>
<li><p>往上取整， 考虑 droplast</p></li>
</ul>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 273)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””
if self._dataset_kind == _DatasetKind.Iterable:</p>
<blockquote>
<div><p>length = self._IterableDataset_len_called = len(self.dataset)
# type: ignore[assignment, arg-type]
if self.batch_size is not None:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 279)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p># IterableDataset doesn’t allow custom sampler or batch_sampler
from math import ceil
if self.drop_last:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 282)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>length = length // self.batch_size</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 283)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<dl class="simple">
<dt>else:</dt><dd><p>length = ceil(length / self.batch_size)</p>
</dd>
</dl>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 285)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>return length</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 286)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<dl class="simple">
<dt>else:</dt><dd><p>return len(self._index_sampler)</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 288)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>…</p>
</dd>
</dl>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 289)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id46"><span class="problematic" id="id47">``</span></a><a href="#id48"><span class="problematic" id="id49">`</span></a></p>
<aside class="system-message" id="id46">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 289); <em><a href="#id47">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id48">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 289); <em><a href="#id49">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</section>
</section>
<section id="nn">
<h2 id="nn">nn<a class="headerlink" href="#nn" title="Link to this heading">¶</a></h2>
<section id="id50">
<h3 id="id50">一些基本的东西<a class="headerlink" href="#id50" title="Link to this heading">¶</a></h3>
</section>
<section id="containers-nn">
<h3 id="containers-nn"><cite>Containers</cite>  负责 nn 框架的构建<a class="headerlink" href="#containers-nn" title="Link to this heading">¶</a></h3>
<section id="module-nn-base-class">
<h4 id="module-nn-base-class"><cite>Module</cite> 所有 NN 的 base class<a class="headerlink" href="#module-nn-base-class" title="Link to this heading">¶</a></h4>
<p>可以包括其他的 module. Modules can also contain other Modules, allowing to nest them in a tree structure.</p>
<dl>
<dt>!!! danger “所有 NN 模型都要 <span class="defi">继承 subclass</span> 它，并且要先 父类的 init”</dt><dd><p><a href="#id51"><span class="problematic" id="id52">``</span></a>` python hl_lines=”6”
import torch.nn as nn
import torch.nn.functional as F</p>
<aside class="system-message" id="id51">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 306); <em><a href="#id52">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<dl class="simple">
<dt>class MyModel(nn.Module):</dt><dd><dl class="simple">
<dt>def __init__(self):</dt><dd><p>super().__init__()
self.conv1 = nn.Conv2d(1, 20, 5)
self.conv2 = nn.Conv2d(20, 20, 5)</p>
</dd>
<dt>def forward(self, x):</dt><dd><p>x = F.relu(self.conv1(x))
return F.relu(self.con2(x))</p>
</dd>
</dl>
</dd>
</dl>
<p>mymodel = MyModel()
y = mymodel(x)
<a href="#id53"><span class="problematic" id="id54">``</span></a><a href="#id55"><span class="problematic" id="id56">`</span></a></p>
<aside class="system-message" id="id53">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 320); <em><a href="#id54">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id55">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 320); <em><a href="#id56">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</dd>
</dl>
<p><a href="#id57"><span class="problematic" id="id58">``</span></a>` python
class Module:</p>
<aside class="system-message" id="id57">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 324); <em><a href="#id58">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 326)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
所有 nn 模型的 base class 都要继承它
“””
…</p>
<dl>
<dt>def __init__(self, <a href="#id59"><span class="problematic" id="id60">*</span></a>args, <a href="#id61"><span class="problematic" id="id62">**</span></a>kwargs) -&gt; None:</dt><dd><aside class="system-message" id="id59">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 331); <em><a href="#id60">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</aside>
<aside class="system-message" id="id61">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 331); <em><a href="#id62">backlink</a></em></p>
<p>Inline strong start-string without end-string.</p>
</aside>
<p>“””
Initializes internal Module state, shared by both nn.Module and ScriptModule.</p>
<dl class="simple">
<dt>Warning:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>如果改属性 最好用 `` super().__setattr__(‘a’, a) ``</dt><dd><p>而不是 `` self.a = a `` 防止 Module.__setattr__ overhead</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 338)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 339)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
</dd>
</dl>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 340)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id63"><span class="problematic" id="id64">``</span></a><a href="#id65"><span class="problematic" id="id66">`</span></a></p>
<aside class="system-message" id="id63">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 340); <em><a href="#id64">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id65">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 340); <em><a href="#id66">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</section>
<section id="sequential-transforms-compose">
<h4 id="sequential-transforms-compose"><cite>Sequential</cite> 类`transforms.Compose`的用法，模型进一步封装<a class="headerlink" href="#sequential-transforms-compose" title="Link to this heading">¶</a></h4>
<dl class="simple">
<dt>!!! p “<cite>torch.nn.Sequential`和 `torch.nn.ModuleList</cite> 的区别”</dt><dd><ul class="simple">
<li><p><cite>torch.nn.ModuleList</cite> 就是真的一个储存模型的list</p></li>
</ul>
</dd>
</dl>
<p><a href="#id67"><span class="problematic" id="id68">``</span></a><a href="#id69"><span class="problematic" id="id70">`</span></a>python hlines=”18 31 35 36 37 45”
class Sequential(Module):</p>
<aside class="system-message" id="id67">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 348); <em><a href="#id68">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id69">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 348); <em><a href="#id70">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 350)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
模型的序列封装，输入会按序经过里面的每一个模型，最后进行输出。
把所有的模型都封装 as a single module
如果不用 OrderedDict, 那么 str(index) 作为 key
可以通过 index 也可以通过 key 来 access</p>
<dl>
<dt>Meth:</dt><dd><ul class="simple">
<li><p>.pop(key)</p></li>
<li><p>.append()</p></li>
<li><p>.extend(Sequential)</p></li>
<li><p>.insert(index, Module)</p></li>
<li><p>del(model)</p></li>
<li><p>= model1 + model 2</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># 按顺序经过 Conv2d(1,20,5) - ReLU - Conv2d(20,64,5) - ReLU</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
<span class="go">        nn.Conv2d(1,20,5),</span>
<span class="go">        nn.ReLU(),</span>
<span class="go">        nn.Conv2d(20,64,5),</span>
<span class="go">        nn.ReLU())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="go"># Sequential(</span>
<span class="go">    (0): Conv2d(1, 20, kernel_size=(5, 5), stride=(1, 1))</span>
<span class="go">    (1): ReLU()</span>
<span class="go">    (2): Conv2d(20, 64, kernel_size=(5, 5), stride=(1, 1))</span>
<span class="go">    (3): ReLU())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="go"># ReLU()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 和 stack 不一样，必须传 index 或 key</span>
<span class="go"># ReLU()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="go"># Conv2d(20, 64, kernel_size=(5, 5), stride=(1, 1))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">ReLU</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">del</span><span class="p">(</span><span class="n">model</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Liner</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go"># Sequential(</span>
<span class="go">    (0): ReLU()</span>
<span class="go">    (1): ReLU()</span>
<span class="go">    (2): Linear(10, 3)</span>
<span class="go">-------------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Using Sequential with OrderedDict.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="n">OrderedDict</span><span class="p">([</span>
<span class="go">        ('conv1', nn.Conv2d(1,20,5)),</span>
<span class="go">        ('relu1', nn.ReLU()),</span>
<span class="go">        ('conv2', nn.Conv2d(20,64,5)),</span>
<span class="go">        ('relu2', nn.ReLU())</span>
<span class="go">        ]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="go"># Sequential(</span>
<span class="go">    (conv1): Conv2d(1, 20, kernel_size=(5, 5), stride=(1, 1))</span>
<span class="go">    (relu1): ReLU()</span>
<span class="go">    (conv2): Conv2d(20, 64, kernel_size=(5, 5), stride=(1, 1))</span>
<span class="go">    (relu2): ReLU())</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 405)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 406)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
<dl>
<dt>def __init__(self, <a href="#id71"><span class="problematic" id="id72">*</span></a>args):</dt><dd><aside class="system-message" id="id71">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 408); <em><a href="#id72">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</aside>
<p>super().__init__()
if len(args) == 1 and isinstance(args[0], OrderedDict):</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 411)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><dl class="simple">
<dt>for key, module in args[0].items():</dt><dd><p>self.add_module(key, module)</p>
</dd>
</dl>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 413)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<dl class="simple">
<dt>else:</dt><dd><dl class="simple">
<dt>for idx, module in enumerate(args):</dt><dd><p>self.add_module(str(idx), module)</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>def __setitem__(self, idx: int, module: Module) -&gt; None:</dt><dd><p>“”” model[idx] = Linear(in, out) “””
key: str = self._get_item_by_idx(self._modules.keys(), idx)
return setattr(self, key, module)</p>
</dd>
<dt>def __delitem__(self, idx: Union[slice, int]) -&gt; None:</dt><dd><p>“”” del(model[idx]) “””
if isinstance(idx, slice):</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 425)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><dl class="simple">
<dt>for key in list(self._modules.keys())[idx]:</dt><dd><p>delattr(self, key)</p>
</dd>
</dl>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 427)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<dl class="simple">
<dt>else:</dt><dd><p>key = self._get_item_by_idx(self._modules.keys(), idx)
delattr(self, key)</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 430)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p># To preserve numbering
str_indices = [str(i) for i in range(len(self._modules))]
self._modules = OrderedDict(list(zip(str_indices, self._modules.values())))</p>
</dd>
<dt>def __add__(self, other) -&gt; ‘Sequential’:</dt><dd><p>“”” model = model1 + model2 “””
if isinstance(other, Sequential):</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 437)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>ret = Sequential()
for layer in self:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 439)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>ret.append(layer)</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 440)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<dl class="simple">
<dt>for layer in other:</dt><dd><p>ret.append(layer)</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 442)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>return ret</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 443)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<dl class="simple">
<dt>else:</dt><dd><dl class="simple">
<dt>raise ValueError(‘add operator supports only objects ‘</dt><dd><dl class="simple">
<dt>‘of Sequential class, but {} is given.’.format(</dt><dd><p>str(type(other))))</p>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>def pop(self, key: Union[int, slice]) -&gt; Module:</dt><dd><p>“”” model.pop(key) “””
v = self[key]
del self[key]
return v</p>
</dd>
</dl>
<p>…</p>
<dl>
<dt>def forward(self, input):</dt><dd><dl class="simple">
<dt>for module in self:</dt><dd><p>input = module(input)</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 459)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>return input</p>
</dd>
<dt>def append(self, module: Module) -&gt; ‘Sequential’:</dt><dd><p>“”” module.append(nn.Module) “””
self.add_module(str(len(self)), module)
return self</p>
</dd>
<dt>def insert(self, index: int, module: Module) -&gt; ‘Sequential’:</dt><dd><p>“”” model.insert(nn.Module)”””
if not isinstance(module, Module):</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 469)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><dl class="simple">
<dt>raise AssertionError(</dt><dd><p>‘module should be of type: {}’.format(Module))</p>
</dd>
</dl>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 471)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>n = len(self._modules)
if not (-n &lt;= index &lt;= n):</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 473)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><dl class="simple">
<dt>raise IndexError(</dt><dd><p>‘Index out of range: {}’.format(index))</p>
</dd>
</dl>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 475)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<dl class="simple">
<dt>if index &lt; 0:</dt><dd><p>index += n</p>
</dd>
<dt>for i in range(n, index, -1):</dt><dd><p>self._modules[str(i)] = self._modules[str(i - 1)]</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 479)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>self._modules[str(index)] = module
return self</p>
</dd>
<dt>def extend(self, sequential) -&gt; ‘Sequential’:</dt><dd><p>“”” model.extend(model1) “””
for layer in sequential:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 485)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>self.append(layer)</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 486)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>return self</p>
</dd>
</dl>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 487)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id73"><span class="problematic" id="id74">``</span></a><a href="#id75"><span class="problematic" id="id76">`</span></a></p>
<aside class="system-message" id="id73">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 487); <em><a href="#id74">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id75">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 487); <em><a href="#id76">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</section>
</section>
<section id="nn-xxx-nn-functional-xxx">
<h3 id="nn-xxx-nn-functional-xxx">nn.xxx &amp; nn.functional.xxx<a class="headerlink" href="#nn-xxx-nn-functional-xxx" title="Link to this heading">¶</a></h3>
<p><a href="#id77"><span class="problematic" id="id78">``</span></a><a href="#id79"><span class="problematic" id="id80">`</span></a>python
from torch import nn
from torch.nn inport Functional as F</p>
<aside class="system-message" id="id77">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 492); <em><a href="#id78">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id79">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 492); <em><a href="#id80">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<p>layer_nn = nn.conv2d(…)
layer_F = F.conv2d(…)
<a href="#id81"><span class="problematic" id="id82">``</span></a><a href="#id83"><span class="problematic" id="id84">`</span></a></p>
<aside class="system-message" id="id81">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 496); <em><a href="#id82">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id83">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 496); <em><a href="#id84">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<section id="liner">
<h4 id="liner">Liner<a class="headerlink" href="#liner" title="Link to this heading">¶</a></h4>
<p><a href="#id85"><span class="problematic" id="id86">``</span></a>` python
class Linear(Module):</p>
<aside class="system-message" id="id85">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 503); <em><a href="#id86">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 505)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
h = W^Tx+b</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>in_features: Int = 入</p></li>
<li><p>out_features: Int = 出</p></li>
<li><dl class="simple">
<dt>bias: Bool</dt><dd><p>default = True</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Attributes:</dt><dd><ul class="simple">
<li><p>weight: tensor[in_features, out_features]</p></li>
<li><p>bias: tensor[1]</p></li>
</ul>
</dd>
<dt>Examples::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">size</span><span class="p">())</span>
<span class="go">#res: torch.Size([128, 30])</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 524)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””</p>
<p>…</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 527)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id87"><span class="problematic" id="id88">``</span></a><a href="#id89"><span class="problematic" id="id90">`</span></a></p>
<aside class="system-message" id="id87">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 527); <em><a href="#id88">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id89">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 527); <em><a href="#id90">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</section>
<section id="conv">
<h4 id="conv">Conv<a class="headerlink" href="#conv" title="Link to this heading">¶</a></h4>
<blockquote>
<div><p>:math:``</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 533)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>mathcal{U}(-sqrt{k}, sqrt{k})
\
k = frac{groups}{<a href="#id266"><span class="problematic" id="id267">C_</span></a>text{in} * prod_{i=0}^{1}text{kernel_size}[i]}</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 536)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>:math:``</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 538)</p>
<p>Missing matching underline for section title overline.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>-----
 :math:``
\text{out}(N_i, C_{\text{out}_j}) = \text{bias}(C_{\text{out}_j}) +
</pre></div>
</div>
</aside>
<p>sum_{k = 0}^{C_{text{in}} - 1} text{weight}(C_{text{out}_j}, k) star text{input}(N_i, k)
\begin{cases} N&amp;text{batch size}\ C&amp;text{channel}\H&amp;text{height}\W&amp;text{width}\end{cases}\
H_{out} = leftlfloorfrac{H_{in}  + 2 times text{padding}[0] - text{dilation}[0]</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 544)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>times (text{kernel_size}[0] - 1) - 1}{text{stride}[0]} + 1rightrfloor\</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 545)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<dl>
<dt>W_{out} = leftlfloorfrac{W_{in}  + 2 times text{padding}[1] - text{dilation}[1]</dt><dd><blockquote>
<div><p>times (text{kernel_size}[1] - 1) - 1}{text{stride}[1]} + 1rightrfloor</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 547)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>:math:``</p>
</dd>
<dt>!!! danger “input size”</dt><dd><p>nn 可以[B, C, H, W] 或 [C, H, W]
functional <span class="defi">只可以 [B, C, H, W]</span></p>
</dd>
</dl>
<p><a href="#id91"><span class="problematic" id="id92">``</span></a>` python hl_lines=”3”
class Conv2d(_ConvNd):</p>
<aside class="system-message" id="id91">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 553); <em><a href="#id92">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 555)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
nn.Conv2d</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>in_channels: int = C_{in} = 输入的通道数</p></li>
<li><p>out_channels: int = C_{out} = 输出的通道数</p></li>
<li><p>kernel_size: Union[int. tuple(int)] (int or tuple) = 卷积核大小</p></li>
<li><dl class="simple">
<dt>stride: Union[int, tuple(int)] = 位移量</dt><dd><p>default = 1
- int = 竖直方向 = 水平方向</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>padding: Union[int, tuple(int), strin{{‘valid’, ‘same’}}] = 填充 input 图像</dt><dd><p>default = 0
- int = 竖直方向 = 水平方向
- ‘valid’ = no padding
- ‘same’ = 使得 input‘shape = output’shape</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dilation: Union[int, tuple(int)]= 填充 kernel 卷积核,  Spacing between kernel elements</dt><dd><p>default = 1 = no space
详看理论部分</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>bias: bool 可学习的偏置</dt><dd><p>default: <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Shape:</dt><dd><ul class="simple">
<li><p>Input = (N, C_{in}, H_{in}, W_{in}) 或 (C_{in}, H_{in}, W_{in})</p></li>
<li><p>Output = (N, C_{out}, H_{out}, W_{out}) 或 (C_{out}, H_{out}, W_{out})</p></li>
</ul>
</dd>
<dt>Attributes:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>weight: Tensor[…] = 学习出来的卷积核 kernel</dt><dd><p>详看理论部分</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>bias: Tensor[out_channels] = 学习出来的偏置</dt><dd><p>需要 bias := True
详看理论部分</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># non-square kernels and unequal stride and with padding and dilation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">padding</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dilation</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 592)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””</p>
<dl>
<dt>def __init__(</dt><dd><p>self,
in_channels: int,
out_channels: int,
kernel_size: _size_2_t,
stride: _size_2_t = 1,
padding: Union[str, _size_2_t] = 0,
dilation: _size_2_t = 1,
groups: int = 1,
bias: bool = True,
padding_mode: str = ‘zeros’,  # TODO: refine this type
device=None,
dtype=None</p>
</dd>
<dt>) -&gt; None:</dt><dd><p>…
super().__init__(</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 610)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>in_channels, out_channels, <a href="#id268"><span class="problematic" id="id269">kernel_size_</span></a>, <a href="#id270"><span class="problematic" id="id271">stride_</span></a>, <a href="#id272"><span class="problematic" id="id273">padding_</span></a>, <a href="#id274"><span class="problematic" id="id275">dilation_</span></a>,
False, _pair(0), groups, bias, padding_mode, <a href="#id93"><span class="problematic" id="id94">**</span></a>factory_kwargs)</p>
<aside class="system-message" id="id93">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 610); <em><a href="#id94">backlink</a></em></p>
<p>Inline strong start-string without end-string.</p>
</aside>
</div></blockquote>
</dd>
</dl>
<p>…</p>
</div></blockquote>
<p><a href="#id95"><span class="problematic" id="id96">``</span></a><a href="#id97"><span class="problematic" id="id98">`</span></a></p>
<aside class="system-message" id="id95">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 615); <em><a href="#id96">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id97">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 615); <em><a href="#id98">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<p><a href="#id99"><span class="problematic" id="id100">``</span></a>` python hl_lines=”4”
conv2d = _add_docstr(</p>
<aside class="system-message" id="id99">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 617); <em><a href="#id100">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 619)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>torch.conv2d,
“””
nn.funcational.conv2d</p>
<p>conv2d(input, weight, bias=None, stride=1, padding=0, dilation=1, groups=1) -&gt; Tensor</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>input: Tensor[minibatch, in_channels, in_H , in_W]</p></li>
<li><p>weight: Tensor[out_channels, ?, ke_H, ke_W] = 卷积核</p></li>
<li><p>bias: Union[Tensor[out_channels], None]</p></li>
<li><dl class="simple">
<dt>stride: Union[Int, Tuple(Int, Int)]</dt><dd><p>default =  1</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>padding: Union[Int, Tuple(Int, Int), Str{‘valid’, ‘same’}]</dt><dd><p>default = 0
- ‘valid’ = no padding
- ‘same’ =</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>dilation: Union[Int, Tuple(Int, Int)] the spacing between kernel elements.</dt><dd><p>default = 1</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># With square kernels and equal stride</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">filters</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span><span class="o">.</span><span class="n">conv2d</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">filters</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 644)</p>
<p>Literal block ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 645)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<section id="id101">
<h5 id="id101">)<a class="headerlink" href="#id101" title="Link to this heading">¶</a></h5>
<p><a href="#id102"><span class="problematic" id="id103">``</span></a><a href="#id104"><span class="problematic" id="id105">`</span></a></p>
<aside class="system-message" id="id102">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 647); <em><a href="#id103">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id104">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 647); <em><a href="#id105">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</section>
</section>
<section id="pool">
<h4 id="pool">Pool<a class="headerlink" href="#pool" title="Link to this heading">¶</a></h4>
<p><a href="#id106"><span class="problematic" id="id107">``</span></a><a href="#id108"><span class="problematic" id="id109">`</span></a>python hl_lines=”1”
class MaxPool2d(_MaxPoolNd):</p>
<aside class="system-message" id="id106">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 652); <em><a href="#id107">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id108">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 652); <em><a href="#id109">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 654)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
2D 最大池化</p>
<dl>
<dt>Shape:</dt><dd><ul class="simple">
<li><p>input = [N, C, in_H, in_W] 或 [C, in_H, in_W]</p></li>
<li><p>ouptput = [N, C, out_H, out_W] 或 [C, in_H, in_W]</p></li>
<li><p>kernel = [ke_H, ke_W]</p></li>
</ul>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 661)</p>
<p>Bullet list ends without a blank line; unexpected unindent.</p>
</aside>
<p>公式详看理论部分</p>
</dd>
<dt>Args:</dt><dd><ul class="simple">
<li><p>kernel_size: Union[Int, Tuple(Int, Int)]</p></li>
<li><dl class="simple">
<dt>stride: Union[Int, Tuple(Int, Int)]</dt><dd><p>default = kernel_size !!!</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>padding: Union[Int, Tuple(Int, Int)] = 填充负无穷</dt><dd><p>用来针对除不尽的情况，也不会影响到取值（MaxPool）</p>
</dd>
</dl>
</li>
<li><p>dilation: Union[Int, Tuple(Int, Int)] = controls the stride of elements in the window</p></li>
<li><dl class="simple">
<dt>return_indices: Bool = 返回 MaxPool 中被取值的索引</dt><dd><p>default =</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>ceil_mode: Bool = 要不要边界料</dt><dd><p>default = False
- False = <cite>floor</cite> = 不要边角料
- True = <cite>ceil</cite> = 要边角料 go off-bounds
应对除不尽的情况， 详看理论部分</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># pool of non-square window</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">stride</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 683)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””</p>
<p>…</p>
<dl class="simple">
<dt>def forward(self, input: Tensor):</dt><dd><dl class="simple">
<dt>return F.max_pool2d(input, self.kernel_size, self.stride,</dt><dd><p>self.padding, self.dilation, ceil_mode=self.ceil_mode,
return_indices=self.return_indices)</p>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 691)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id110"><span class="problematic" id="id111">``</span></a><a href="#id112"><span class="problematic" id="id113">`</span></a></p>
<aside class="system-message" id="id110">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 691); <em><a href="#id111">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id112">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 691); <em><a href="#id113">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</section>
<section id="activation">
<h4 id="activation">activation<a class="headerlink" href="#activation" title="Link to this heading">¶</a></h4>
<dl>
<dt>!!! danger “non-inpalce</dt><dd><p>shape：[B, <a href="#id114"><span class="problematic" id="id115">*</span></a>] 除了必须batchsize，后面 size 都随便”</p>
<aside class="system-message" id="id114">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 697); <em><a href="#id115">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</aside>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 699)</p>
<p>Title level inconsistent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">softmax</span>
<span class="o">++++++++++++++++</span>
</pre></div>
</div>
</aside>
<blockquote>
<div><p>:math:``</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 703)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<dl class="simple">
<dt>text{Softmax}(x_{i}) = frac{exp(x_i)}{sum_j exp(x_j)}</dt><dd><p>:math:``</p>
</dd>
</dl>
<ul class="simple">
<li><p>如果是稀疏向量 sparse vector（只传递非0的值），那些未传递的=原本是0的 在 softmax 里 看作  <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>−</mo><mi>inf</mi><mo>⁡</mo><mtext>，</mtext><mo>→</mo><mtext>softmax</mtext><mo stretchy="false">(</mo><mo>−</mo><mi>inf</mi><mo>⁡</mo><mo stretchy="false">)</mo><mo>→</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">-\inf，\rightarrow \text{softmax}(-\inf)\rightarrow0</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">in<span style="margin-right:0.07778em;">f</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord cjk_fallback">，</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">softmax</span></span><span class="mopen">(</span><span class="mord">−</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">in<span style="margin-right:0.07778em;">f</span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></span></p></li>
</ul>
<p><a href="#id116"><span class="problematic" id="id117">``</span></a><a href="#id118"><span class="problematic" id="id119">`</span></a>python
class Softmax(Module):</p>
<aside class="system-message" id="id116">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 708); <em><a href="#id117">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id118">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 708); <em><a href="#id119">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 710)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
将某一维的值 映射到[0, 1] &amp; sum=1。</p>
<dl>
<dt>Shape:</dt><dd><p>都可以</p>
</dd>
<dt>Args:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>dim: Int = 要进行 softmax 的维度</dt><dd><p>default =</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Examples::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">one</span><span class="p">,</span> <span class="n">zerp</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Softmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">nn</span><span class="o">.</span><span class="n">Softmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y1</span><span class="p">,</span> <span class="n">y0</span> <span class="o">=</span> <span class="n">one</span><span class="p">(</span><span class="nb">input</span><span class="p">),</span> <span class="n">zero</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="go"># y1 = tensor([[0.5, 0.5], [0.5, 0.5]])</span>
<span class="go"># y0 = tensor([[0.0474, 0.0474], [0.9526, 0.9526]])</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 726)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 727)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 728)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id120"><span class="problematic" id="id121">``</span></a><a href="#id122"><span class="problematic" id="id123">`</span></a></p>
<aside class="system-message" id="id120">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 728); <em><a href="#id121">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id122">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 728); <em><a href="#id123">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 730)</p>
<p>Title level inconsistent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ReLU</span><span class="p">,</span> <span class="n">rectified</span> <span class="n">linear</span> <span class="n">unit</span>
<span class="o">++++++++++++++++++++++++++++++++++++++++++++++++++++++++</span>
</pre></div>
</div>
</aside>
<blockquote>
<div><p>:math:``</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 734)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<dl class="simple">
<dt>text{ReLU}(x) = (x)^+ = max(0, x)</dt><dd><p>:math:``</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 736)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>![](<a class="reference external" href="https://pytorch.org/docs/stable/_images/ReLU.png">https://pytorch.org/docs/stable/_images/ReLU.png</a>){width=60%}</p>
<p><a href="#id124"><span class="problematic" id="id125">``</span></a><a href="#id126"><span class="problematic" id="id127">`</span></a>python
class ReLU(Module):</p>
<aside class="system-message" id="id124">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 738); <em><a href="#id125">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id126">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 738); <em><a href="#id127">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 740)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
对于0以下截断</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>inplace:Bool = 原地实现</dt><dd><p>default = False</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Shape:</dt><dd><p>都可以</p>
</dd>
<dt>Examples::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="go"># output: tensor([[0., 0.], [2., 2.]])</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 755)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 756)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 757)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id128"><span class="problematic" id="id129">``</span></a><a href="#id130"><span class="problematic" id="id131">`</span></a></p>
<aside class="system-message" id="id128">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 757); <em><a href="#id129">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id130">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 757); <em><a href="#id131">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 759)</p>
<p>Title level inconsistent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Sigmoid</span>
<span class="o">++++++++++++++++</span>
</pre></div>
</div>
</aside>
<blockquote>
<div><p>:math:``</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 763)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<dl class="simple">
<dt>text{Sigmoid}(x) = sigma(x) = frac{1}{1 + exp(-x)}</dt><dd><p>:math:``</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 765)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>![](<a class="reference external" href="https://pytorch.org/docs/stable/_images/Sigmoid.png">https://pytorch.org/docs/stable/_images/Sigmoid.png</a>){width=60%}</p>
<p><a href="#id132"><span class="problematic" id="id133">``</span></a>` python
class Sigmoid(Module):</p>
<aside class="system-message" id="id132">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 767); <em><a href="#id133">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 769)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
逐元素，映射到0-1 ，靠近0变化大，否则变化缓慢</p>
<dl>
<dt>Shape:</dt><dd><p>都可以</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],[</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="go"># output: tensor([[0.2689, 0.2689], [0.8808, 0.8808]])</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 780)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 781)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 782)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id134"><span class="problematic" id="id135">``</span></a><a href="#id136"><span class="problematic" id="id137">`</span></a></p>
<aside class="system-message" id="id134">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 782); <em><a href="#id135">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id136">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 782); <em><a href="#id137">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</section>
<section id="normalization">
<h4 id="normalization">Normalization<a class="headerlink" href="#normalization" title="Link to this heading">¶</a></h4>
</section>
<section id="droupout">
<h4 id="droupout">Droupout<a class="headerlink" href="#droupout" title="Link to this heading">¶</a></h4>
<p>!!! question “如果特征图中的相邻像素具有很强的相关性 (则 i.i.d. dropout 不会使激活正则化，否则只会导致有效学习率下降。”</p>
<p>!!! danger “必须有batch！！！”</p>
<p><a href="#id138"><span class="problematic" id="id139">``</span></a>` python
class Dropout1d(_DropoutNd):</p>
<aside class="system-message" id="id138">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 794); <em><a href="#id139">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 796)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
随机取0，增强 feature maps 的独立性，防止过拟合。
概率 p 伯努利采样</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>p: Optional[Float]</p></li>
<li><dl class="simple">
<dt>inplace:bool</dt><dd><p>default = False</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>Input: [B, C, L] 或 [C, L]</dt><dd><p>卷积的时候：nn.Conv1d: 1D-tensor</p>
</dd>
</dl>
</li>
<li><p>Output: [B, C, L] 或 [C, L]</p></li>
</ul>
</dd>
<dt>Examples::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout1d</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 814)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 815)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
</div></blockquote>
<dl>
<dt>class Dropout2d(_DropoutNd):</dt><dd><p>“””
随机取0，增强 feature maps 的独立性，防止过拟合。
概率 p 伯努利采样</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>p: Optional[Float]</p></li>
<li><dl class="simple">
<dt>inplace:bool</dt><dd><p>default = False</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Shape:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>Input: [B, C, H, W] 或 [B, C, L]</dt><dd><p>卷积的时候：nn.Conv1d: 2D-tensor</p>
</dd>
</dl>
</li>
<li><p>Output: [B, C, H, W] 或 [B, C, L]</p></li>
</ul>
</dd>
<dt>Examples::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dropout2d</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 836)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 837)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 838)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id140"><span class="problematic" id="id141">``</span></a><a href="#id142"><span class="problematic" id="id143">`</span></a></p>
<aside class="system-message" id="id140">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 838); <em><a href="#id141">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id142">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 838); <em><a href="#id143">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</section>
<section id="flatten">
<h4 id="flatten"><cite>flatten</cite><a class="headerlink" href="#flatten" title="Link to this heading">¶</a></h4>
<p><a href="#id144"><span class="problematic" id="id145">``</span></a><a href="#id146"><span class="problematic" id="id147">`</span></a>python hl_lines=”14 17”
class Flatten(Module):</p>
<aside class="system-message" id="id144">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 843); <em><a href="#id145">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id146">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 843); <em><a href="#id147">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 845)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
给定维度展平向量</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>start_dim: Int = 开始的维度</dt><dd><p>default = 1</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>end_dim: Int  = 结束的维度</dt><dd><p>default = -1</p>
</dd>
</dl>
</li>
</ul>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 853)</p>
<p>Bullet list ends without a blank line; unexpected unindent.</p>
</aside>
<p>default 就是 [B, H, W, …] -&gt; [B, H*W*…], 最外层不会被展平</p>
</dd>
<dt>Examples::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()</span> <span class="c1"># 默认 0B 除外</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="go">torch.Size([32, 25])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># 自定义：最里面除外</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">m</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="go">torch.Size([160, 5])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># 全展平</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 864)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 865)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 866)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id148"><span class="problematic" id="id149">``</span></a><a href="#id150"><span class="problematic" id="id151">`</span></a></p>
<aside class="system-message" id="id148">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 866); <em><a href="#id149">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id150">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 866); <em><a href="#id151">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</section>
</section>
</section>
<section id="torch-nn-loss-torch-optim">
<h2 id="torch-nn-loss-torch-optim"><cite>torch.nn.`Loss &amp; `torch.Optim</cite><a class="headerlink" href="#torch-nn-loss-torch-optim" title="Link to this heading">¶</a></h2>
<p><a href="#id152"><span class="problematic" id="id153">``</span></a>` python
model = # 定义模型
loss_fn = # 定义 loss 算法
optimizer = # 定义 梯度迭代 的算法
“”” basic “””
for input, target in dataset:</p>
<aside class="system-message" id="id152">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 871); <em><a href="#id153">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 877)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>output = model(input)
loss = loss_fn(output, target) # 算 loss
optimizer.zero_grad() # 清空上一轮算出来的的梯度，否则梯度会累积
loss.backward() # 通过 反向传播 计算新一轮梯度
optimizer.step() # 根据算出来的梯度 更新参数</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 882)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id154"><span class="problematic" id="id155">``</span></a><a href="#id156"><span class="problematic" id="id157">`</span></a></p>
<aside class="system-message" id="id154">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 882); <em><a href="#id155">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id156">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 882); <em><a href="#id157">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<p><a href="#id158"><span class="problematic" id="id159">``</span></a>` python
from torch import nn
from torch.optim import SGD</p>
<aside class="system-message" id="id158">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 884); <em><a href="#id159">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<dl class="simple">
<dt>model = nn.Sequential(</dt><dd><p>Linear(10, 32),
ReLU(),
Linear(32, 3)</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 892)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>)
loss_fn = nn.L1Loss()
optimizer = SGD(model.parameters(), lr=0.01, momentum=0.9)</p>
<p>“”” whole batch 整一个”””
for i in range(epoch):</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 898)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>loss_epoch = 0
for x, y in dataloader:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 900)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>y_hat = model(x)
loss_epoch += loss_fn(y, y_hat)</p>
</div></blockquote>
<p>optimizer.zero_grad()
loss_epoch.backward()
loss_epoch.step()</p>
</div></blockquote>
<p>“”” mini-batch “””
<a href="#id160"><span class="problematic" id="id161">``</span></a><a href="#id162"><span class="problematic" id="id163">`</span></a></p>
<aside class="system-message" id="id160">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 907); <em><a href="#id161">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id162">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 907); <em><a href="#id163">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 910)</p>
<p>Title level inconsistent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`torch.optim`
^^^^^^^^^^^^^^^^^^^^^^^^^^^^
</pre></div>
</div>
</aside>
<p>构建一个优化器对象，该对象将保持当前状态，并将根据计算的梯度更新参数。</p>
<dl>
<dt>!!! danger “ <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>Minimize</mtext><mi>f</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{Minimize} f(\theta)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Minimize</span></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span> “</dt><dd><dl class="simple">
<dt><cite>maximize = False(default)</cite> <span class="math"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>  </mtext><mo>⟺</mo><mtext>  </mtext><msub><mi>g</mi><mi>t</mi></msub><mo>←</mo><mo>=</mo><mo>−</mo><mi mathvariant="normal">∇</mi><mi>f</mi><mo stretchy="false">(</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\iff g_t\leftarrow=-\nabla f(\theta)</annotation></semantics></math></span><span aria-hidden="true" class="katex-html"><span class="base"><span class="strut" style="height:0.549em;vertical-align:-0.024em;"></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⟺</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">←=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mord">∇</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span></span></dt><dd><p>:math:`` begin{aligned}</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 918)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>&amp;textbf{关于梯度：}nabla 是上升的方向\[-1em]
&amp;rule{110mm}{0.4pt}\
&amp;textbf{input}:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 921)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>theta_0 text{ (params)}, :
f(theta) text{ (objective)}, : textit{maximize}\[-1em]</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 923)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>&amp;rule{110mm}{0.4pt}\
&amp;hspace{5mm}textbf{if} : textit{maximize}iff text{Maximize }f(theta)\
&amp;hspace{10mm}g_t leftarrow  +nabla_theta f(theta)\
&amp;hspace{5mm}textbf{else}iff text{Minimize}f(theta)\
&amp;hspace{10mm}g_t leftarrow -nabla_theta f(theta)\[-1em]
&amp;rule{110mm}{0.4pt}
end{aligned} :math:``</p>
</dd>
<dt>!!! p “Nesterov momentum”</dt><dd><p>is based on the formula from
<a href="#id264"><span class="problematic" id="id265">`On the importance of initialization and momentum in deep learning`__</span></a>.</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 935)</p>
<p>Title level inconsistent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Adam</span>
<span class="o">++++++++++</span>
</pre></div>
</div>
</aside>
<p><a href="#id164"><span class="problematic" id="id165">``</span></a>` python
class Adam(Optimizer):</p>
<aside class="system-message" id="id164">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 938); <em><a href="#id165">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 940)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
Args:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 942)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><ul class="simple">
<li><p>params: iterable = 需要迭代的参数</p></li>
<li><dl class="simple">
<dt>lr: Float &gt;0 = 学习率</dt><dd><p>default = 1e-3</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>betas: Tuple(Float, Float)in[0, 1)</dt><dd><p>default = (0.9, 0.999)</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 947)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””
def __init__(self, params, lr=1e-3, betas=(0.9, 0.999), eps=1e-8,</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 949)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><blockquote>
<div><p>weight_decay=0, amsgrad=False, <a href="#id166"><span class="problematic" id="id167">*</span></a>, foreach: Optional[bool] = None,
maximize: bool = False, capturable: bool = False,
differentiable: bool = False, fused: Optional[bool] = None):</p>
<aside class="system-message" id="id166">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 949); <em><a href="#id167">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</aside>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 952)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>…</p>
</div></blockquote>
<p>…</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 955)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id168"><span class="problematic" id="id169">``</span></a><a href="#id170"><span class="problematic" id="id171">`</span></a></p>
<aside class="system-message" id="id168">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 955); <em><a href="#id169">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id170">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 955); <em><a href="#id171">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 957)</p>
<p>Title level inconsistent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">SGD</span> <span class="n">随机梯度下降</span>
<span class="o">++++++++++++++++++++++</span>
</pre></div>
</div>
</aside>
<p>SGD, Stochastic Gradient Descent(optionally with momentum)</p>
<p><a href="#id172"><span class="problematic" id="id173">``</span></a>` python
class SGD(Optimizer):</p>
<aside class="system-message" id="id172">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 962); <em><a href="#id173">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 964)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
随机梯度下降</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>params: iterable = 要迭代的参数</p></li>
<li><p>lr: Float &gt;0  = 学习率</p></li>
<li><dl class="simple">
<dt>momentum: Optional(Int) &gt;0 = 冲量</dt><dd><p>default = 0</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 972)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””
def __init__(self, params, lr=required, momentum=0, dampening=0,</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 974)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><blockquote>
<div><p>weight_decay=0, nesterov=False, <a href="#id174"><span class="problematic" id="id175">*</span></a>, maximize: bool = False,
foreach: Optional[bool] = None, differentiable: bool = False):</p>
<aside class="system-message" id="id174">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 974); <em><a href="#id175">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</aside>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 976)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>…</p>
</div></blockquote>
<p>…</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 979)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id176"><span class="problematic" id="id177">``</span></a><a href="#id178"><span class="problematic" id="id179">`</span></a></p>
<aside class="system-message" id="id176">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 979); <em><a href="#id177">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id178">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 979); <em><a href="#id179">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 981)</p>
<p>Title level inconsistent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Adagrad</span><span class="p">,</span> <span class="n">自适应随机梯度下降</span>
<span class="o">++++++++++++++++++++++++++++++++++++++</span>
</pre></div>
</div>
</aside>
<p><a href="#id180"><span class="problematic" id="id181">``</span></a><a href="#id182"><span class="problematic" id="id183">`</span></a>python
class Adagrad(Optimizer):</p>
<aside class="system-message" id="id180">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 984); <em><a href="#id181">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id182">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 984); <em><a href="#id183">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 986)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
Adaptive Stochastic Gradient</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>params: iterable = 要迭代的参数</p></li>
<li><dl class="simple">
<dt>lr: Float &gt;0  = 学习率</dt><dd><p>default = 1e-2</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>lr_decay: Float &gt;0</dt><dd><p>default = 0</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 995)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””
def __init__(self, params, lr=1e-2, lr_decay=0, weight_decay=0,</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 997)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>initial_accumulator_value=0,eps=1e-10, foreach: Optional[bool] = None,
<a href="#id184"><span class="problematic" id="id185">*</span></a>, maximize: bool = False,differentiable: bool = False,):
…</p>
<aside class="system-message" id="id184">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 997); <em><a href="#id185">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</aside>
</div></blockquote>
<p>…</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1002)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id186"><span class="problematic" id="id187">``</span></a><a href="#id188"><span class="problematic" id="id189">`</span></a></p>
<aside class="system-message" id="id186">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1002); <em><a href="#id187">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id188">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1002); <em><a href="#id189">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1004)</p>
<p>Title level inconsistent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>`torch.nn.`Loss
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
</pre></div>
</div>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1007)</p>
<p>Title level inconsistent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L1Loss</span><span class="p">,</span> <span class="n">MAE</span>
<span class="o">++++++++++++++++++++++++</span>
</pre></div>
</div>
</aside>
<blockquote>
<div><p>:math:``</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1011)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>text{MAE} = ell(f)= begin{cases}mathbb{E}verthat{y_i}-y_ivertinR&amp;text{reduction=mean} \ Verthat{y}-yVert_1inR&amp;text{reduction=sum}\verthat{y}-yvertinR^n&amp;text{reduction=none}
end{cases}</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1013)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>:math:``</p>
</div></blockquote>
<p><a href="#id190"><span class="problematic" id="id191">``</span></a>` python
class L1Loss(_Loss):</p>
<aside class="system-message" id="id190">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1015); <em><a href="#id191">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1017)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
the mean absolute error (MAE)</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>reduction: Optional[Str{‘none’, ‘mean’, ‘sum}]</dt><dd><p>default = ‘mean’</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Examples::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">L1Loss</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pred</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">l</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="c1"># 计算 loss</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span> <span class="c1"># 回溯</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1030)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1031)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1032)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id192"><span class="problematic" id="id193">``</span></a><a href="#id194"><span class="problematic" id="id195">`</span></a></p>
<aside class="system-message" id="id192">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1032); <em><a href="#id193">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id194">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1032); <em><a href="#id195">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1034)</p>
<p>Title level inconsistent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">MSE</span>
<span class="o">++++++++</span>
</pre></div>
</div>
</aside>
<blockquote>
<div><p>:math:``</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1038)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>text{MSE} = ell(f)= begin{cases}mathbb{E}(hat{y_i}-y_i)^2inR&amp;text{reduction=mean} \ Verthat{y}-yVert_2inR&amp;text{reduction=sum}\(hat{y}-y)^2inR^n&amp;text{reduction=none}
end{cases}</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1040)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>:math:``</p>
</div></blockquote>
<p><a href="#id196"><span class="problematic" id="id197">``</span></a>` python
class MSELoss(_Loss):</p>
<aside class="system-message" id="id196">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1042); <em><a href="#id197">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1044)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
mean squared error (squared L2 norm)</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>reduction: Optional[Str{‘none’, ‘mean’, ‘sum}]</dt><dd><p>default = ‘mean’</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Examples::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MSELoss</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1057)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1058)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1059)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id198"><span class="problematic" id="id199">``</span></a><a href="#id200"><span class="problematic" id="id201">`</span></a></p>
<aside class="system-message" id="id198">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1059); <em><a href="#id199">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id200">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1059); <em><a href="#id201">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1061)</p>
<p>Title level inconsistent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CELoss</span>
<span class="o">++++++++++++++</span>
</pre></div>
</div>
</aside>
<dl>
<dt>!!! danger “<cite>torch.nn.CrossEntropyLoss()</cite>”</dt><dd><blockquote>
<div><p>= <cite>torch.nn.LogSoftmax</cite> + <cite>torch.nn.NLLLoss</cite>
softmax 非负化归一化 + 交叉熵</p>
</div></blockquote>
<p>:math:`` begin{align}ell(f) &amp;=w_{y^_}  * - log cfrac{exp(hat{y}^_)}{sum_C exp(hat{y})}cdot mathbb{1}{y^* neq text{ignore_index}}\&amp;=w_{y^*}  * -text{softmax}(hat{y}) qquadtext{ 不在忽略}</p>
</dd>
<dt>end{align}</dt><dd><p>\</p>
</dd>
<dt>ell(x, y) = begin{cases}</dt><dd><blockquote>
<div><blockquote>
<div><blockquote>
<div><dl>
<dt>sum_{n=1}^N frac{1}{sum_{n=1}^N w_{y_n} cdot mathbb{1}{y_n not= text{ignore_index}}} l_n, &amp;</dt><dd><dl>
<dt>text{if reduction} = text{<a href="#id202"><span class="problematic" id="id203">`</span></a>mean’;}\</dt><dd><aside class="system-message" id="id202">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1073); <em><a href="#id203">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<p>sum_{n=1}^N l_n,  &amp;
text{if reduction} = text{<a href="#id204"><span class="problematic" id="id205">`</span></a>sum’.}</p>
<aside class="system-message" id="id204">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1074); <em><a href="#id205">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</dd>
</dl>
</dd>
</dl>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1076)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>end{cases}\ell(x, y) = L = {l_1,dots,l_N}^top, quad</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1077)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>l_n = - sum_{c=1}^C w_c log frac{exp(x_{n,c})}{sum_{i=1}^C exp(x_{n,i})} y_{n,c}</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1078)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>:math:``</p>
</dd>
</dl>
<p><a href="#id206"><span class="problematic" id="id207">``</span></a>` python</p>
<aside class="system-message" id="id206">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1080); <em><a href="#id207">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<dl>
<dt>class CrossEntropyLoss(_WeightedLoss):</dt><dd><p>“””
cross entropy loss, 二分类或多分类很有用，尤其是类别不平衡</p>
<dl>
<dt>Warning:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>输入不必先经过 softmax（保证都为正且总和=1。</dt><dd><p>因为这里会包括这个操作 = softmax-&gt;max-&gt;</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Shape</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>input: [C] 或 [B, C] 或  = 预测的，原始的不必经过 softmax</dt><dd><p>C: #class</p>
</dd>
</dl>
</li>
<li><p>target: [1] 或 [B] = 真实的，类别，class indices</p></li>
<li><dl class="simple">
<dt>output:</dt><dd><ul>
<li><p>‘none’ : [1], [B]</p></li>
<li><p>‘mean’, ‘sum’ : Int 或 [1]</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Args:</dt><dd><ul>
<li><p>weight: optional(Tensor[C]) = 权</p></li>
<li><dl class="simple">
<dt>ignore_index: Optional[int] = 忽略的类别</dt><dd><p>只有在 target 放的是正确的**类别(1, 2, ..)**才起效
算 avg 时候 ignore 也 不算除数</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>reduction: Optional[Str{‘none’, ‘mean’, ‘sum}]</dt><dd><p>default = ‘mean’</p>
</dd>
</dl>
</li>
<li><dl>
<dt>label_smoothing: Optional[Float] in [0.0, 1.0].</dt><dd><ul class="simple">
<li><p>default = 0.0 = no smoothing.</p></li>
</ul>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1107)</p>
<p>Bullet list ends without a blank line; unexpected unindent.</p>
</aside>
<p>看论文：<cite>Rethinking the Inception Architecture for Computer Vision</cite>
a mixture of the original ground truth and a uniform distribution</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Examples::</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example of target with class indices</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">long</span><span class="p">)</span><span class="o">.</span><span class="n">random_</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="go"># tensor([4, 3, 1])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
<span class="go">-----------------------------------------------------------</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Example of target with class probabilities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">target</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go"># tensor([[0.1190, 0.3896, 0.3429, 0.0254, 0.1231],</span>
<span class="go">#           [0.0963, 0.0300, 0.3308, 0.1970, 0.3459],</span>
<span class="go">#           [0.0920, 0.2793, 0.1674, 0.4453, 0.0159]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1125)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1126)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1127)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id208"><span class="problematic" id="id209">``</span></a><a href="#id210"><span class="problematic" id="id211">`</span></a></p>
<aside class="system-message" id="id208">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1127); <em><a href="#id209">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id210">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1127); <em><a href="#id211">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</section>
<section id="save-load">
<h2 id="save-load">Save &amp; Load<a class="headerlink" href="#save-load" title="Link to this heading">¶</a></h2>
<dl class="simple">
<dt>!!! danger “<cite>AttributeError: Can’t get attribute ‘MyModel’ on &lt;module ‘__main__’ from ‘xxx.py’&gt;</cite>”</dt><dd><p>自定义的模型 必须先import进来，否则就会加载不了</p>
</dd>
</dl>
<p><a href="#id212"><span class="problematic" id="id213">``</span></a>` python
vgg16 = torchvision.models.vgg16()
class MyModel(nn.Module):</p>
<aside class="system-message" id="id212">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1135); <em><a href="#id213">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1138)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><dl class="simple">
<dt>def __init__(self):</dt><dd><p>super.__init__()
self.linear1 = nn.Linear(4, 2)
self.sigmoid1 = nn.Sigmoid()</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1142)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>…</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1143)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id214"><span class="problematic" id="id215">``</span></a><a href="#id216"><span class="problematic" id="id217">`</span></a></p>
<aside class="system-message" id="id214">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1143); <em><a href="#id215">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id216">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1143); <em><a href="#id217">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<p><a href="#id218"><span class="problematic" id="id219">``</span></a><a href="#id220"><span class="problematic" id="id221">`</span></a>python hl_lines=”8 10 20 23-24”
“””</p>
<aside class="system-message" id="id218">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1145); <em><a href="#id219">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id220">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1145); <em><a href="#id221">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1147)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">meth1<span class="colon">:</span></dt>
<dd class="field-odd"><p>整个模型保存</p>
</dd>
</dl>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1148)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<ol class="arabic simple">
<li><p>内存较大</p></li>
<li><p>在自设 architecture 的时候需要import</p></li>
<li><dl class="simple">
<dt>如果里面有 GPU tensors, 就会自动上传到 GPU上</dt><dd><dl class="simple">
<dt>To avoid GPU RAM surge</dt><dd><p>first, torch.load(.., map_location=’cpu’)
then,  torch.load_state_dict(…)</p>
</dd>
</dl>
</dd>
</dl>
</li>
</ol>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1154)</p>
<p>Enumerated list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””</p>
<p>torch.save(vgg16, ‘./models/vgg16.pth’) # save
vgg16 = torch.load(‘./models/vgg16.pth’) # load
——————————————</p>
<p>mymodel = MyModel()
torch.save(mymodel, ‘./models/mymodel.pth’) # save</p>
<p>from models import MyModel # 加载的时候必须导入或者复制自定义的类 # load
model = torch.load(‘./models/mymodel.pth’)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'./models/mymodel.pth'</span><span class="p">))</span>
<span class="go">MyModel(</span>
<span class="go">==================</span>
<span class="go">#  (linear): Linear(in_features=4, out_features=2, bias=True)</span>
<span class="go"> (sigmoid): Sigmoid())</span>
<span class="go">==============================================</span>
<span class="go">```</span>
</pre></div>
</div>
<p><a href="#id222"><span class="problematic" id="id223">``</span></a>` python hl_lines=”8 10 11 14 16-18”
“””</p>
<aside class="system-message" id="id222">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1174); <em><a href="#id223">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1176)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><dl class="field-list simple">
<dt class="field-odd">meth2<span class="colon">:</span></dt>
<dd class="field-odd"><p>以字典形式只保存参数</p>
</dd>
</dl>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1177)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<ol class="arabic simple">
<li><p>内存较小，官方推荐</p></li>
</ol>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1178)</p>
<p>Enumerated list ends without a blank line; unexpected unindent.</p>
</aside>
<p>2. 加载时需要重新init model，然后把保存的参数传进去
“””</p>
<p>vgg16 = torchvision.models.vgg16()
torch.save(vgg16.state_dict(), ‘./models/vgg16_state.pth’) # save</p>
<p>vgg16 = torchvision.models.vgg16()
vgg16.load_state_dict(torch.load(‘./models/vgg16_state.pth’)) # load</p>
<p>mymodel = MyModel()
torch.save(mymodel.state_dict(), ‘./models/mymodel_state.pth’)</p>
<p>from models import MyModel
mymodel = Mymodel()
mymode.load_state_dict(‘./models/mymodel_state.pth’)</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s1">'./mymodel_state.pth'</span><span class="p">))</span>
<span class="go">OrderedDict([</span>
<span class="go">============================</span>
<span class="go">#   ('linear.weight', tensor([[ 0.1370, -0.0558, -0.0024, -0.2526],</span>
<span class="go">                            [-0.2042, -0.1686, -0.1526, -0.3912]])),</span>
<span class="go">============================================================================================================================================</span>
<span class="go">#   ('linear.bias', tensor([0.1713, 0.4829]))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
<span class="go">MyModel(</span>
<span class="go">==================</span>
<span class="go">#  (linear): Linear(in_features=4, out_features=2, bias=True)</span>
<span class="go"> (sigmoid): Sigmoid())</span>
<span class="go">================================================</span>
<span class="go">```</span>
</pre></div>
</div>
</section>
<section id="representation">
<h2 id="representation">representation<a class="headerlink" href="#representation" title="Link to this heading">¶</a></h2>
<section id="utils-tensorboard">
<h3 id="utils-tensorboard"><cite>utils.tensorboard</cite><a class="headerlink" href="#utils-tensorboard" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt>!!! danger “目前还是要先下载 tensorflow”</dt><dd><p><cite>TensorFlow installation not found - running with reduced feature set.</cite></p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1218)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>!!! danger “jupyter 使用 tensorboard”</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">python</span>
<span class="pre">%load_ext</span> <span class="pre">tensorboard</span> <span class="pre">#</span> <span class="pre">加载扩展</span>
<span class="pre">%tensorboard</span> <span class="pre">--logdir</span> <span class="pre">runs</span> <span class="pre">#</span> <span class="pre">运行</span>
<span class="pre">`</span></code>
[在jupyter lab中使用tensorboard报错 UsageError: Line magic function <cite>%tensorboard</cite> not found.]</p>
</div></blockquote>
<ul>
<li><p>SummaryWriter</p>
<blockquote>
<div><p><a href="#id224"><span class="problematic" id="id225">``</span></a>` python
writer = SummaryWriter()</p>
<aside class="system-message" id="id224">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1228); <em><a href="#id225">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<p>writer.add_image(‘my_image’, img, 0)</p>
<dl class="simple">
<dt>for i in range(100):</dt><dd><p>writer.add_scalar(‘y=2x’, i * 2, i)</p>
</dd>
</dl>
<p>writer close()
<a href="#id226"><span class="problematic" id="id227">``</span></a><a href="#id228"><span class="problematic" id="id229">`</span></a></p>
<aside class="system-message" id="id226">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1236); <em><a href="#id227">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id228">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1236); <em><a href="#id229">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<p><span class="defi">source code</span></p>
<p><a href="#id230"><span class="problematic" id="id231">``</span></a>` python
class SummaryWriter:</p>
<aside class="system-message" id="id230">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1241); <em><a href="#id231">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1243)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
直接在 log_dir 里写 Tensorboard 要用的数据，可以在 training loop 里直接 call，而不用减缓训练的速度。</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>log_dir: str = 存放的文件夹目录。</dt><dd><p>Default = runs/<strong>CURRENT_DATETIME_HOSTNAME</strong>.
Notes：对每次 experiment pass in ‘runs/exp1’, ‘runs/exp2’, etc.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>comment: str = 只给默认的 log_dir 添加后缀</dt><dd><p>Notes：log_dir 改了这个就没用</p>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span> <span class="o">=</span> <span class="n">SummaryWriter</span><span class="p">()</span>
<span class="go"> # folder location: runs/May04_22-14-54_s-MacBook-Pro.local/</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># using the specified folder name.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span> <span class="o">=</span> <span class="n">SummaryWriter</span><span class="p">(</span><span class="s2">"my_experiment"</span><span class="p">)</span>
<span class="go"># folder location: my_experiment</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># with comment appended.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">writer</span> <span class="o">=</span> <span class="n">SummaryWriter</span><span class="p">(</span><span class="n">comment</span><span class="o">=</span><span class="s2">"LR_0.1_BATCH_16"</span><span class="p">)</span>
<span class="go"># folder location: runs/May04_22-14-54_s-MacBook-Pro.localLR_01_BATCH_16/</span>
</pre></div>
</div>
</dd>
</dl>
<p>“””</p>
<dl>
<dt>def __init__(</dt><dd><p>self,
log_dir=None,
comment=””,
purge_step=None,
max_queue=10,
flush_secs=120,
filename_suffix=””,</p>
</dd>
<dt>):</dt><dd><p>…</p>
</dd>
<dt>def add_image(</dt><dd><p>self, tag,
img_tensor,
global_step=None,
walltime=None,
dataformats=”CHW” ):
“””
写图片， 需要 <code class="docutils literal notranslate"><span class="pre">pillow</span></code> 包</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>tag: str =  名字</p></li>
<li><p>img_tensor: Union[torch.Tensor, numpy.ndarray, string,blobname = Image data</p></li>
<li><p>dataformats: str = 格式：CHW, HWC, HW, WH, etc.</p></li>
</ul>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1290)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1291)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
</dd>
<dt>def add_scalar(</dt><dd><p>self,
tag,
scalar_value,
global_step=None,
walltime=None,
new_style=False,
double_precision=False,</p>
</dd>
<dt>):</dt><dd><p>“””
画折线图</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><p>tag: str = 名字</p></li>
<li><p>scalar_value: Optional[float or string/blobname] =  y 轴</p></li>
<li><p>global_step: int = x 轴，一般是 gloabl step 用作画迭代的变化</p></li>
</ul>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1309)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””</p>
</dd>
</dl>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1310)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id232"><span class="problematic" id="id233">``</span></a><a href="#id234"><span class="problematic" id="id235">`</span></a></p>
<aside class="system-message" id="id232">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1310); <em><a href="#id233">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id234">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1310); <em><a href="#id235">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</div></blockquote>
</li>
</ul>
<dl class="simple">
<dt>!!! danger “<cite>No dashboards are active for the current data set.</cite>”</dt><dd><p>[关于解决Tensorboard出现No dashboards are active for the current data set.问题]</p>
</dd>
</dl>
</section>
</section>
<section id="cv">
<h2 id="cv">CV<a class="headerlink" href="#cv" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p>torchvion.</p></li>
</ul>
<section id="transforms">
<h3 id="transforms">transforms<a class="headerlink" href="#transforms" title="Link to this heading">¶</a></h3>
<p>!!! danger “一定要关注 compose 的输入和输出，要相互衔接匹配”</p>
<blockquote>
<div><p>torchvision 是用来处理==图像==的</p>
</div></blockquote>
<p><a href="#id236"><span class="problematic" id="id237">``</span></a>` python hl_lines=”1 30 59 92 126”
class Compose:</p>
<aside class="system-message" id="id236">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1327); <em><a href="#id237">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1329)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
用来 compose transform， 把好几个 trabsform process 组装成一个 composer</p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>transforms: List[transform的类]</p></li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trans</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">transforms</span><span class="o">.</span><span class="n">CenterCrop</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span>  <span class="c1"># 中心切割</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">transforms</span><span class="o">.</span><span class="n">PILToTensor</span><span class="p">(),</span> <span class="c1"># 变成tensor</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">transforms</span><span class="o">.</span><span class="n">ConvertImageDtype</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float</span><span class="p">),</span> <span class="c1"># tensor dtyte</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_trans</span> <span class="o">=</span> <span class="n">trans</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1342)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””</p>
<dl>
<dt>def __init__(self, transforms):</dt><dd><dl class="simple">
<dt>if not torch.jit.is_scripting() and not torch.jit.is_tracing():</dt><dd><p>_log_api_usage_once(self)</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1347)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>self.transforms = transforms</p>
</dd>
<dt>def __call__(self, img):</dt><dd><p>“””
逐层去过
“””
for t in self.transforms:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1353)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>img = t(img)</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1354)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>return img</p>
</dd>
</dl>
<p>…</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1357)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<dl>
<dt>class ToTensor:</dt><dd><p>“””
转 PIL Image 或者 ndarray 变成 FloatTensor，并且 把值自动映射到01区间。
(H x W x C) [0, 255] -&gt; (C x H x W)[0.0, 1.0]
转 target/label 为 LongTensor
用 PIL.Image.open(img_path)-&gt;PIL.image, cv2.imread(img_path)-&gt; numpy.ndarrary 都行</p>
<ul class="simple">
<li><dl class="simple">
<dt>other cases: 不缩放</dt><dd><ul>
<li><p>PIL Image 是其它 (L, LA, P, I, F, RGB, YCbCr, RGBA, CMYK, -    - ndarray 是其它 (np.uint8)</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1366)</p>
<p>Bullet list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””</p>
<dl>
<dt>def __init__(self) -&gt; None:</dt><dd><p>_log_api_usage_once(self)</p>
</dd>
<dt>def __call__(self, pic):</dt><dd><p>“””
Args:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1374)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><ul class="simple">
<li><p>pic: Union[PIL Image, numpy.ndarray]</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Returns:</dt><dd><p>Tensor: torch.FloatTensor</p>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">img_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img2tensor</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tensor_img</span> <span class="o">=</span> <span class="n">img2tensor</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1383)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””
return F.to_tensor(pic)</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1385)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>…</p>
</dd>
<dt>class Normalize(torch.nn.Module):</dt><dd><p>“””
对 img Tensor 在每个 channel 正态标准化，默认 non-inplace
<code class="docutils literal notranslate"><span class="pre">output[channel]</span> <span class="pre">=</span> <span class="pre">(input[channel]</span> <span class="pre">-</span> <span class="pre">mean[channel])</span> <span class="pre">/</span> <span class="pre">std[channel]</span></code></p>
<dl>
<dt>Args:</dt><dd><ul class="simple">
<li><p>mean: sequence = Sequence of means for each channel.</p></li>
<li><p>std: sequence =  Sequence of standard deviations for each channel.</p></li>
<li><p>inplace: bool = False, 是否 inplace</p></li>
</ul>
</dd>
<dt>Examples:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trans_norm</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">([</span><span class="n">mean</span><span class="p">]</span><span class="o">*</span><span class="n">channel</span><span class="p">,</span> <span class="p">[</span><span class="n">std</span><span class="p">]</span><span class="o">*</span><span class="n">channel</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_norm</span> <span class="o">=</span> <span class="n">trans_norm</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">img_tensor</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1400)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””</p>
<dl>
<dt>def __init__(self, mean, std, inplace=False):</dt><dd><p>super().__init__()
_log_api_usage_once(self)
self.mean = mean
self.std = std
self.inplace = inplace</p>
</dd>
<dt>def forward(self, tensor: Tensor) -&gt; Tensor:</dt><dd><p>“””
Args:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1412)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><ul class="simple">
<li><p>tensor: Tensor</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><ul class="simple">
<li><p>Tensor: 归一化之后的 img</p></li>
</ul>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1416)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””
return F.normalize(tensor, self.mean, self.std, self.inplace)</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1418)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>…</p>
</dd>
<dt>class Resize(torch.nn.Module):</dt><dd><p>“””
Resize the input image to the given size.</p>
<dl>
<dt>Warning:</dt><dd><p>根据输入的不一样，在 downsampling 时 PIL Image 和 Tensor 的 interpolation 有不一样。
：建议：用同一个 input dtype 进行，不要混用</p>
</dd>
<dt>Args:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>size: Union[sequence, int]: = Optional[(h, w), size]</dt><dd><ul>
<li><p>sequence = (h, w) 按位置匹配</p></li>
<li><dl class="simple">
<dt>int = size 短边变成size，长边按长短边的比例缩</dt><dd><p>if h &gt; w , (h, w) = (size * h/w, size)</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
<dt>Example:</dt><dd><div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">trans_resize</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">heiht</span><span class="p">,</span> <span class="n">width</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_resize</span> <span class="o">=</span> <span class="n">trans_resize</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1437)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””</p>
<dl>
<dt>def __init__(self, size, interpolation=InterpolationMode.BILINEAR, max_size=None, antialias=”warn”):</dt><dd><p>…</p>
</dd>
<dt>def forward(self, img):</dt><dd><p>“””
Args:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1445)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><ul class="simple">
<li><p>img: Optional[PIL Image, Tensor]</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>Optional[PIL Image, Tensor]</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1449)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””
return F.resize(img, self.size, self.interpolation, self.max_size, self.antialias)</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1451)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>…</p>
<dl>
<dt>class RandomCrop(torch.nn.Module):</dt><dd><p>“””
随机裁剪</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>size: Union[sequence, int]</dt><dd><ul>
<li><p>sequence = (h, w) -&gt; (h, w)</p></li>
<li><p>int = size  -&gt; (size, size) 正方形裁剪</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>padding: Union[int, sequence, None] = 在各 border 上可选的 pad</dt><dd><ul>
<li><p>None(default)</p></li>
<li><p>int = 四条边都填一样</p></li>
<li><p>sequence[int]*2 = [left&amp;right, top&amp;bottom]</p></li>
<li><p>sequence[int]*4 = [left, top, right, bottom] 顺时针</p></li>
</ul>
</dd>
</dl>
</li>
<li><p>pad_if_needed: boolean = 为了避免裁剪完不合 expected size</p></li>
</ul>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1470)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””</p>
<dl>
<dt>def __init__(self, size, padding=None, pad_if_needed=False, fill=0, padding_mode=”constant”):</dt><dd><p>…</p>
</dd>
<dt>def forward(self, img):</dt><dd><p>“””
Args:</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1478)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><ul class="simple">
<li><p>img:  Union[PIL.Image, Tensor]</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Returns:</dt><dd><p>Union[PIL.Image, Tensor]</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1482)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1483)</p>
<p>Unexpected section title.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">"""</span>
<span class="s2">...</span>
</pre></div>
</div>
</aside>
</dd>
</dl>
</dd>
</dl>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1484)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id238"><span class="problematic" id="id239">``</span></a><a href="#id240"><span class="problematic" id="id241">`</span></a></p>
<aside class="system-message" id="id238">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1484); <em><a href="#id239">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id240">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1484); <em><a href="#id241">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</section>
<section id="models">
<h3 id="models">models<a class="headerlink" href="#models" title="Link to this heading">¶</a></h3>
<dl>
<dt>!!! danger  “现在提供的是 可以自由地将:defi:<cite>预训练的 weights</cite> 加载到模型上。（<a href="#id242"><span class="problematic" id="id243">`</span></a>pretrained=True`被舍用）”</dt><dd><aside class="system-message" id="id242">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1489); <em><a href="#id243">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<p>如果需要预训练的，推荐使用指定版本，因为还提供了每种权重对应的的图像预处理的操作。</p>
<p><a href="#id244"><span class="problematic" id="id245">``</span></a>` python hl_lines=”10 11”
from torchvision.models import resnet50, ResNet50_Weights</p>
<aside class="system-message" id="id244">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1492); <em><a href="#id245">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<p>“””
ver | accu    | name
Old | 76.130% | ResNet50_Weights.IMAGENET1K_V1
New | 80.858% | ResNet50_Weights.IMAGENET1K_V2
“””</p>
<p># 直接看指定版本
resnet50(weights=ResNet50_Weights.IMAGENET1K_V1)
resnet50(weights=ResNet50_Weights.IMAGENET1K_V2)</p>
<p># 字符串, 默认是哪个就得看文档
resnet50(weights=’IMAGENET1K_V2’)
resnet50(weights=’DEFAULT’) # = pretrained=True
resnet50(weights=None) # = pretrained=False</p>
<p><a href="#id246"><span class="problematic" id="id247">``</span></a><a href="#id248"><span class="problematic" id="id249">`</span></a></p>
<aside class="system-message" id="id246">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1510); <em><a href="#id247">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id248">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1510); <em><a href="#id249">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
</dd>
<dt>!!! p “预处理图像”</dt><dd><p>在使用预训练模型之前，必须==预处理图像==（以正确的分辨率/插值调整大小，应用推理变换，重新缩放值等）
现在统一提供了。</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span> <span class="pre">python</span>
<span class="pre">weights</span> <span class="pre">=</span> <span class="pre">ResNet50_Weights.DEFAULT</span>
<span class="pre">preprocess</span> <span class="pre">=</span> <span class="pre">weights.transforms()</span> <span class="pre">#</span> <span class="pre">Weight</span> <span class="pre">Transforms</span> <span class="pre">初始化</span>
<span class="pre">img_transformed</span> <span class="pre">=</span> <span class="pre">preprocess(img)</span> <span class="pre">#</span> <span class="pre">预处理图像</span>
<span class="pre">`</span></code></p>
</dd>
</dl>
<section id="vgg16">
<h4 id="vgg16">vgg16<a class="headerlink" href="#vgg16" title="Link to this heading">¶</a></h4>
<p>[Very Deep Convolutional Networks for Large-Scale Image Recognition]</p>
<p><a href="#id250"><span class="problematic" id="id251">``</span></a>` python
VGG(</p>
<aside class="system-message" id="id250">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1527); <em><a href="#id251">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1529)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><dl class="simple">
<dt>(features): Sequential(</dt><dd><p>(0): Conv2d(3, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
(1): ReLU(inplace=True)
(2): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
(3): ReLU(inplace=True)
(4): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
(5): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
(6): ReLU(inplace=True)
(7): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
(8): ReLU(inplace=True)
(9): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
(10): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
(11): ReLU(inplace=True)
(12): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
(13): ReLU(inplace=True)
(14): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
(15): ReLU(inplace=True)
(16): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
(17): Conv2d(256, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
(18): ReLU(inplace=True)
(19): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
(20): ReLU(inplace=True)
(21): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
(22): ReLU(inplace=True)
(23): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)
(24): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
(25): ReLU(inplace=True)
(26): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
(27): ReLU(inplace=True)
(28): Conv2d(512, 512, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
(29): ReLU(inplace=True)
(30): MaxPool2d(kernel_size=2, stride=2, padding=0, dilation=1, ceil_mode=False)</p>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1561)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>)
(avgpool): AdaptiveAvgPool2d(output_size=(7, 7))
(classifier): Sequential(</p>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1564)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>(0): Linear(in_features=25088, out_features=4096, bias=True)
(1): ReLU(inplace=True)
(2): Dropout(p=0.5, inplace=False)
(3): Linear(in_features=4096, out_features=4096, bias=True)
(4): ReLU(inplace=True)
(5): Dropout(p=0.5, inplace=False)
(6): Linear(in_features=4096, out_features=1000, bias=True)</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1571)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p>)</p>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1572)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: SEVERE/4 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1572)</p>
<p>Title level inconsistent:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>)
```
</pre></div>
</div>
</aside>
<p><a href="#id252"><span class="problematic" id="id253">``</span></a>` python
@register_model()
@handle_legacy_interface(weights=(“pretrained”, VGG16_Weights.IMAGENET1K_V1))
def vgg16(<a href="#id254"><span class="problematic" id="id255">*</span></a>, weights: Optional[VGG16_Weights] = None, progress: bool = True, <a href="#id256"><span class="problematic" id="id257">**</span></a>kwargs: Any) -&gt; VGG:</p>
<aside class="system-message" id="id252">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1575); <em><a href="#id253">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id254">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1575); <em><a href="#id255">backlink</a></em></p>
<p>Inline emphasis start-string without end-string.</p>
</aside>
<aside class="system-message" id="id256">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1575); <em><a href="#id257">backlink</a></em></p>
<p>Inline strong start-string without end-string.</p>
</aside>
<aside class="system-message">
<p class="system-message-title">System Message: ERROR/3 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1579)</p>
<p>Unexpected indentation.</p>
</aside>
<blockquote>
<div><p>“””
VGG-16</p>
<dl class="simple">
<dt>Args:</dt><dd><ul class="simple">
<li><dl class="simple">
<dt>weights: Optional(torchvision.models.VGG16_Weights, None) = 是否使用预训练的参数</dt><dd><p>default = None</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>progress: Optional(Bool =  displays a progress bar of the download to stderr.</dt><dd><p>default = True.</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1587)</p>
<p>Definition list ends without a blank line; unexpected unindent.</p>
</aside>
<p>“””
weights = VGG16_Weights.verify(weights)
return _vgg(“D”, False, weights, progress, <a href="#id258"><span class="problematic" id="id259">**</span></a>kwargs)</p>
<aside class="system-message" id="id258">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1587); <em><a href="#id259">backlink</a></em></p>
<p>Inline strong start-string without end-string.</p>
</aside>
</div></blockquote>
<aside class="system-message">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1590)</p>
<p>Block quote ends without a blank line; unexpected unindent.</p>
</aside>
<p><a href="#id260"><span class="problematic" id="id261">``</span></a><a href="#id262"><span class="problematic" id="id263">`</span></a></p>
<aside class="system-message" id="id260">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1590); <em><a href="#id261">backlink</a></em></p>
<p>Inline literal start-string without end-string.</p>
</aside>
<aside class="system-message" id="id262">
<p class="system-message-title">System Message: WARNING/2 (<span class="docutils literal">/Users/yeyehaoye/gitproject/io/docs/source/python/pytorch.rst</span>, line 1590); <em><a href="#id263">backlink</a></em></p>
<p>Inline interpreted text or phrase reference start-string without end-string.</p>
</aside>
<p>[关于解决Tensorboard出现No dashboards are active for the current data set.问题]: <a class="reference external" href="https://blog.csdn.net/qq_40128284/article/details/109343301">https://blog.csdn.net/qq_40128284/article/details/109343301</a>
[在jupyter lab中使用tensorboard报错 UsageError: Line magic function <cite>%tensorboard</cite> not found.]: <a class="reference external" href="https://blog.csdn.net/Casuall/article/details/109653238">https://blog.csdn.net/Casuall/article/details/109653238</a>
[Very Deep Convolutional Networks for Large-Scale Image Recognition]: <a class="reference external" href="https://arxiv.org/abs/1409.1556">https://arxiv.org/abs/1409.1556</a>
[【pytorch系列】 with torch.no_grad():用法详解]: <a class="reference external" href="https://blog.csdn.net/sazass/article/details/116668755">https://blog.csdn.net/sazass/article/details/116668755</a></p>
<p>[pytorch downlaod]: <a class="reference external" href="https://pytorch.org">https://pytorch.org</a>
[pytorch V.S.python]: <a class="reference external" href="https://github.com/pytorch/text/">https://github.com/pytorch/text/</a>
[pytorch V.S.cuda]:<a class="reference external" href="https://pytorch.org/get-started/previous-versions/">https://pytorch.org/get-started/previous-versions/</a></p>
</section>
</section>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2024, coconut.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.3.7.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>